<!DOCTYPE html><html lang="en" data-mode="dark" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="generator" content="Jekyll v4.4.1" /><meta property="og:title" content="Notes Common Services Enumeration &amp; Attacks" /><meta name="author" content="BatBato" /><meta property="og:locale" content="en" /><meta name="description" content="Common Services Enumeration" /><meta property="og:description" content="Common Services Enumeration" /><link rel="canonical" href="nouman404.github.io/Notes/Footprinting/Common_Services_Enumeration_&_Attacks" /><meta property="og:url" content="nouman404.github.io/Notes/Footprinting/Common_Services_Enumeration_&_Attacks" /><meta property="og:site_name" content="BatBato’s Blog" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2022-09-02T00:00:00+02:00" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="Notes Common Services Enumeration &amp; Attacks" /><meta name="twitter:site" content="@twitter_username" /><meta name="twitter:creator" content="@BatBato" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"BlogPosting","author":{"@type":"Person","name":"BatBato"},"dateModified":"2023-01-31T09:51:35+01:00","datePublished":"2022-09-02T00:00:00+02:00","description":"Common Services Enumeration","headline":"Notes Common Services Enumeration &amp; Attacks","mainEntityOfPage":{"@type":"WebPage","@id":"nouman404.github.io/Notes/Footprinting/Common_Services_Enumeration_&_Attacks"},"url":"nouman404.github.io/Notes/Footprinting/Common_Services_Enumeration_&_Attacks"}</script><title>Notes | Common Services Enumeration & Attacks | BatBato's Blog</title><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/site.webmanifest"><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico"><meta name="apple-mobile-web-app-title" content="BatBato's Blog"><meta name="application-name" content="BatBato's Blog"><meta name="msapplication-TileColor" content="#da532c"><meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin><link rel="dns-prefetch" href="https://fonts.gstatic.com" crossorigin><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://cdn.jsdelivr.net" ><link rel="dns-prefetch" href="https://cdn.jsdelivr.net" ><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Lato&family=Source+Sans+Pro:wght@400;600;700;900&display=swap"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4/dist/css/bootstrap.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css"><link rel="stylesheet" href="/assets/css/style.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/magnific-popup@1/dist/magnific-popup.min.css"> <script src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script><body data-spy="scroll" data-target="#toc" data-topbar-visible="true"><div id="sidebar" class="d-flex flex-column align-items-end"><div class="profile-wrapper text-center"><div id="avatar"> <a href="/" class="mx-auto"> <img src="/assets/img/icon.jpg" alt="avatar" onerror="this.style.display='none'"> </a></div><div class="site-title mt-3"> <a href="/">BatBato's Blog</a></div><div class="site-subtitle font-italic">BatBato was here :)</div></div><ul class="w-100"><li class="nav-item"> <a href="/" class="nav-link"> <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i> <span>HOME</span> </a><li class="nav-item"> <a href="/categories/" class="nav-link"> <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i> <span>CATEGORIES</span> </a><li class="nav-item"> <a href="/notes/" class="nav-link"> <i class="fa-fw fas fa-sticky-note ml-xl-3 mr-xl-3 unloaded"></i> <span>NOTES</span> </a><li class="nav-item"> <a href="/sources/" class="nav-link"> <i class="fa-fw fas fa-folder-open ml-xl-3 mr-xl-3 unloaded"></i> <span>SOURCES</span> </a><li class="nav-item"> <a href="/about/" class="nav-link"> <i class="fa-fw fas fa-info-circle ml-xl-3 mr-xl-3 unloaded"></i> <span>ABOUT</span> </a><li class="nav-item"> <a href="/archives/" class="nav-link"> <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i> <span>ARCHIVES</span> </a></ul><div class="sidebar-bottom mt-auto d-flex flex-wrap justify-content-center align-items-center"> <a href="https://github.com/Nouman404" aria-label="github" target="_blank" rel="noopener"> <i class="fab fa-github"></i> </a> <a href="https://app.hackthebox.com/profile/235762" aria-label="hackthebox" target="_blank" rel="noopener"> <i class="fas fa-cube"></i> </a> <a href="https://tryhackme.com/p/Batbato" aria-label="tryhackme" target="_blank" rel="noopener"> <i class="fas fa-cloud"></i> </a> <a href="https://www.root-me.org/BatBato" aria-label="rootme" target="_blank" rel="noopener"> <i class="fas fa-skull"></i> </a></div></div><div id="topbar-wrapper"><div id="topbar" class="container d-flex align-items-center justify-content-between h-100 pl-3 pr-3 pl-md-4 pr-md-4"> <span id="breadcrumb"> <span> <a href="/"> Home </a> </span> <span>Notes | Common Services Enumeration & Attacks</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> Post</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" autocomplete="off" placeholder="Search..."> </span> <span id="search-cancel" >Cancel</span></div></div><div id="main-wrapper" class="d-flex justify-content-center"><div id="main" class="container pl-xl-4 pr-xl-4"><div class="row"><div id="core-wrapper" class="col-12 col-lg-11 col-xl-9 pr-xl-4"><div class="post pl-1 pr-1 pl-md-2 pr-md-2"><h1 data-toc-skip>Notes | Common Services Enumeration & Attacks</h1><div class="post-meta text-muted"> <span> Posted <em class="" data-ts="1662069600" data-df="ll" data-toggle="tooltip" data-placement="bottom"> Sep 2, 2022 </em> </span> <span> Updated <em class="" data-ts="1675155095" data-df="ll" data-toggle="tooltip" data-placement="bottom"> Jan 31, 2023 </em> </span><div class="d-flex justify-content-between"> <span> By <em> Bat </em> </span><div> <span class="readtime" data-toggle="tooltip" data-placement="bottom" title="3034 words"> <em>16 min</em> read</span></div></div></div><div class="post-content"><h1 id="common-services-enumeration">Common Services Enumeration</h1><h2 id="web-enumeration"><span class="mr-2">Web Enumeration</span><a href="#web-enumeration" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>When you are looking at a web interface there is basically 3 things I advise you to do :</p><ol><li>Read page content to find useful information<li>Read source code to find dev comments or information about plugins<li>Fuzz the website to find interesting files and/or directories</ol><p>I’ll leave you with the reading part and now we are going to look for the fuzzing part. It may not be very “stealthy” on a real live environment but it’s pretty common in CTFs. If you like GUI, you can check the <a href="https://www.zaproxy.org/docs/desktop/start/features/spider/">Zap</a> tool and especialy the spider/crawler section. But I’m going to go more in depth with two non graphical tools, <code class="language-plaintext highlighter-rouge">ffuf</code> and <code class="language-plaintext highlighter-rouge">gobuster</code>.</p><h3 id="ffuf--gobuster"><span class="mr-2">Ffuf / Gobuster</span><a href="#ffuf--gobuster" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p><a href="https://www.kali.org/tools/ffuf/">ffuf</a> is a fest web fuzzer written in Go that allows typical directory discovery, virtual host discovery (without DNS records) and GET and POST parameter fuzzing. And <a href="https://www.kali.org/tools/gobuster/">Gobuster</a> is a tool used to brute-force URIs including directories and files as well as DNS subdomains.</p><blockquote class="prompt-info"><div><p>Note that there are many other fuzzing tools and that I’m only presenting <code class="language-plaintext highlighter-rouge">ffuf</code> and <code class="language-plaintext highlighter-rouge">gobuster</code>. You may want to use <a href="https://www.kali.org/tools/dirbuster/">dirbuster</a> (Graphical user interface) or <a href="https://www.kali.org/tools/dirb/">dirb</a></p></div></blockquote><h3 id="web-enumeration-1"><span class="mr-2">Web Enumeration</span><a href="#web-enumeration-1" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>First we are going to look for web pages and directories. On <code class="language-plaintext highlighter-rouge">gobuser</code> you can find directories and web pages like this :</p><div class="language-console highlighter-rouge"><div class="code-header"> <span data-label-text="Console"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="go">gobuster dir -u http://SITE -w WORDLIST -x txt,php,html
</span></pre></table></code></div></div><blockquote class="prompt-tip"><div><p>I advise you to use the <code class="language-plaintext highlighter-rouge">/usr/share/dirbuster/wordlists/directory-list-2.3-medium.txt</code> wordlist as a first attempt to find files or directories.</p></div></blockquote><p>On <code class="language-plaintext highlighter-rouge">ffuf</code> you can do so like this :</p><div class="language-console highlighter-rouge"><div class="code-header"> <span data-label-text="Console"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="go">ffuf  -u http://SITE/FUZZ -w WORDLIST -e .txt,.php,.html
</span></pre></table></code></div></div><blockquote class="prompt-tip"><div><p>You can use recursion depth to look for files and directories in directories you find with fuff by adding the <code class="language-plaintext highlighter-rouge">-recursion -recursion-depth 1</code> option (it will do a recursion of 1 depth but you can increase this amount)</p></div></blockquote><blockquote class="prompt-tip"><div><p>On both tools you can increase the scan speed by increasing the number of threads with the <code class="language-plaintext highlighter-rouge">-t X</code> option. Just replace the <code class="language-plaintext highlighter-rouge">X</code> with the number of threads that you want. I advise you not to go over <code class="language-plaintext highlighter-rouge">50</code> because it may cause errors or overheat the server.</p></div></blockquote><blockquote class="prompt-info"><div><p>The web fuzzing we have done can also be done with the <code class="language-plaintext highlighter-rouge">intruder</code> of <code class="language-plaintext highlighter-rouge">Burp Suite</code>.</p></div></blockquote><h3 id="post--get-fuzzing"><span class="mr-2">POST / GET Fuzzing</span><a href="#post--get-fuzzing" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>With <code class="language-plaintext highlighter-rouge">fuff</code> you can fuzz POST and GET parameters. The easiest parameter to fuzz is the GET parameter because it’s very similar to a web page or directory fuzzing.</p><div class="language-console highlighter-rouge"><div class="code-header"> <span data-label-text="Console"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="go">ffuf -u http://SITE/?id=FUZZ -w WORDLIST 
</span></pre></table></code></div></div><p>or</p><div class="language-console highlighter-rouge"><div class="code-header"> <span data-label-text="Console"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="go">ffuf -u http://SITE/?FUZZ=key -w WORDLIST 
</span></pre></table></code></div></div><p>This should result in many errors so you can stop it and rerun it with the <code class="language-plaintext highlighter-rouge">-fs XXX</code> option where <code class="language-plaintext highlighter-rouge">XXX</code> is the size you found on error results.</p><p>For the POST fuzzing parameter you can do it with the <code class="language-plaintext highlighter-rouge">-d "PARAM=FUZZ</code> or <code class="language-plaintext highlighter-rouge">-d "FUZZ=VAL</code>:</p><div class="language-console highlighter-rouge"><div class="code-header"> <span data-label-text="Console"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="go">-X POST -d 'FUZZ=key' -H 'Content-Type: application/x-www-form-urlencoded'
</span></pre></table></code></div></div><h3 id="vhost--subdomains"><span class="mr-2">Vhost &amp; Subdomains</span><a href="#vhost--subdomains" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>We already have seen how to discover VHosts in the <a href="https://nouman404.github.io/Notes/Footprinting/OSINT#virtual-hosts-discovery">OSINT module</a>. For subdomain enumeration it’s much like POST and GET fuzzing :</p><div class="language-console highlighter-rouge"><div class="code-header"> <span data-label-text="Console"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="go">ffuf -u https://FUZZ.example.com/ -w WORDLIST
</span></pre></table></code></div></div><blockquote class="prompt-tip"><div><p>If you don’t have it yet you can download <a href="https://www.kali.org/tools/seclists/">Seclists</a> with <code class="language-plaintext highlighter-rouge">sudo apt install seclists</code>. You will find a lot of wordlist and the ones we are interested in here are the ones in the <code class="language-plaintext highlighter-rouge">/usr/share/seclists/Discovery/DNS/</code> directory. The <code class="language-plaintext highlighter-rouge">subdomains-top1million-110000.txt</code> is a pretty complete.</p></div></blockquote><blockquote class="prompt-info"><div><p>As you can see, <code class="language-plaintext highlighter-rouge">ffuf</code> is pretty versatile tool and can basically fuzz anything. You can also use it for brute force if you want, for example.</p></div></blockquote><h2 id="ftp"><span class="mr-2">FTP</span><a href="#ftp" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>File Transfert Protocol (FTP) is a standard communication protocol used for the transfer of files from a server to a client. To connect to an FTP server we can use the <code class="language-plaintext highlighter-rouge">ftp IP -P PORT</code>command. The default FTP port is <code class="language-plaintext highlighter-rouge">21</code> so if you have the same port for the FTP server on the machine you are attacking then you don’t have to specify the <code class="language-plaintext highlighter-rouge">-P</code> flag. When you run the command, you will be asked to connect with a <code class="language-plaintext highlighter-rouge">username</code> and <code class="language-plaintext highlighter-rouge">password</code>. If you don’t have such things, you can try to use the default <code class="language-plaintext highlighter-rouge">anonymous</code> user without a password. The <code class="language-plaintext highlighter-rouge">anonymous</code> connexion should be disabled but it’s worth trying.</p><blockquote class="prompt-tip"><div><p>The <code class="language-plaintext highlighter-rouge">-sC</code> of <code class="language-plaintext highlighter-rouge">nmap</code> can list files if anonymous login is enabled.</p></div></blockquote><blockquote class="prompt-tip"><div><p>There may be hidden files so don’t forget the <code class="language-plaintext highlighter-rouge">-a</code> flag of the <code class="language-plaintext highlighter-rouge">ls</code> command. The <code class="language-plaintext highlighter-rouge">-R</code> flag can also become handy to list files recursively.</p></div></blockquote><p>On an FTP server you can’t read files like on a normal machine with <code class="language-plaintext highlighter-rouge">cat</code> or your preferred text editor. You’ll have to download the file to read it locally. To download a file you can use the <code class="language-plaintext highlighter-rouge">get FILE</code> command and to upload a file the <code class="language-plaintext highlighter-rouge">put FILE</code> command. Whether it is for the <code class="language-plaintext highlighter-rouge">get</code> or the <code class="language-plaintext highlighter-rouge">put</code> command the default directory will be the one where the <code class="language-plaintext highlighter-rouge">ftp</code> command was launched. If you launched the command on the <code class="language-plaintext highlighter-rouge">Desktop</code> the files will be downloaded here and if the file you want to upload isn’t on the desktop then you will need to specify its path.</p><blockquote class="prompt-warning"><div><p>If you want information about <code class="language-plaintext highlighter-rouge">FTP brute forcing</code> you can check <a href="https://nouman404.github.io/Notes/Brute_Force/Brute_Force">this link</a></p></div></blockquote><h2 id="smb"><span class="mr-2">SMB</span><a href="#smb" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>“Server Message Block (SMB) is a communication protocol originally developed in 1983 by Barry A. Feigenbaum at IBM[2] and intended to provide shared access to files and printers across nodes on a network of systems running IBM’s OS/2.” Wikipedia. Originaly <code class="language-plaintext highlighter-rouge">SMB</code> used port <code class="language-plaintext highlighter-rouge">139</code> but in more recent version you can see port <code class="language-plaintext highlighter-rouge">445</code>.</p><h3 id="list-shares"><span class="mr-2">List Shares</span><a href="#list-shares" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>When you know that the machine has a <code class="language-plaintext highlighter-rouge">SMB</code> service running you may want to know which <code class="language-plaintext highlighter-rouge">shares</code> is available / readable. <code class="language-plaintext highlighter-rouge">smbclient</code> and <code class="language-plaintext highlighter-rouge">smbmap</code> are two great tools for this purpose.</p><div class="language-console highlighter-rouge"><div class="code-header"> <span data-label-text="Console"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="go">smbclient -N -L \\\\IP
</span></pre></table></code></div></div><blockquote class="prompt-note"><div><p>Note the <code class="language-plaintext highlighter-rouge">-N</code> flag that we use to specify <code class="language-plaintext highlighter-rouge">no password</code> and the <code class="language-plaintext highlighter-rouge">-L</code> option to list all shares.</p></div></blockquote><blockquote class="prompt-tip"><div><p>If you have already a user, you can specify it with the <code class="language-plaintext highlighter-rouge">-U</code> flag.</p></div></blockquote><p>or</p><div class="language-console highlighter-rouge"><div class="code-header"> <span data-label-text="Console"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="go">smbmap -H IP
</span></pre></table></code></div></div><blockquote class="prompt-tip"><div><p>To specify a user and or password with <code class="language-plaintext highlighter-rouge">smbmap</code> you can use the <code class="language-plaintext highlighter-rouge">-u</code> and <code class="language-plaintext highlighter-rouge">-p</code> flags.</p></div></blockquote><blockquote class="prompt-tip"><div><p>If you want to list files from a share recursively with <code class="language-plaintext highlighter-rouge">smbmap</code> you can use the <code class="language-plaintext highlighter-rouge">-r SHARE</code> flag (replace SHARE with the share you want to list).</p></div></blockquote><h3 id="access-shares"><span class="mr-2">Access Shares</span><a href="#access-shares" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>Now that we know the shares we want to read, we can connect to the share folder.</p><div class="language-console highlighter-rouge"><div class="code-header"> <span data-label-text="Console"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="go">smbclient -U USER \\\\IP\\SHARE_NAME
</span></pre></table></code></div></div><p>Once connected, we can download or upload files like we’ve seen in the FTP section with <code class="language-plaintext highlighter-rouge">get</code> and <code class="language-plaintext highlighter-rouge">put</code>. You can also use the <code class="language-plaintext highlighter-rouge">cd</code> and <code class="language-plaintext highlighter-rouge">ls</code> command to move in the share. With <code class="language-plaintext highlighter-rouge">smbmap</code> you can use the <code class="language-plaintext highlighter-rouge">--download PATH/TO/FILE</code> flag to download a file and the <code class="language-plaintext highlighter-rouge">--upload SOURCE DESTINATION</code> flag to upload a file.</p><blockquote class="prompt-tip"><div><p>You can execute command on the share with <code class="language-plaintext highlighter-rouge">smbmap</code> with the <code class="language-plaintext highlighter-rouge">-x "COMMAND"</code> flag.</p></div></blockquote><p>Where password brute force may cause damage on the server (block accounts) we are attacking, passwords spraying can be stealthier and cause fewer damages. Instead of brute forcing a password we can try to find users with passwords very often used. You also can perform pâssword spraying with <a href="https://nouman404.github.io/Notes/Brute_Force/Brute_Force#hydra">Hydra</a></p><div class="language-console highlighter-rouge"><div class="code-header"> <span data-label-text="Console"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="go">crackmapexec smb IP -u USER_LIST -p 'Company01!'
</span></pre></table></code></div></div><blockquote class="prompt-tip"><div><p>When you found valid credentials you can try dumping credentials with <code class="language-plaintext highlighter-rouge">crackmapexec</code> using the <code class="language-plaintext highlighter-rouge">--sam</code>, <code class="language-plaintext highlighter-rouge">--lsa</code> or the <code class="language-plaintext highlighter-rouge">--ntds</code> flag.</p></div></blockquote><h2 id="nfs"><span class="mr-2">NFS</span><a href="#nfs" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p><code class="language-plaintext highlighter-rouge">Network File System</code> (NFS) is pretty similar to <code class="language-plaintext highlighter-rouge">SMB</code> but you can find the main differences in <a href="https://www.educba.com/nfs-vs-smb/">this article</a>. It’s running on port <code class="language-plaintext highlighter-rouge">111</code> but since it’s last version (<code class="language-plaintext highlighter-rouge">NFSv4</code>) it uses one UDP and TCP port <code class="language-plaintext highlighter-rouge">2049</code>.</p><blockquote class="prompt-tip"><div><p>You can use the <code class="language-plaintext highlighter-rouge">--script nfs*</code> flag to have more details about the <code class="language-plaintext highlighter-rouge">NFS shares</code> in your <a href="https://www.kali.org/tools/nmap/">nmap</a> scan.</p></div></blockquote><p>If you want to manually check for shares on a server, you can use the <code class="language-plaintext highlighter-rouge">showmount</code> command as follows :</p><div class="language-console highlighter-rouge"><div class="code-header"> <span data-label-text="Console"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="go">showmount -e IP
</span></pre></table></code></div></div><p>Now that you know the share name, you can mount it on your device by following this steps :</p><ol><li>Create a directory where the share is going to be mounted :<div class="language-console highlighter-rouge"><div class="code-header"> <span data-label-text="Console"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="go">mkdir NFS_SHARE_DIR
</span></pre></table></code></div></div><li>Mount the remote share on your machine :<div class="language-console highlighter-rouge"><div class="code-header"> <span data-label-text="Console"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="go">mount -t nfs IP:REMOTE_SHARE ./NFS_SHARE_DIR/
</span></pre></table></code></div></div><li>Navigate and enumeate your mounted share<div class="language-console highlighter-rouge"><div class="code-header"> <span data-label-text="Console"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="go">cd NFS_SHARE_DIR
</span></pre></table></code></div></div></ol><blockquote class="prompt-warning"><div><p>If you want to dismount your newly created mounted share you can use the <code class="language-plaintext highlighter-rouge">umount</code> command like : <code class="language-plaintext highlighter-rouge">umount ./NFS_SHARE_DIR</code></p></div></blockquote><h2 id="sql"><span class="mr-2">SQL</span><a href="#sql" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>There are many <code class="language-plaintext highlighter-rouge">database management system</code> (DBMS) but by default <code class="language-plaintext highlighter-rouge">MSSQL</code> uses port <code class="language-plaintext highlighter-rouge">TCP/1433</code>, and <code class="language-plaintext highlighter-rouge">MySQL</code> uses <code class="language-plaintext highlighter-rouge">TCP/3306</code>.</p><h3 id="connection"><span class="mr-2">Connection</span><a href="#connection" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>To connect to MySQL and MSSQL is pretty similar.</p><ul><li>MySQL :</ul><p><strong>Linux</strong></p><div class="language-console highlighter-rouge"><div class="code-header"> <span data-label-text="Console"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="go">mysql -h DOMAIN_OR_IP -u USERNAME -pPASSWORD -P PORT DATABASE
</span></pre></table></code></div></div><blockquote class="prompt-tip"><div><p>Note the if you don’t know the databases that are on the host you can omit this parameter and select it after.</p></div></blockquote><blockquote class="prompt-danger"><div><p>Note that there is no space between the <code class="language-plaintext highlighter-rouge">-p</code> flag and the password. You can use the <code class="language-plaintext highlighter-rouge">-p</code> flag without specifying the password at first and type it when asked.</p></div></blockquote><p><strong>Windows</strong></p><div class="language-console highlighter-rouge"><div class="code-header"> <span data-label-text="Console"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="go">sqlcmd -S DOMAIN_OR_IP -U USERNAME -P 'PASSWORD' -y 30 -Y 30
</span></pre></table></code></div></div><blockquote class="prompt-tip"><div><p>The <code class="language-plaintext highlighter-rouge">-y</code> and <code class="language-plaintext highlighter-rouge">-Y</code> flag are used for better looking output.</p></div></blockquote><ul><li>MSSQL :</ul><div class="language-console highlighter-rouge"><div class="code-header"> <span data-label-text="Console"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="go">sqsh -S DOMAIN_OR_IP -U SERVERNAME\\USERNAME -P 'PASSWORD' -h
</span></pre></table></code></div></div><blockquote class="prompt-tip"><div><p>If you are looking for a local account you can put <code class="language-plaintext highlighter-rouge">.\\USERNAME</code> instead of giving a servername.</p></div></blockquote><h3 id="sql-commands"><span class="mr-2">SQL Commands</span><a href="#sql-commands" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>For the commands we will use, the mysql commands are easier to type and remember.</p><h4 id="show-databases"><span class="mr-2">Show databases</span><a href="#show-databases" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><ul><li>MySQL :</ul><div class="language-console highlighter-rouge"><div class="code-header"> <span data-label-text="Console"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="gp">SHOW DATABASES;</span><span class="w">
</span></pre></table></code></div></div><ul><li>MSSQL :</ul><div class="language-console highlighter-rouge"><div class="code-header"> <span data-label-text="Console"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre><span class="gp">1&gt;</span><span class="w"> </span>SELECT name FROM master.dbo.sysdatabases
<span class="gp">2&gt;</span><span class="w"> </span>go
</pre></table></code></div></div><h4 id="select-a-database"><span class="mr-2">Select a Database</span><a href="#select-a-database" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><ul><li>MySQL :</ul><div class="language-console highlighter-rouge"><div class="code-header"> <span data-label-text="Console"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="gp">USE DATABASES;</span><span class="w">
</span></pre></table></code></div></div><ul><li>MSSQL :</ul><div class="language-console highlighter-rouge"><div class="code-header"> <span data-label-text="Console"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre><span class="gp">1&gt;</span><span class="w"> </span>USE name FROM master.dbo.sysdatabases
<span class="gp">2&gt;</span><span class="w"> </span>go
</pre></table></code></div></div><h4 id="show-tables"><span class="mr-2">Show Tables</span><a href="#show-tables" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><ul><li>MySQL :</ul><div class="language-console highlighter-rouge"><div class="code-header"> <span data-label-text="Console"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="gp">SHOW TABLES;</span><span class="w">
</span></pre></table></code></div></div><ul><li>MSSQL :</ul><div class="language-console highlighter-rouge"><div class="code-header"> <span data-label-text="Console"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre><span class="gp">1&gt;</span><span class="w"> </span>SELECT table_name FROM DATABASE_NAME.INFORMATION_SCHEMA.TABLES
<span class="gp">2&gt;</span><span class="w"> </span>go
</pre></table></code></div></div><blockquote class="prompt-warning"><div><p>Don’t forget to specify the <code class="language-plaintext highlighter-rouge">DATABASE_NAME</code> in MSSQL.</p></div></blockquote><h4 id="select-all-data-from-a-table"><span class="mr-2">Select all Data from a Table</span><a href="#select-all-data-from-a-table" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><ul><li>MySQL :</ul><div class="language-console highlighter-rouge"><div class="code-header"> <span data-label-text="Console"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="go">SELECT * FROM TABLE_NAME
</span></pre></table></code></div></div><ul><li>MSSQL :</ul><div class="language-console highlighter-rouge"><div class="code-header"> <span data-label-text="Console"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre><span class="gp">1&gt;</span><span class="w"> </span>SELECT <span class="k">*</span> FROM TABLE_NAME
<span class="gp">2&gt;</span><span class="w"> </span>go
</pre></table></code></div></div><h3 id="execute-commands"><span class="mr-2">Execute Commands</span><a href="#execute-commands" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>With MSSQL you can execute command with <code class="language-plaintext highlighter-rouge">xp_cmdshell</code> by typing <code class="language-plaintext highlighter-rouge">xp_cmdshell "COMMAND"</code>.</p><div class="language-console highlighter-rouge"><div class="code-header"> <span data-label-text="Console"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre><span class="gp">1&gt;</span><span class="w"> </span>xp_cmdshell <span class="s1">'whoami'</span>
<span class="gp">2&gt;</span><span class="w"> </span>go
</pre></table></code></div></div><p>Note that if <code class="language-plaintext highlighter-rouge">xp_cmdshell</code> is not enable and if you have sufficient rights you can <code class="language-plaintext highlighter-rouge">enable it</code> with the following commands :</p><ol><li>To allow advanced options to be changed.</ol><div class="language-console highlighter-rouge"><div class="code-header"> <span data-label-text="Console"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre><span class="gp">1&gt;</span><span class="w"> </span>EXECUTE sp_configure <span class="s1">'show advanced options'</span>, 1
<span class="gp">2&gt;</span><span class="w"> </span>go
</pre></table></code></div></div><ol><li>To update the currently configured value for advanced options.</ol><div class="language-console highlighter-rouge"><div class="code-header"> <span data-label-text="Console"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre><span class="gp">1&gt;</span><span class="w"> </span>RECONFIGURE
<span class="gp">2&gt;</span><span class="w"> </span>go
</pre></table></code></div></div><ol><li>To enable the feature.</ol><div class="language-console highlighter-rouge"><div class="code-header"> <span data-label-text="Console"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre><span class="gp">1&gt;</span><span class="w"> </span>EXECUTE sp_configure <span class="s1">'xp_cmdshell'</span>, 1
<span class="gp">2&gt;</span><span class="w"> </span>go
</pre></table></code></div></div><ol><li>To update the currently configured value for this feature.</ol><div class="language-console highlighter-rouge"><div class="code-header"> <span data-label-text="Console"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre><span class="gp">1&gt;</span><span class="w"> </span>RECONFIGURE
<span class="gp">2&gt;</span><span class="w"> </span>go
</pre></table></code></div></div><h3 id="impersonate-existing-users-with-mssql"><span class="mr-2">Impersonate Existing Users with MSSQL</span><a href="#impersonate-existing-users-with-mssql" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>The executing user can take the permissions of another user thanks to a particular privilege in SQL Server called <code class="language-plaintext highlighter-rouge">IMPERSONATE</code>. We must first find users who we can mimic. <code class="language-plaintext highlighter-rouge">Sysadmins</code> have the ability to impersonate anybody by default, but rights must be specifically granted to non-administrator users. In order to find users we can impersonate, we may perform the following query:</p><div class="language-console highlighter-rouge"><div class="code-header"> <span data-label-text="Console"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
</pre><td class="rouge-code"><pre><span class="gp">1&gt;</span><span class="w"> </span>SELECT distinct b.name
<span class="gp">2&gt;</span><span class="w"> </span>FROM sys.server_permissions a
<span class="gp">3&gt;</span><span class="w"> </span>INNER JOIN sys.server_principals b
<span class="gp">4&gt;</span><span class="w"> </span>ON a.grantor_principal_id <span class="o">=</span> b.principal_id
<span class="gp">5&gt;</span><span class="w"> </span>WHERE a.permission_name <span class="o">=</span> <span class="s1">'IMPERSONATE'</span>
<span class="gp">6&gt;</span><span class="w"> </span>GO
</pre></table></code></div></div><p>Now if the user <code class="language-plaintext highlighter-rouge">bob</code> can be impersonate, we will execute the following command :</p><div class="language-console highlighter-rouge"><div class="code-header"> <span data-label-text="Console"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre><td class="rouge-code"><pre><span class="gp">1&gt;</span><span class="w"> </span>EXECUTE AS LOGIN <span class="o">=</span> <span class="s1">'bob'</span>
<span class="gp">2&gt;</span><span class="w"> </span>SELECT SYSTEM_USER
<span class="gp">3&gt;</span><span class="w"> </span>SELECT IS_SRVROLEMEMBER<span class="o">(</span><span class="s1">'sysadmin'</span><span class="o">)</span>
<span class="gp">4&gt;</span><span class="w"> </span>go
</pre></table></code></div></div><h3 id="communicate-with-other-databases-with-mssql"><span class="mr-2">Communicate with Other Databases with MSSQL</span><a href="#communicate-with-other-databases-with-mssql" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>Linked servers is a configuration option in MSSQL. A Transact-SQL query that contains tables from another instance of SQL Server, or another database product like Oracle, may generally be executed by the database engine thanks to linked servers, which are typically set up to support this.</p><ol><li>Identify linked Servers in MSSQL</ol><p>The following command will list <a href="https://docs.microsoft.com/en-us/sql/relational-databases/linked-servers/create-linked-servers-sql-server-database-engine?view=sql-server-ver16">linked server</a> and mark remote servers with a <code class="language-plaintext highlighter-rouge">1</code> and local ones with a <code class="language-plaintext highlighter-rouge">0</code>.</p><div class="language-console highlighter-rouge"><div class="code-header"> <span data-label-text="Console"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre><span class="gp">1&gt;</span><span class="w"> </span>SELECT srvname, isremote FROM sysservers
<span class="gp">2&gt;</span><span class="w"> </span>go
</pre></table></code></div></div><p>To execute commands on a linked server you can use the following command :</p><div class="language-console highlighter-rouge"><div class="code-header"> <span data-label-text="Console"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="go">EXECUTE ('CMD') AT [LINKED.SRV]	
</span></pre></table></code></div></div><p>Where <code class="language-plaintext highlighter-rouge">CMD</code> can be a SQL querry or xp_cmdshell like this :</p><div class="language-console highlighter-rouge"><div class="code-header"> <span data-label-text="Console"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="go">EXECUTE('xp_cmdshell ''type c:\Users\Administrator\Desktop\flag.txt''') AT [LINKED.SRV]
</span></pre></table></code></div></div><blockquote class="prompt-warning"><div><p>Note that the single quotes (<code class="language-plaintext highlighter-rouge">'</code>) are important !</p></div></blockquote><h2 id="rdp"><span class="mr-2">RDP</span><a href="#rdp" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>“Remote Desktop Protocol (RDP) is a proprietary protocol developed by Microsoft which provides a user with a graphical interface to connect to another computer over a network connection.” (Wikipedia). By default, the server listens on TCP and UDP on port 3389.</p><h3 id="rdp-password-spraying"><span class="mr-2">RDP Password Spraying</span><a href="#rdp-password-spraying" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>If we are looking for usernames we may try the password spraying attack. As for any password spraying attack we can use <a href="https://nouman404.github.io/Notes/Brute_Force/Brute_Force#hydra">Hydra</a> but for RDP we can also use <a href="https://www.kali.org/tools/crowbar/">crowbar</a>. The <code class="language-plaintext highlighter-rouge">crowbar</code> syntax is as follows if we want to spray the password <code class="language-plaintext highlighter-rouge">password123</code> on the whole network :</p><div class="language-console highlighter-rouge"><div class="code-header"> <span data-label-text="Console"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="go">crowbar -b rdp -s IP/32 -U USER_LIST -c 'password123'
</span></pre></table></code></div></div><h3 id="rdp-connection"><span class="mr-2">RDP connection</span><a href="#rdp-connection" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>When you find yourself with valid credentials, you can connect to the distant machine using tools like <a href="https://www.kali.org/tools/freerdp2/#xfreerdp">freerdp</a> or <a href="https://remmina.org/">remmina</a>. The full <code class="language-plaintext highlighter-rouge">xfreerdp</code> command where we share a local folder to upload our tools is as follows :</p><div class="language-console highlighter-rouge"><div class="code-header"> <span data-label-text="Console"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="go">xfreerdp /v:IP:PORT /u:USERNAME /p:PASSWORD /drive:SHARENAME,"PATH_TO_THE_FILES_TO_SHARE"
</span></pre></table></code></div></div><h3 id="rdp-session-hijacking"><span class="mr-2">RDP Session Hijacking</span><a href="#rdp-session-hijacking" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>If we obtain access to a computer and have a <code class="language-plaintext highlighter-rouge">local administrator account</code>. The user’s remote desktop session can be <code class="language-plaintext highlighter-rouge">hijacked</code> in order to elevate our privileges and assume the user’s identity if they are connecting via RDP to our hacked system. In an <code class="language-plaintext highlighter-rouge">Active Directory</code> setting, this can lead to us taking control of a <code class="language-plaintext highlighter-rouge">Domain Admin account</code> or gaining more access to the domain.</p><p>We can use the Powershell command <code class="language-plaintext highlighter-rouge">query user</code> to look for other connected users. If you already have a <code class="language-plaintext highlighter-rouge">SYSTEM CMD</code> opened you can lauch the command <code class="language-plaintext highlighter-rouge">tscon TARGET_SESSION_ID /dest:OUR_SESSION_NAME</code>. If you don’t have a <code class="language-plaintext highlighter-rouge">SYSTEM CMD</code> you can create a service that, by default, will run as <code class="language-plaintext highlighter-rouge">local SYSTEM</code> :</p><div class="language-console highlighter-rouge"><div class="code-header"> <span data-label-text="Console"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="go">sc.exe create sessionhijack binpath= "cmd.exe /k tscon TARGET_SESSION_ID /dest:OUR_SESSION_NAME"
</span></pre></table></code></div></div><p>This will launch our service called <code class="language-plaintext highlighter-rouge">sessionhijack</code>.</p><div class="language-console highlighter-rouge"><div class="code-header"> <span data-label-text="Console"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="go">net start sessionhijack
</span></pre></table></code></div></div><h3 id="rdp-pass-the-hash-pth"><span class="mr-2">RDP Pass-the-Hash (PtH)</span><a href="#rdp-pass-the-hash-pth" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>What is wonderful with RDP is that even if we only have the <code class="language-plaintext highlighter-rouge">NT hash</code> and not the clear text password, we can still connect to the machine with the <code class="language-plaintext highlighter-rouge">Pass-the-Hash</code> technique. To use <code class="language-plaintext highlighter-rouge">xfreerdp</code> fot the PtH attack you can do :</p><div class="language-console highlighter-rouge"><div class="code-header"> <span data-label-text="Console"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="go">xfreerdp /v:IP /u:USER /pth:HASH
</span></pre></table></code></div></div><p>This attack is only possible if the <code class="language-plaintext highlighter-rouge">Restricted Admin Mode</code> is enabled (it is disabled by default). A new registry key <code class="language-plaintext highlighter-rouge">DisableRestrictedAdmin</code> (REG DWORD) under <code class="language-plaintext highlighter-rouge">HKEY_LOCAL_MACHINESystemCurrentControlSetControlLsa</code> can be added to enable this. The command below can be used to accomplish it:</p><div class="language-console highlighter-rouge"><div class="code-header"> <span data-label-text="Console"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="go">reg add HKLM\System\CurrentControlSet\Control\Lsa /t REG_DWORD /v DisableRestrictedAdmin /d 0x0 /f
</span></pre></table></code></div></div><h2 id="smtp--pop3--imap"><span class="mr-2">SMTP / POP3 / IMAP</span><a href="#smtp--pop3--imap" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>All those protocols are used to allow people to receive and send mails. You can find the list of ports that they are using here :</p><div class="table-wrapper"><table><thead><tr><th><strong>Port</strong><th><strong>Service</strong><tbody><tr><td>TCP/25<td>SMTP Unencrypted<tr><td>TCP/143<td>IMAP4 Unencrypted<tr><td>TCP/110<td>POP3 Unencrypted<tr><td>TCP/465<td>SMTP Encrypted<tr><td>TCP/993<td>IMAP4 Encrypted<tr><td>TCP/995<td>POP3 Encrypted</table></div><blockquote class="prompt-tip"><div><p>Either for <code class="language-plaintext highlighter-rouge">SMTP</code> or <code class="language-plaintext highlighter-rouge">POP3</code> server you can try to <code class="language-plaintext highlighter-rouge">brute force</code> them or <code class="language-plaintext highlighter-rouge">password spray</code> them using <a href="https://nouman404.github.io/Notes/Brute_Force/Brute_Force#hydra">hydra</a></p></div></blockquote><h3 id="smtp"><span class="mr-2">SMTP</span><a href="#smtp" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>You can easily connect to a <code class="language-plaintext highlighter-rouge">SMTP</code> server with <code class="language-plaintext highlighter-rouge">telnet</code> using the command <code class="language-plaintext highlighter-rouge">telnet IP 25</code>. You can use the commands <code class="language-plaintext highlighter-rouge">VRFY</code>, <code class="language-plaintext highlighter-rouge">EXPN</code>, and <code class="language-plaintext highlighter-rouge">RCPT TO</code> to enumerate users on the server.</p><p>The <code class="language-plaintext highlighter-rouge">VRFY</code> command allows us to check for existing users and can be used like this <code class="language-plaintext highlighter-rouge">VRFY root</code>. If the user <code class="language-plaintext highlighter-rouge">root</code> exist, then we will see a line containing this username like <code class="language-plaintext highlighter-rouge">250 USERNAME</code>. If the user isn’t found we may get the error code <code class="language-plaintext highlighter-rouge">252</code>.</p><p>The <code class="language-plaintext highlighter-rouge">EXPN</code> command will list all users of a certain list. For example, if we type <code class="language-plaintext highlighter-rouge">EXPN batbato</code> we will get my email but if we type <code class="language-plaintext highlighter-rouge">EXPN students</code> we may get all emails that belongs to students.</p><p><code class="language-plaintext highlighter-rouge">RCPT TO</code> can be used to check the recipient of a mail. We try to send a mail to many users in order to find valid ones.</p><div class="language-console highlighter-rouge"><div class="code-header"> <span data-label-text="Console"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre><td class="rouge-code"><pre><span class="go">MAIL FROM: Anyone@X.com
250 OK - (Server acknowledges and accepts)
RCPT TO: bob@X.dom
250 OK
</span></pre></table></code></div></div><p>Here we can see that <code class="language-plaintext highlighter-rouge">bob</code> is a valid user.</p><p>You can use tools such as <a href="https://www.kali.org/tools/smtp-user-enum/">smtp-user-enum</a> to automate this process. The <code class="language-plaintext highlighter-rouge">-M</code> flag allows us to specify the method we want to use (<code class="language-plaintext highlighter-rouge">VRFY</code>, <code class="language-plaintext highlighter-rouge">RCPT</code> or <code class="language-plaintext highlighter-rouge">EXPN</code>).</p><div class="language-console highlighter-rouge"><div class="code-header"> <span data-label-text="Console"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="go">smtp-user-enum -M RCPT -U USER_LIST -D DOMAIN -t IP
</span></pre></table></code></div></div><blockquote class="prompt-tip"><div><p>You also can use tools such as <code class="language-plaintext highlighter-rouge">Metaploit</code> to automate your process. You can use modules like <code class="language-plaintext highlighter-rouge">auxiliary/scanner/smtp/smtp_version</code> or <code class="language-plaintext highlighter-rouge">auxiliary/scanner/smtp/smtp_enum</code>.</p></div></blockquote><h3 id="pop3"><span class="mr-2">POP3</span><a href="#pop3" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>The <code class="language-plaintext highlighter-rouge">POP3</code> can also be used to enumerate users. We can do so by using the <code class="language-plaintext highlighter-rouge">USER</code> command as follows :</p><div class="language-console highlighter-rouge"><div class="code-header"> <span data-label-text="Console"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre><td class="rouge-code"><pre><span class="go">USER bob
+OK
USER bib
-ERR
</span></pre></table></code></div></div><p>The most useful commands are <code class="language-plaintext highlighter-rouge">USER</code> and <code class="language-plaintext highlighter-rouge">PASS</code> to connect to the server, <code class="language-plaintext highlighter-rouge">LIST</code> to list mails and <code class="language-plaintext highlighter-rouge">RETR X</code> to get the content of the mail <code class="language-plaintext highlighter-rouge">X</code>. But here is a list of useful <code class="language-plaintext highlighter-rouge">POP3</code> commands :</p><div class="table-wrapper"><table><thead><tr><th><strong>Command</strong><th><strong>Description</strong><tbody><tr><td>USER username<td>Identifies the user.<tr><td>PASS password<td>Authentication of the user using its password.<tr><td>STAT<td>Requests the number of saved emails from the server.<tr><td>LIST<td>Requests from the server the number and size of all emails.<tr><td>RETR id<td>Requests the server to deliver the requested email by ID.<tr><td>DELE id<td>Requests the server to delete the requested email by ID.<tr><td>CAPA<td>Requests the server to display the server capabilities.<tr><td>RSET<td>Requests the server to reset the transmitted information.<tr><td>QUIT<td>Closes the connection with the POP3 server.</table></div><blockquote class="prompt-tip"><div><p>You can find more information about <code class="language-plaintext highlighter-rouge">POP3</code> commands on <a href="https://electrictoolbox.com/pop3-commands/">this site</a>.</p></div></blockquote><h3 id="imap"><span class="mr-2">IMAP</span><a href="#imap" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>As for <code class="language-plaintext highlighter-rouge">SMTP</code> and <code class="language-plaintext highlighter-rouge">POP3</code> you can execute bunch of commands on a <code class="language-plaintext highlighter-rouge">IMAP</code> server, here is a list of some that may help you :</p><div class="table-wrapper"><table><thead><tr><th><strong>Command</strong><th><strong>Description</strong><tbody><tr><td>1 LOGIN username password<td>User’s login.<tr><td>1 LIST “” *<td>Lists all directories.<tr><td>1 CREATE “INBOX”<td>Creates a mailbox with a specified name.<tr><td>1 DELETE “INBOX”<td>Deletes a mailbox.<tr><td>1 RENAME “ToRead” “Important”<td>Renames a mailbox.<tr><td>1 LSUB “” *<td>Returns a subset of names from the set of names that the User has declared as being active or subscribed.<tr><td>1 SELECT INBOX<td>Selects a mailbox so that messages in the mailbox can be accessed.<tr><td>1 UNSELECT INBOX<td>Exits the selected mailbox.<tr><td>1 FETCH &lt;ID&gt; all<td>Retrieves data associated with a message in the mailbox.<tr><td>tag FETCH &lt;ID&gt;:&lt;ID&gt; (BODY[HEADER])<td>Get header of message<tr><td>tag FETCH &lt;ID&gt; (BODY[n])<td>Get the part number n of the body<tr><td>1 CLOSE<td>Removes all messages with the Deleted flag set.<tr><td>1 LOGOUT<td>Closes the connection with the IMAP server.</table></div><h3 id="pop3s--imaps"><span class="mr-2">POP3s &amp; IMAPs</span><a href="#pop3s--imaps" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>If we encounter the encrypted version of <code class="language-plaintext highlighter-rouge">POP3</code> and <code class="language-plaintext highlighter-rouge">IMAP</code>, we still can connect to it but not with <code class="language-plaintext highlighter-rouge">telnet</code>. We can do so by using <code class="language-plaintext highlighter-rouge">openssl</code> :</p><div class="language-console highlighter-rouge"><div class="code-header"> <span data-label-text="Console"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="go">openssl s_client -connect IP:pop3s
</span></pre></table></code></div></div><blockquote class="prompt-warning"><div><p>You can replace <code class="language-plaintext highlighter-rouge">pop3s</code> by <code class="language-plaintext highlighter-rouge">imaps</code> to connect to a <code class="language-plaintext highlighter-rouge">IMAPs</code> server.</p></div></blockquote></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw mr-1"></i> <a href='/categories/notes/'>Notes</a>, <a href='/categories/footprinting/'>Footprinting</a>, <a href='/categories/common-services-enumeration-attacks/'>Common Services Enumeration& Attacks</a></div><div class="post-tags"> <i class="fa fa-tags fa-fw mr-1"></i> <a href="/tags/common-services/" class="post-tag no-text-decoration" >Common Services</a> <a href="/tags/enumeration/" class="post-tag no-text-decoration" >Enumeration</a> <a href="/tags/web/" class="post-tag no-text-decoration" >Web</a> <a href="/tags/ftp/" class="post-tag no-text-decoration" >FTP</a> <a href="/tags/smb/" class="post-tag no-text-decoration" >SMB</a> <a href="/tags/smtp/" class="post-tag no-text-decoration" >SMTP</a> <a href="/tags/pop3/" class="post-tag no-text-decoration" >POP3</a></div><div class="post-tail-bottom d-flex justify-content-between align-items-center mt-3 pt-5 pb-2"><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/"> CC BY 4.0 </a> by the author.</div><div class="share-wrapper"> <span class="share-label text-muted mr-1">Share</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=Notes+%7C+Common+Services+Enumeration+%26+Attacks+-+BatBato%27s+Blog&url=nouman404.github.io%2FNotes%2FFootprinting%2FCommon_Services_Enumeration_%26_Attacks" data-toggle="tooltip" data-placement="top" title="Twitter" target="_blank" rel="noopener" aria-label="Twitter"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=Notes+%7C+Common+Services+Enumeration+%26+Attacks+-+BatBato%27s+Blog&u=nouman404.github.io%2FNotes%2FFootprinting%2FCommon_Services_Enumeration_%26_Attacks" data-toggle="tooltip" data-placement="top" title="Facebook" target="_blank" rel="noopener" aria-label="Facebook"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://t.me/share/url?url=nouman404.github.io%2FNotes%2FFootprinting%2FCommon_Services_Enumeration_%26_Attacks&text=Notes+%7C+Common+Services+Enumeration+%26+Attacks+-+BatBato%27s+Blog" data-toggle="tooltip" data-placement="top" title="Telegram" target="_blank" rel="noopener" aria-label="Telegram"> <i class="fa-fw fab fa-telegram"></i> </a> <i id="copy-link" class="fa-fw fas fa-link small" data-toggle="tooltip" data-placement="top" title="Copy link" data-title-succeed="Link copied successfully!"> </i> </span></div></div></div></div></div><div id="panel-wrapper" class="col-xl-3 pl-2 text-muted"><div class="access"><div id="access-lastmod" class="post"><div class="panel-heading">Recently Updated</div><ul class="post-content pl-0 pb-1 ml-1 mt-2"><li><a href="/Notes/AD/AD_Basics">Notes | AD | AD Basics</a><li><a href="/Notes/AD/Tools">Notes | AD | AD Tools</a><li><a href="/CTFs/HeroCTF_2024/Steganographie/Zipper">CTFs | HeroCTF_2024 | Steganographie | Zipper</a><li><a href="/CTFs/HeroCTF_2024/Forensique/LazySysAdmin2">CTFs | HeroCTF_2024 | Forensique | LazySysAdmin2</a><li><a href="/CTFs/HeroCTF_2024/Forensique/Tenant_trouble">CTFs | HeroCTF_2024 | Forensique | Tenant trouble</a></ul></div><div id="access-tags"><div class="panel-heading">Trending Tags</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/ctf/">CTF</a> <a class="post-tag" href="/tags/web/">Web</a> <a class="post-tag" href="/tags/forensique/">Forensique</a> <a class="post-tag" href="/tags/404ctf/">404CTF</a> <a class="post-tag" href="/tags/stegano/">Stegano</a> <a class="post-tag" href="/tags/fcsc/">FCSC</a> <a class="post-tag" href="/tags/forensic/">Forensic</a> <a class="post-tag" href="/tags/osint/">OSINT</a> <a class="post-tag" href="/tags/stega/">Stega</a> <a class="post-tag" href="/tags/reverse/">Reverse</a></div></div></div><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.js"></script><div id="toc-wrapper" class="pl-0 pr-4 mb-5"><div class="panel-heading pl-3 pt-2 mb-2">Contents</div><nav id="toc" data-toggle="toc"></nav></div></div></div><div class="row"><div id="tail-wrapper" class="col-12 col-lg-11 col-xl-9 pl-3 pr-3 pr-xl-4"><div id="related-posts" class="mt-5 mb-2 mb-sm-4"><h3 class="pt-2 mt-1 mb-4 ml-1" data-toc-skip>Further Reading</h3><div class="card-deck mb-4"><div class="card"> <a href="/Notes/Footprinting/Port_Enumeration"><div class="card-body"> <em class="small" data-ts="1661810400" data-df="ll" > Aug 30, 2022 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Notes | Port Enumeration</h3><div class="text-muted small"><p> Port Enumeration Capture The Flag (CTF) are challenges that allows us to train ourseves on different tools and techniques. The first step will usually be a port scanning. But in a real world envir...</p></div></div></a></div><div class="card"> <a href="/Notes/Footprinting/OSINT"><div class="card-body"> <em class="small" data-ts="1661896800" data-df="ll" > Aug 31, 2022 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Notes | OSINT</h3><div class="text-muted small"><p> OSINT Open Source INTeligence refers to the gathering and analysis of information from open sources to create useful intelligence. In a classic penetration test it will be our first step but in CT...</p></div></div></a></div><div class="card"> <a href="/CTFs/404CTF_2023/Web/Fuite_en_1791"><div class="card-body"> <em class="small" data-ts="1685916000" data-df="ll" > Jun 5, 2023 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>CTFs | 404CTF_2023 | Web | Fuite en 1791</h3><div class="text-muted small"><p> Fuite en 1791 In this challenge, we arrive on a web page where we can’t access the file because of the link that is expired: Just adding a big expiry date after the signature will give us acc...</p></div></div></a></div></div></div><div class="post-navigation d-flex justify-content-between"> <a href="/Notes/Footprinting/OSINT" class="btn btn-outline-primary" prompt="Older"><p>Notes | OSINT</p></a> <a href="/Notes/Privilege_Escalation/Windows_PE" class="btn btn-outline-primary" prompt="Newer"><p>Notes | Windows Privilege Escalation</p></a></div></div></div><footer class="row pl-3 pr-3"><div class="col-12 d-flex justify-content-between align-items-center text-muted pl-0 pr-0"><div class="footer-left"><p class="mb-0"> © 2025 <a href="https://github.com/Nouman404/">Bat</a>. <span data-toggle="tooltip" data-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author.">Some rights reserved.</span></p></div><div class="footer-right"><p class="mb-0"> Powered by <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a> with <a href="https://github.com/cotes2020/jekyll-theme-chirpy" target="_blank" rel="noopener">Chirpy</a> theme.</p></div></div></footer></div><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-12 col-sm-11 post-content"><div id="search-hints"><div id="access-tags"><div class="panel-heading">Trending Tags</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/ctf/">CTF</a> <a class="post-tag" href="/tags/web/">Web</a> <a class="post-tag" href="/tags/forensique/">Forensique</a> <a class="post-tag" href="/tags/404ctf/">404CTF</a> <a class="post-tag" href="/tags/stegano/">Stegano</a> <a class="post-tag" href="/tags/fcsc/">FCSC</a> <a class="post-tag" href="/tags/forensic/">Forensic</a> <a class="post-tag" href="/tags/osint/">OSINT</a> <a class="post-tag" href="/tags/stega/">Stega</a> <a class="post-tag" href="/tags/reverse/">Reverse</a></div></div></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><div id="mask"></div><a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a><div id="notification" class="toast" role="alert" aria-live="assertive" aria-atomic="true" data-animation="true" data-autohide="false"><div class="toast-header"> <button type="button" class="ml-2 ml-auto close" data-dismiss="toast" aria-label="Close"> <span aria-hidden="true">&times;</span> </button></div><div class="toast-body text-center pt-0"><p class="pl-2 pr-2 mb-3">A new version of content is available.</p><button type="button" class="btn btn-primary" aria-label="Update"> Update </button></div></div><script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.10.0/dest/simple-jekyll-search.min.js"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5">Oops! No result founds.</p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); </script> <script src="https://cdn.jsdelivr.net/combine/npm/magnific-popup@1/dist/jquery.magnific-popup.min.js,npm/lozad/dist/lozad.min.js,npm/clipboard@2/dist/clipboard.min.js"></script> <script src="https://cdn.jsdelivr.net/combine/npm/dayjs@1/dayjs.min.js,npm/dayjs@1/locale/en.min.js,npm/dayjs@1/plugin/relativeTime.min.js,npm/dayjs@1/plugin/localizedFormat.min.js"></script> <script defer src="/assets/js/dist/post.min.js"></script> <script src="https://cdn.jsdelivr.net/npm/bootstrap@4/dist/js/bootstrap.bundle.min.js"></script> <script defer src="/app.js"></script>
