<!DOCTYPE html><html lang="en" data-mode="dark" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="generator" content="Jekyll v4.4.1" /><meta property="og:title" content="Notes Password Cracking" /><meta name="author" content="BatBato" /><meta property="og:locale" content="en" /><meta name="description" content="Password Cracking" /><meta property="og:description" content="Password Cracking" /><link rel="canonical" href="nouman404.github.io/Notes/Brute_Force/Password_Cracking" /><meta property="og:url" content="nouman404.github.io/Notes/Brute_Force/Password_Cracking" /><meta property="og:site_name" content="BatBato’s Blog" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2022-08-25T00:00:00+02:00" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="Notes Password Cracking" /><meta name="twitter:site" content="@twitter_username" /><meta name="twitter:creator" content="@BatBato" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"BlogPosting","author":{"@type":"Person","name":"BatBato"},"dateModified":"2022-09-12T20:46:46+02:00","datePublished":"2022-08-25T00:00:00+02:00","description":"Password Cracking","headline":"Notes Password Cracking","mainEntityOfPage":{"@type":"WebPage","@id":"nouman404.github.io/Notes/Brute_Force/Password_Cracking"},"url":"nouman404.github.io/Notes/Brute_Force/Password_Cracking"}</script><title>Notes | Password Cracking | BatBato's Blog</title><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/site.webmanifest"><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico"><meta name="apple-mobile-web-app-title" content="BatBato's Blog"><meta name="application-name" content="BatBato's Blog"><meta name="msapplication-TileColor" content="#da532c"><meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin><link rel="dns-prefetch" href="https://fonts.gstatic.com" crossorigin><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://cdn.jsdelivr.net" ><link rel="dns-prefetch" href="https://cdn.jsdelivr.net" ><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Lato&family=Source+Sans+Pro:wght@400;600;700;900&display=swap"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4/dist/css/bootstrap.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css"><link rel="stylesheet" href="/assets/css/style.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/magnific-popup@1/dist/magnific-popup.min.css"> <script src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script><body data-spy="scroll" data-target="#toc" data-topbar-visible="true"><div id="sidebar" class="d-flex flex-column align-items-end"><div class="profile-wrapper text-center"><div id="avatar"> <a href="/" class="mx-auto"> <img src="/assets/img/icon.jpg" alt="avatar" onerror="this.style.display='none'"> </a></div><div class="site-title mt-3"> <a href="/">BatBato's Blog</a></div><div class="site-subtitle font-italic">BatBato was here :)</div></div><ul class="w-100"><li class="nav-item"> <a href="/" class="nav-link"> <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i> <span>HOME</span> </a><li class="nav-item"> <a href="/categories/" class="nav-link"> <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i> <span>CATEGORIES</span> </a><li class="nav-item"> <a href="/notes/" class="nav-link"> <i class="fa-fw fas fa-sticky-note ml-xl-3 mr-xl-3 unloaded"></i> <span>NOTES</span> </a><li class="nav-item"> <a href="/sources/" class="nav-link"> <i class="fa-fw fas fa-folder-open ml-xl-3 mr-xl-3 unloaded"></i> <span>SOURCES</span> </a><li class="nav-item"> <a href="/about/" class="nav-link"> <i class="fa-fw fas fa-info-circle ml-xl-3 mr-xl-3 unloaded"></i> <span>ABOUT</span> </a><li class="nav-item"> <a href="/archives/" class="nav-link"> <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i> <span>ARCHIVES</span> </a></ul><div class="sidebar-bottom mt-auto d-flex flex-wrap justify-content-center align-items-center"> <a href="https://github.com/Nouman404" aria-label="github" target="_blank" rel="noopener"> <i class="fab fa-github"></i> </a> <a href="https://app.hackthebox.com/profile/235762" aria-label="hackthebox" target="_blank" rel="noopener"> <i class="fas fa-cube"></i> </a> <a href="https://tryhackme.com/p/Batbato" aria-label="tryhackme" target="_blank" rel="noopener"> <i class="fas fa-cloud"></i> </a> <a href="https://www.root-me.org/BatBato" aria-label="rootme" target="_blank" rel="noopener"> <i class="fas fa-skull"></i> </a></div></div><div id="topbar-wrapper"><div id="topbar" class="container d-flex align-items-center justify-content-between h-100 pl-3 pr-3 pl-md-4 pr-md-4"> <span id="breadcrumb"> <span> <a href="/"> Home </a> </span> <span>Notes | Password Cracking</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> Post</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" autocomplete="off" placeholder="Search..."> </span> <span id="search-cancel" >Cancel</span></div></div><div id="main-wrapper" class="d-flex justify-content-center"><div id="main" class="container pl-xl-4 pr-xl-4"><div class="row"><div id="core-wrapper" class="col-12 col-lg-11 col-xl-9 pr-xl-4"><div class="post pl-1 pr-1 pl-md-2 pr-md-2"><h1 data-toc-skip>Notes | Password Cracking</h1><div class="post-meta text-muted"> <span> Posted <em class="" data-ts="1661378400" data-df="ll" data-toggle="tooltip" data-placement="bottom"> Aug 25, 2022 </em> </span> <span> Updated <em class="" data-ts="1663008406" data-df="ll" data-toggle="tooltip" data-placement="bottom"> Sep 12, 2022 </em> </span><div class="d-flex justify-content-between"> <span> By <em> Bat </em> </span><div> <span class="readtime" data-toggle="tooltip" data-placement="bottom" title="1678 words"> <em>9 min</em> read</span></div></div></div><div class="post-content"><h1 id="password-cracking">Password Cracking</h1><p>We are now in an era where password that you will find will not be in clear text and ready to use (most of the time). They will be “hashed”. You may have heard terms like “hash”, “hash functions”, “cracking a hash”… But what does it mean ? First of all, what is a hash function ? A hash function is, as its name suggests, a mathematical function that generates a string (list of characters). This generated string is called a hash. Let’s call the hash function “f” and “x” is the password that we want to hash. Then we get <code class="language-plaintext highlighter-rouge">f(x)=y</code> where “y” is the hash. What’s cool about hashes it’s that we can’t reverse the function. This means that with “y” we can’t find “x” even if we know “f”. The other cool thing about hash functions is that whatever you put on it (our “x”), you will always have a different result. Let’s take a concrete example. MD5 is an old hash function, we are going to hash <code class="language-plaintext highlighter-rouge">password</code> and <code class="language-plaintext highlighter-rouge">password1</code> with it :</p><div class="language-console highlighter-rouge"><div class="code-header"> <span data-label-text="Console"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre><span class="go">MD5("password") = 5f4dcc3b5aa765d61d8327deb882cf99
MD5("password1") = 7c6a180b36896a0a8c02787eeafb0e4c
</span></pre></table></code></div></div><p>As you can see, we have used as input two strings that only have one difference but the two hashes are completely different. That’s why hashing function are used instead of encoding. Because we can reverse encoding.</p><p>We often hear people saying “I cracked the hash” and you will tell me, “But how is it possible if we can’t reverse it?”. The first method (that you will never use) is to try any possible combination like “a”, “b”…“aa”, “ab”… This method takes too much time. What we will do instead is using a list containing many passwords that have been used by real people in the past and are likely to be used again. The word list we are going to use is called <code class="language-plaintext highlighter-rouge">rockyou</code> and contains 14 million passwords but we can use others depending on the country the victim is and/or create our own wordlists.</p><blockquote class="prompt-tip"><div><p>The rockyou file is located at <code class="language-plaintext highlighter-rouge">/usr/share/wordlists/rockyou.txt</code>. If you haven’t a <code class="language-plaintext highlighter-rouge">.txt</code> file you may have a <code class="language-plaintext highlighter-rouge">.tar.gz</code> file that you can unzip with the command <code class="language-plaintext highlighter-rouge">tar -xf rockyou.tar.gz</code>. You can download it from <a href="https://github.com/praetorian-inc/Hob0Rules">here</a> for example.</p></div></blockquote><blockquote class="prompt-info"><div><p>Wikipedia : “In December 2009, the RockYou company experienced a data breach resulting in the exposure of over <code class="language-plaintext highlighter-rouge">32 million user accounts</code>. The company used an unencrypted database to store user account data, including <code class="language-plaintext highlighter-rouge">plaintext passwords</code>. They also did not allow using special characters in the passwords. The hacker used a <code class="language-plaintext highlighter-rouge">10-year-old SQL vulnerability</code> to gain access to the database. The company took days to notify users after the incident, and initially incorrectly reported that the breach only affected older applications when it actually affected all RockYou users.The full list of passwords exposed as a result of the breach is <code class="language-plaintext highlighter-rouge">available in Kali Linux</code>, and has been since its launch in 2013. Due to its easy attainability and comprehensive length, it is commonly <code class="language-plaintext highlighter-rouge">used in dictionary attacks</code>”</p></div></blockquote><h2 id="hashcat"><span class="mr-2">Hashcat</span><a href="#hashcat" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>Of course you can create your own python script to “crack” the hash. But here we aregoing to see how to use already available tools. Let’s beggin with <code class="language-plaintext highlighter-rouge">hashcat</code> which is an advanced CPU-based password recovery utility.</p><blockquote class="prompt-info"><div><p>You can install <code class="language-plaintext highlighter-rouge">hashcat</code> with the following command : <code class="language-plaintext highlighter-rouge">sudo apt install hashcat</code></p></div></blockquote><p>The basic hashcat command looks like this : <code class="language-plaintext highlighter-rouge">hashcat -m MODE HASH|HASHFILE DICTIONARY</code>. Where <code class="language-plaintext highlighter-rouge">MODE</code> will be a number that tells hashcat which hashing algorithm was used. <code class="language-plaintext highlighter-rouge">HASH</code> or <code class="language-plaintext highlighter-rouge">HASHFILE</code> represents the hash string or a file containing one or more hash. <code class="language-plaintext highlighter-rouge">DICTIONARY</code> will be our dictionary (ex: <code class="language-plaintext highlighter-rouge">rockyou</code>).</p><h3 id="mode"><span class="mr-2">Mode</span><a href="#mode" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>To know which mode to use you need to know which hash algorithm was used (MD5, SHA, NTLM…). The first option will be to use already existing tools such as <code class="language-plaintext highlighter-rouge">hash-identifier</code> or <code class="language-plaintext highlighter-rouge">hashid</code>. There are many other tools that you can use but we will talk about this two here.</p><p>To use <code class="language-plaintext highlighter-rouge">hash-identifier</code> you only need to type <code class="language-plaintext highlighter-rouge">hash-identifier</code> in your terminal and once it’s done you need to give a hash. Let’s use the MD5 hash of “password”:</p><div class="language-console highlighter-rouge"><div class="code-header"> <span data-label-text="Console"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
</pre><td class="rouge-code"><pre><span class="gp">└─$</span><span class="w"> </span>hash-identifier                                                               
<span class="gp">   #</span><span class="c">########################################################################</span>
<span class="gp">   #</span><span class="w">     </span>__  __                     __           ______    _____           <span class="c">#</span>
<span class="gp">   #</span><span class="w">    </span>/<span class="se">\ \/\ \ </span>                  /<span class="se">\ \ </span>        /<span class="se">\_</span>_  _<span class="se">\ </span> /<span class="se">\ </span> _ <span class="sb">`</span><span class="se">\ </span>        <span class="c">#</span>
<span class="gp">   #</span><span class="w">    </span><span class="se">\ \ \_\ \ </span>    __      ____ <span class="se">\ \ \_</span>__     <span class="se">\/</span>_/<span class="se">\ \/</span>  <span class="se">\ \ \/\ \ </span>       <span class="c">#</span>
<span class="gp">   #</span><span class="w">     </span><span class="se">\ \ </span> _  <span class="se">\ </span> /<span class="s1">'__`\   / ,__\ \ \  _ `\      \ \ \   \ \ \ \ \       #
</span><span class="gp">   #</span><span class="w">      </span><span class="s1">\ \ \ \ \/\ \_\ \_/\__, `\ \ \ \ \ \      \_\ \__ \ \ \_\ \      #
</span><span class="gp">   #</span><span class="w">       </span><span class="s1">\ \_\ \_\ \___ \_\/\____/  \ \_\ \_\     /\_____\ \ \____/      #
</span><span class="gp">   #</span><span class="w">        </span><span class="s1">\/_/\/_/\/__/\/_/\/___/    \/_/\/_/     \/_____/  \/___/  v1.2 #
</span><span class="gp">   #</span><span class="w">                                                             </span><span class="s1">By Zion3R #
</span><span class="gp">   #</span><span class="w">                                                    </span><span class="s1">www.Blackploit.com #
</span><span class="gp">   #</span><span class="w">                                                   </span><span class="s1">Root@Blackploit.com #
</span><span class="gp">   #</span><span class="s1">########################################################################
</span><span class="go">--------------------------------------------------
 HASH: 5f4dcc3b5aa765d61d8327deb882cf99

Possible Hashs:
[+] MD5
</span><span class="gp">[+] Domain Cached Credentials - MD4(MD4(($</span>pass<span class="o">))</span>.<span class="o">(</span>strtolower<span class="o">(</span><span class="nv">$username</span><span class="o">)))</span>
<span class="go">
Least Possible Hashs:
[+] RAdmin v2.x
[+] NTLM
[+] MD4
[+] MD2
[+] MD5(HMAC)
[+] MD4(HMAC)
[+] MD2(HMAC)
[+] MD5(HMAC(Wordpress))
</span></pre></table></code></div></div><p>As you can see the tool tells you that the most possible hash type is <code class="language-plaintext highlighter-rouge">MD5</code>. Some times, this tools can give you false positive so try another hash type if the first hash type is not the good one.</p><p>To use <code class="language-plaintext highlighter-rouge">hashid</code> you only need to type <code class="language-plaintext highlighter-rouge">hashid HASH</code> in your terminal. Let’s use the MD5 hash of “password”:</p><div class="language-console highlighter-rouge"><div class="code-header"> <span data-label-text="Console"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
</pre><td class="rouge-code"><pre><span class="gp">└─$</span><span class="w"> </span>hashid 5f4dcc3b5aa765d61d8327deb882cf99
<span class="go">Analyzing '5f4dcc3b5aa765d61d8327deb882cf99'
[+] MD2 
[+] MD5 
[+] MD4 
[+] Double MD5 
[+] LM 
[+] RIPEMD-128 
[+] Haval-128 
[+] Tiger-128 
[+] Skein-256(128) 
[+] Skein-512(128) 
[+] Lotus Notes/Domino 5 
[+] Skype 
[+] Snefru-128 
[+] NTLM 
[+] Domain Cached Credentials 
[+] Domain Cached Credentials 2 
[+] DNSSEC(NSEC3) 
[+] RAdmin v2.x 
</span></pre></table></code></div></div><blockquote class="prompt-tip"><div><p>You can use the <code class="language-plaintext highlighter-rouge">-m</code> flag to show hashcat mode for each hash type with <code class="language-plaintext highlighter-rouge">hashid</code> like : <code class="language-plaintext highlighter-rouge">hashid HASH -m</code></p></div></blockquote><p>When you know the hash type you can <code class="language-plaintext highlighter-rouge">CTRL+F</code> the hash name on <a href="https://hashcat.net/wiki/doku.php?id=example_hashes">this site</a> to know which mode to use. The number in the first column is the hash type. You can also <code class="language-plaintext highlighter-rouge">CTRL+F</code> to search for patterns, for example <code class="language-plaintext highlighter-rouge">sha512crypt</code> always begin with <code class="language-plaintext highlighter-rouge">$6$</code> so if you search for this string you will get the hash type <code class="language-plaintext highlighter-rouge">1800</code>.</p><h3 id="cracking"><span class="mr-2">Cracking</span><a href="#cracking" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>Now that we know that <code class="language-plaintext highlighter-rouge">MD5</code> is the mode <code class="language-plaintext highlighter-rouge">0</code>, we can try to recover the password.</p><div class="language-console highlighter-rouge"><div class="code-header"> <span data-label-text="Console"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
</pre><td class="rouge-code"><pre><span class="gp">└─$</span><span class="w"> </span>hashcat <span class="nt">-m</span> 0 5f4dcc3b5aa765d61d8327deb882cf99 /usr/share/wordlists/rockyou.txt
<span class="go">hashcat (v6.2.5) starting

</span><span class="gp">&lt;SNIP&gt;</span><span class="w">
</span><span class="go">
Dictionary cache hit:
* Filename..: /usr/share/wordlists/rockyou.txt
* Passwords.: 14344385
* Bytes.....: 139921507
* Keyspace..: 14344385

5f4dcc3b5aa765d61d8327deb882cf99:password                 
                                                          
Session..........: hashcat
Status...........: Cracked
Hash.Mode........: 0 (MD5)
Hash.Target......: 5f4dcc3b5aa765d61d8327deb882cf99
Time.Started.....: Mon Aug 29 12:12:44 2022 (0 secs)
Time.Estimated...: Mon Aug 29 12:12:44 2022 (0 secs)
Kernel.Feature...: Pure Kernel
Guess.Base.......: File (/usr/share/wordlists/rockyou.txt)
Guess.Queue......: 1/1 (100.00%)
</span><span class="gp">Speed.#</span>1.........:    94480 H/s <span class="o">(</span>0.25ms<span class="o">)</span> @ Accel:512 Loops:1 Thr:1 Vec:8
<span class="go">Recovered........: 1/1 (100.00%) Digests
Progress.........: 4096/14344385 (0.03%)
Rejected.........: 0/4096 (0.00%)
Restore.Point....: 0/14344385 (0.00%)
</span><span class="gp">Restore.Sub.#</span>1...: Salt:0 Amplifier:0-1 Iteration:0-1
<span class="go">Candidate.Engine.: Device Generator
</span><span class="gp">Candidates.#</span>1....: 123456 -&gt; oooooo
<span class="gp">Hardware.Mon.#</span>1..: Util:  7%
<span class="go">
Started: Mon Aug 29 12:12:38 2022
Stopped: Mon Aug 29 12:12:46 2022
</span></pre></table></code></div></div><p>So how you can see, the status is <code class="language-plaintext highlighter-rouge">Cracked</code> and the password is printed just before the big block beginning with the <code class="language-plaintext highlighter-rouge">Session</code> section as <code class="language-plaintext highlighter-rouge">HASH:PASSWORD</code></p><h3 id="rules"><span class="mr-2">Rules</span><a href="#rules" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>COMMING SOON</p><h2 id="john-the-ripper"><span class="mr-2">John The Ripper</span><a href="#john-the-ripper" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>Just like <code class="language-plaintext highlighter-rouge">hashcat</code> <code class="language-plaintext highlighter-rouge">John The Ripper</code> also known as <code class="language-plaintext highlighter-rouge">john</code> is a password cracking tool. You can use <code class="language-plaintext highlighter-rouge">john</code> as follows: <code class="language-plaintext highlighter-rouge">john HASHFILE</code> or <code class="language-plaintext highlighter-rouge">john --wordlist=WORDLIST HASHFILE</code>. You don’t need to specify the type of hash but it’s preferable to do so because if not it will take more time. You can use it like this</p><div class="language-console highlighter-rouge"><div class="code-header"> <span data-label-text="Console"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="go">john hash.txt --format=raw-md5 --wordlist=wordlist.txt
</span></pre></table></code></div></div><blockquote class="prompt-info"><div><p>You can install <code class="language-plaintext highlighter-rouge">John</code> with the following command : <code class="language-plaintext highlighter-rouge">sudo apt install john</code></p></div></blockquote><blockquote class="prompt-tip"><div><p>You can see all formats with the command <code class="language-plaintext highlighter-rouge">john --list=formats</code>. I advise you to grep the type you are looking for like <code class="language-plaintext highlighter-rouge">john --list=formats | grep -iF "md5"</code></p></div></blockquote><p>John can also be used to crack files protected with a password. We are going to see how to crack some.</p><h3 id="john-and-rsa-key"><span class="mr-2">John and RSA key</span><a href="#john-and-rsa-key" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p><code class="language-plaintext highlighter-rouge">SSH keys</code> can be used to connect to a server without passwords. Thank’s to this an attacker can’t connect to the server if he doesn’t have the key. To increase the security, we can add a <code class="language-plaintext highlighter-rouge">password</code> to the SSH key. John allows us to crack this password.</p><ol><li><div class="language-console highlighter-rouge"><div class="code-header"> <span data-label-text="Console"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="gp">python  /usr/share/john/ssh2john.py id_rsa &gt;</span><span class="w"> </span>id_rsa.hash
</pre></table></code></div></div><li><div class="language-console highlighter-rouge"><div class="code-header"> <span data-label-text="Console"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="go">john --wordlist=/usr/share/wordlists/rockyou.txt id_rsa.hash
</span></pre></table></code></div></div></ol><p>The first step put the password hash in a file called <code class="language-plaintext highlighter-rouge">id_rsa.hash</code>. The second step try to crack it. You can now connect to the victim machine with the command and then provide the password for the ssh key: <code class="language-plaintext highlighter-rouge">ssh -i id_rsa user@IP</code></p><h3 id="unshadow"><span class="mr-2">Unshadow</span><a href="#unshadow" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>If you arrive on a machine and can access the <code class="language-plaintext highlighter-rouge">passwd</code> and the <code class="language-plaintext highlighter-rouge">shadow</code> file, this can be leveraged to get the password of any user (if their hash can be cracked). The <code class="language-plaintext highlighter-rouge">unshadow</code> command is a Linux command that allows us to combine the passwd and the shadow files. It can be used like this : <code class="language-plaintext highlighter-rouge">unshadow passwd shadow &gt; unshadowed.txt</code>. We can now try to crack the passwords of each user with the following command :</p><div class="language-console highlighter-rouge"><div class="code-header"> <span data-label-text="Console"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="go">john --wordlist=/usr/share/wordlists/rockyou.txt --format=sha512crypt unshadowed.txt
</span></pre></table></code></div></div><h3 id="zip-and-rar-files"><span class="mr-2">Zip and RAR files</span><a href="#zip-and-rar-files" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>You can encounter zip or rar files protected with a password. As for the SSH key, we will proceed in two steps. First we recover the hash of the password and then we crack it.</p><h4 id="zip"><span class="mr-2">Zip</span><a href="#zip" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><div class="language-console highlighter-rouge"><div class="code-header"> <span data-label-text="Console"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="gp">zip2john crack2.zip &gt;</span><span class="w"> </span>zip.hashes
</pre></table></code></div></div><div class="language-console highlighter-rouge"><div class="code-header"> <span data-label-text="Console"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="go">john zip.hashes
</span></pre></table></code></div></div><p>or</p><div class="language-console highlighter-rouge"><div class="code-header"> <span data-label-text="Console"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="go">john --wordlist=wordlist.txt zip.hashes
</span></pre></table></code></div></div><h4 id="rar"><span class="mr-2">Rar</span><a href="#rar" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><div class="language-console highlighter-rouge"><div class="code-header"> <span data-label-text="Console"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="gp">rar2john crack.rar &gt;</span><span class="w"> </span>zip.hashes
</pre></table></code></div></div><div class="language-console highlighter-rouge"><div class="code-header"> <span data-label-text="Console"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="go">john --wordlist=wordlist.txt zip.hashes
</span></pre></table></code></div></div><h3 id="more-john-functionalities"><span class="mr-2">More John functionalities</span><a href="#more-john-functionalities" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>There are many more type of files that john can crack here are some more examples :</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
</pre><td class="rouge-code"><pre>bitlocker2john
dmg2john
eapmd5tojohn
gpg2john
hccap2john
keepass2john
putty2john
racf2john
rar2john
raw2dyna
uaf2john
vncpcap2john
wpapcap2john
zip2john
</pre></table></code></div></div></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw mr-1"></i> <a href='/categories/notes/'>Notes</a>, <a href='/categories/brute-force/'>Brute Force</a></div><div class="post-tags"> <i class="fa fa-tags fa-fw mr-1"></i> <a href="/tags/brute-force/" class="post-tag no-text-decoration" >Brute Force</a> <a href="/tags/passwords/" class="post-tag no-text-decoration" >Passwords</a> <a href="/tags/credentials/" class="post-tag no-text-decoration" >Credentials</a> <a href="/tags/cracking/" class="post-tag no-text-decoration" >Cracking</a></div><div class="post-tail-bottom d-flex justify-content-between align-items-center mt-3 pt-5 pb-2"><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/"> CC BY 4.0 </a> by the author.</div><div class="share-wrapper"> <span class="share-label text-muted mr-1">Share</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=Notes+%7C+Password+Cracking+-+BatBato%27s+Blog&url=nouman404.github.io%2FNotes%2FBrute_Force%2FPassword_Cracking" data-toggle="tooltip" data-placement="top" title="Twitter" target="_blank" rel="noopener" aria-label="Twitter"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=Notes+%7C+Password+Cracking+-+BatBato%27s+Blog&u=nouman404.github.io%2FNotes%2FBrute_Force%2FPassword_Cracking" data-toggle="tooltip" data-placement="top" title="Facebook" target="_blank" rel="noopener" aria-label="Facebook"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://t.me/share/url?url=nouman404.github.io%2FNotes%2FBrute_Force%2FPassword_Cracking&text=Notes+%7C+Password+Cracking+-+BatBato%27s+Blog" data-toggle="tooltip" data-placement="top" title="Telegram" target="_blank" rel="noopener" aria-label="Telegram"> <i class="fa-fw fab fa-telegram"></i> </a> <i id="copy-link" class="fa-fw fas fa-link small" data-toggle="tooltip" data-placement="top" title="Copy link" data-title-succeed="Link copied successfully!"> </i> </span></div></div></div></div></div><div id="panel-wrapper" class="col-xl-3 pl-2 text-muted"><div class="access"><div id="access-lastmod" class="post"><div class="panel-heading">Recently Updated</div><ul class="post-content pl-0 pb-1 ml-1 mt-2"><li><a href="/Notes/AD/AD_Basics">Notes | AD | AD Basics</a><li><a href="/Notes/AD/Tools">Notes | AD | AD Tools</a><li><a href="/CTFs/HeroCTF_2024/Steganographie/Zipper">CTFs | HeroCTF_2024 | Steganographie | Zipper</a><li><a href="/CTFs/HeroCTF_2024/Forensique/LazySysAdmin2">CTFs | HeroCTF_2024 | Forensique | LazySysAdmin2</a><li><a href="/CTFs/HeroCTF_2024/Forensique/Tenant_trouble">CTFs | HeroCTF_2024 | Forensique | Tenant trouble</a></ul></div><div id="access-tags"><div class="panel-heading">Trending Tags</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/ctf/">CTF</a> <a class="post-tag" href="/tags/web/">Web</a> <a class="post-tag" href="/tags/forensique/">Forensique</a> <a class="post-tag" href="/tags/404ctf/">404CTF</a> <a class="post-tag" href="/tags/stegano/">Stegano</a> <a class="post-tag" href="/tags/fcsc/">FCSC</a> <a class="post-tag" href="/tags/forensic/">Forensic</a> <a class="post-tag" href="/tags/osint/">OSINT</a> <a class="post-tag" href="/tags/stega/">Stega</a> <a class="post-tag" href="/tags/reverse/">Reverse</a></div></div></div><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.js"></script><div id="toc-wrapper" class="pl-0 pr-4 mb-5"><div class="panel-heading pl-3 pt-2 mb-2">Contents</div><nav id="toc" data-toggle="toc"></nav></div></div></div><div class="row"><div id="tail-wrapper" class="col-12 col-lg-11 col-xl-9 pl-3 pr-3 pr-xl-4"><div id="related-posts" class="mt-5 mb-2 mb-sm-4"><h3 class="pt-2 mt-1 mb-4 ml-1" data-toc-skip>Further Reading</h3><div class="card-deck mb-4"><div class="card"> <a href="/Notes/Brute_Force/Brute_Force"><div class="card-body"> <em class="small" data-ts="1661378400" data-df="ll" > Aug 25, 2022 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Notes | Brute Force</h3><div class="text-muted small"><p> Brute Force According to Wikipedia, “Brute Force attack consists of an attacker submitting many passwords or passphrases with the hope of eventually guessing correctly”. It may not be effective in...</p></div></div></a></div><div class="card"> <a href="/Notes/AD/AD_Basics"><div class="card-body"> <em class="small" data-ts="1712527200" data-df="ll" > Apr 8, 2024 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Notes | AD | AD Basics</h3><div class="text-muted small"><p> Active Directory Introduction Well, well well… Here we are. Doing an Active Directory introduction note. Lets start by defining what is Active directory. Active Directory (AD), is the windows dir...</p></div></div></a></div><div class="card"> <a href="/Notes/Linux/Linux_Fondamentals"><div class="card-body"> <em class="small" data-ts="1661292000" data-df="ll" > Aug 24, 2022 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Notes | Linux Fondamentals</h3><div class="text-muted small"><p> Linux Fondamentals First of all, why learn Linux? Well, when it comes to computing, Linux is a very useful operating system. It has many useful tools and offers high performance on different netwo...</p></div></div></a></div></div></div><div class="post-navigation d-flex justify-content-between"> <a href="/Notes/Brute_Force/Brute_Force" class="btn btn-outline-primary" prompt="Older"><p>Notes | Brute Force</p></a> <a href="/Notes/Privilege_Escalation/Linux_PE" class="btn btn-outline-primary" prompt="Newer"><p>Notes | Linux Privilege Escalation</p></a></div></div></div><footer class="row pl-3 pr-3"><div class="col-12 d-flex justify-content-between align-items-center text-muted pl-0 pr-0"><div class="footer-left"><p class="mb-0"> © 2025 <a href="https://github.com/Nouman404/">Bat</a>. <span data-toggle="tooltip" data-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author.">Some rights reserved.</span></p></div><div class="footer-right"><p class="mb-0"> Powered by <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a> with <a href="https://github.com/cotes2020/jekyll-theme-chirpy" target="_blank" rel="noopener">Chirpy</a> theme.</p></div></div></footer></div><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-12 col-sm-11 post-content"><div id="search-hints"><div id="access-tags"><div class="panel-heading">Trending Tags</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/ctf/">CTF</a> <a class="post-tag" href="/tags/web/">Web</a> <a class="post-tag" href="/tags/forensique/">Forensique</a> <a class="post-tag" href="/tags/404ctf/">404CTF</a> <a class="post-tag" href="/tags/stegano/">Stegano</a> <a class="post-tag" href="/tags/fcsc/">FCSC</a> <a class="post-tag" href="/tags/forensic/">Forensic</a> <a class="post-tag" href="/tags/osint/">OSINT</a> <a class="post-tag" href="/tags/stega/">Stega</a> <a class="post-tag" href="/tags/reverse/">Reverse</a></div></div></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><div id="mask"></div><a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a><div id="notification" class="toast" role="alert" aria-live="assertive" aria-atomic="true" data-animation="true" data-autohide="false"><div class="toast-header"> <button type="button" class="ml-2 ml-auto close" data-dismiss="toast" aria-label="Close"> <span aria-hidden="true">&times;</span> </button></div><div class="toast-body text-center pt-0"><p class="pl-2 pr-2 mb-3">A new version of content is available.</p><button type="button" class="btn btn-primary" aria-label="Update"> Update </button></div></div><script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.10.0/dest/simple-jekyll-search.min.js"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5">Oops! No result founds.</p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); </script> <script src="https://cdn.jsdelivr.net/combine/npm/magnific-popup@1/dist/jquery.magnific-popup.min.js,npm/lozad/dist/lozad.min.js,npm/clipboard@2/dist/clipboard.min.js"></script> <script src="https://cdn.jsdelivr.net/combine/npm/dayjs@1/dayjs.min.js,npm/dayjs@1/locale/en.min.js,npm/dayjs@1/plugin/relativeTime.min.js,npm/dayjs@1/plugin/localizedFormat.min.js"></script> <script defer src="/assets/js/dist/post.min.js"></script> <script src="https://cdn.jsdelivr.net/npm/bootstrap@4/dist/js/bootstrap.bundle.min.js"></script> <script defer src="/app.js"></script>
