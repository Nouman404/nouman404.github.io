<!DOCTYPE html><html lang="en" data-mode="dark" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="generator" content="Jekyll v4.4.1" /><meta property="og:title" content="Notes AD AD Tools" /><meta name="author" content="BatBato" /><meta property="og:locale" content="en" /><meta name="description" content="Introduction" /><meta property="og:description" content="Introduction" /><link rel="canonical" href="nouman404.github.io/Notes/AD/Tools" /><meta property="og:url" content="nouman404.github.io/Notes/AD/Tools" /><meta property="og:site_name" content="BatBato’s Blog" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2025-08-08T00:00:00+02:00" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="Notes AD AD Tools" /><meta name="twitter:site" content="@twitter_username" /><meta name="twitter:creator" content="@BatBato" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"BlogPosting","author":{"@type":"Person","name":"BatBato"},"dateModified":"2025-08-09T12:32:02+02:00","datePublished":"2025-08-08T00:00:00+02:00","description":"Introduction","headline":"Notes AD AD Tools","mainEntityOfPage":{"@type":"WebPage","@id":"nouman404.github.io/Notes/AD/Tools"},"url":"nouman404.github.io/Notes/AD/Tools"}</script><title>Notes | AD | AD Tools | BatBato's Blog</title><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/site.webmanifest"><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico"><meta name="apple-mobile-web-app-title" content="BatBato's Blog"><meta name="application-name" content="BatBato's Blog"><meta name="msapplication-TileColor" content="#da532c"><meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin><link rel="dns-prefetch" href="https://fonts.gstatic.com" crossorigin><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://cdn.jsdelivr.net" ><link rel="dns-prefetch" href="https://cdn.jsdelivr.net" ><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Lato&family=Source+Sans+Pro:wght@400;600;700;900&display=swap"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4/dist/css/bootstrap.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css"><link rel="stylesheet" href="/assets/css/style.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/magnific-popup@1/dist/magnific-popup.min.css"> <script src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script><body data-spy="scroll" data-target="#toc" data-topbar-visible="true"><div id="sidebar" class="d-flex flex-column align-items-end"><div class="profile-wrapper text-center"><div id="avatar"> <a href="/" class="mx-auto"> <img src="/assets/img/icon.jpg" alt="avatar" onerror="this.style.display='none'"> </a></div><div class="site-title mt-3"> <a href="/">BatBato's Blog</a></div><div class="site-subtitle font-italic">BatBato was here :)</div></div><ul class="w-100"><li class="nav-item"> <a href="/" class="nav-link"> <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i> <span>HOME</span> </a><li class="nav-item"> <a href="/categories/" class="nav-link"> <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i> <span>CATEGORIES</span> </a><li class="nav-item"> <a href="/notes/" class="nav-link"> <i class="fa-fw fas fa-sticky-note ml-xl-3 mr-xl-3 unloaded"></i> <span>NOTES</span> </a><li class="nav-item"> <a href="/sources/" class="nav-link"> <i class="fa-fw fas fa-folder-open ml-xl-3 mr-xl-3 unloaded"></i> <span>SOURCES</span> </a><li class="nav-item"> <a href="/about/" class="nav-link"> <i class="fa-fw fas fa-info-circle ml-xl-3 mr-xl-3 unloaded"></i> <span>ABOUT</span> </a><li class="nav-item"> <a href="/archives/" class="nav-link"> <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i> <span>ARCHIVES</span> </a></ul><div class="sidebar-bottom mt-auto d-flex flex-wrap justify-content-center align-items-center"> <a href="https://github.com/Nouman404" aria-label="github" target="_blank" rel="noopener"> <i class="fab fa-github"></i> </a> <a href="https://app.hackthebox.com/profile/235762" aria-label="hackthebox" target="_blank" rel="noopener"> <i class="fas fa-cube"></i> </a> <a href="https://tryhackme.com/p/Batbato" aria-label="tryhackme" target="_blank" rel="noopener"> <i class="fas fa-cloud"></i> </a> <a href="https://www.root-me.org/BatBato" aria-label="rootme" target="_blank" rel="noopener"> <i class="fas fa-skull"></i> </a></div></div><div id="topbar-wrapper"><div id="topbar" class="container d-flex align-items-center justify-content-between h-100 pl-3 pr-3 pl-md-4 pr-md-4"> <span id="breadcrumb"> <span> <a href="/"> Home </a> </span> <span>Notes | AD | AD Tools</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> Post</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" autocomplete="off" placeholder="Search..."> </span> <span id="search-cancel" >Cancel</span></div></div><div id="main-wrapper" class="d-flex justify-content-center"><div id="main" class="container pl-xl-4 pr-xl-4"><div class="row"><div id="core-wrapper" class="col-12 col-lg-11 col-xl-9 pr-xl-4"><div class="post pl-1 pr-1 pl-md-2 pr-md-2"><h1 data-toc-skip>Notes | AD | AD Tools</h1><div class="post-meta text-muted"> <span> Posted <em class="" data-ts="1754604000" data-df="ll" data-toggle="tooltip" data-placement="bottom"> Aug 8, 2025 </em> </span> <span> Updated <em class="" data-ts="1754735522" data-df="ll" data-toggle="tooltip" data-placement="bottom"> Aug 9, 2025 </em> </span><div class="d-flex justify-content-between"> <span> By <em> Bat </em> </span><div> <span class="readtime" data-toggle="tooltip" data-placement="bottom" title="4822 words"> <em>26 min</em> read</span></div></div></div><div class="post-content"><h1 id="introduction">Introduction</h1><p>This post is about understanding how the main tools work, because it is great to achieve an attack but it’s better if you can do it from scratch. So if you know how tools work, then you know how attacks work.</p><h1 id="nmap">Nmap</h1><h2 id="definition"><span class="mr-2">Definition</span><a href="#definition" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p><code class="language-plaintext highlighter-rouge">Nmap</code> is a powerful network scanning tool used to discover hosts, services, and vulnerabilities by performing port scanning, OS detection, and more.</p><h2 id="default-use-case"><span class="mr-2">Default Use Case</span><a href="#default-use-case" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>To check if a machine is <code class="language-plaintext highlighter-rouge">UP</code> or not, <code class="language-plaintext highlighter-rouge">nmap</code> pings the host and if it answers to the ping, then it marks it as <code class="language-plaintext highlighter-rouge">UP</code>. If there is no answer, <code class="language-plaintext highlighter-rouge">nmap</code> will try connecting to port <code class="language-plaintext highlighter-rouge">80</code> (<code class="language-plaintext highlighter-rouge">http</code>) and <code class="language-plaintext highlighter-rouge">443</code> (<code class="language-plaintext highlighter-rouge">https</code>) via a <code class="language-plaintext highlighter-rouge">TCP</code> connection.</p><p>By default, <code class="language-plaintext highlighter-rouge">nmap</code> scans the <code class="language-plaintext highlighter-rouge">1000 TCP</code> most used ports on the given target (ex: <code class="language-plaintext highlighter-rouge">nmap $TARGET</code>). If we read the documentation, we see that it divides ports into six states: <code class="language-plaintext highlighter-rouge">open</code>, <code class="language-plaintext highlighter-rouge">closed</code>, <code class="language-plaintext highlighter-rouge">filtered</code>, <code class="language-plaintext highlighter-rouge">unfiltered</code>, <code class="language-plaintext highlighter-rouge">open|filtered</code>, or <code class="language-plaintext highlighter-rouge">closed|filtered</code>.</p><div class="table-wrapper"><table><thead><tr><th>State<th>Description<tbody><tr><td><strong>open</strong><td>An application is actively accepting TCP connections, UDP datagrams or SCTP associations on this port. Finding these is often the primary goal of port scanning. Security-minded people know that each open port is an avenue for attack. Attackers and pen-testers want to exploit the open ports, while administrators try to close or protect them with firewalls without thwarting legitimate users. Open ports are also interesting for non-security scans because they show services available for use on the network.<tr><td><strong>closed</strong><td>A <code class="language-plaintext highlighter-rouge">closed port is accessible</code> (it receives and responds to Nmap probe packets), but there is no application listening on it. They can be helpful in showing that a host is up on an IP address (host discovery, or ping scanning), and as part of OS detection. Because <code class="language-plaintext highlighter-rouge">closed ports are reachable</code>, it may be worth scanning later in case some open up. Administrators may want to consider blocking such ports with a firewall. Then they would appear in the filtered state, discussed next.<tr><td><strong>filtered</strong><td>Nmap cannot determine whether the port is open because packet filtering prevents its probes from reaching the port. The filtering could be from a dedicated <code class="language-plaintext highlighter-rouge">firewall device</code>, <code class="language-plaintext highlighter-rouge">router rules</code>, or <code class="language-plaintext highlighter-rouge">host-based firewall software</code>. These ports frustrate attackers because they provide so little information. Sometimes they respond with ICMP error messages such as type 3 code 13 (destination unreachable: communication administratively prohibited), but filters that simply drop probes without responding are far more common. This forces Nmap to retry several times just in case the probe was dropped due to network congestion rather than filtering. This slows down the scan dramatically.<tr><td><strong>unfiltered</strong><td>The unfiltered state means that a <code class="language-plaintext highlighter-rouge">port is accessible</code>, but Nmap is <code class="language-plaintext highlighter-rouge">unable to determine whether it is open or closed</code>. Only the ACK scan, which is used to map firewall rulesets, classifies ports into this state. Scanning unfiltered ports with other scan types such as Window scan, SYN scan, or FIN scan, may help resolve whether the port is open.<tr><td><strong>open|filtered</strong><td>Nmap places ports in this state when it is unable to determine whether a port is open or filtered. This occurs for scan types in which open ports give no response. The lack of response could also mean that a packet filter dropped the probe or any response it elicited. So Nmap does not know for sure whether the port is open or being filtered. The UDP, IP protocol, FIN, NULL, and Xmas scans classify ports this way.<tr><td><strong>closed|filtered</strong><td>This state is used when Nmap is unable to determine whether a port is closed or filtered. It is only used for the IP ID idle scan.</table></div><p>By default <code class="language-plaintext highlighter-rouge">Nmap</code> will use the <code class="language-plaintext highlighter-rouge">TCP SYN scan</code> (<code class="language-plaintext highlighter-rouge">-sS</code> flag). It requires <code class="language-plaintext highlighter-rouge">root</code> privileges to run. It will send a <code class="language-plaintext highlighter-rouge">SYN</code> packet and wait for an answer from the target. If it receive a <code class="language-plaintext highlighter-rouge">SYN/ACK</code>, it means that the port is listening (<code class="language-plaintext highlighter-rouge">open</code>). If the response is <code class="language-plaintext highlighter-rouge">RST</code> (reset) then the port is marked as <code class="language-plaintext highlighter-rouge">closed</code> (<code class="language-plaintext highlighter-rouge">non-listenener</code>). If no response is received then the port is marked as <code class="language-plaintext highlighter-rouge">filtered</code>.</p><blockquote class="prompt-info"><div><p>The <code class="language-plaintext highlighter-rouge">SYN</code> scan won’t finish the 3-way-handshake. It will not send the <code class="language-plaintext highlighter-rouge">ACK</code> after receiving the <code class="language-plaintext highlighter-rouge">SYN/ACK</code>.</p></div></blockquote><h2 id="more-options"><span class="mr-2">More options</span><a href="#more-options" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p><code class="language-plaintext highlighter-rouge">-sU</code>: This flag does an <code class="language-plaintext highlighter-rouge">UDP</code> scan instead of a <code class="language-plaintext highlighter-rouge">TCP</code> one. It will send specific payload to port having specific protocols (<code class="language-plaintext highlighter-rouge">DNS</code>, <code class="language-plaintext highlighter-rouge">SNMP</code>, <code class="language-plaintext highlighter-rouge">ICMP</code>) or empty packets for every other ports. This will allow to speed up a little <code class="language-plaintext highlighter-rouge">UDP</code> scans. <code class="language-plaintext highlighter-rouge">UDP</code> scans are slow because we can’t be sure that the machine received the packet we sent or not because they don’t make the 3-way-handshake as <code class="language-plaintext highlighter-rouge">TCP</code> does, some packets may get lost, because of timeouts or because of some protections like firewalls or IDS. Closed port often send an <code class="language-plaintext highlighter-rouge">ICMP port unreachable</code> error, but many hosts rate limit <code class="language-plaintext highlighter-rouge">ICMP port unreachable</code> messages by default. For example, the Linux 2.4.20 kernel limits destination unreachable messages to one per second (in net/ipv4/icmp.c). This will make a 65536 port scan last 18 hours. And as the man says <code class="language-plaintext highlighter-rouge">Nmap detects rate limiting and slows down accordingly to avoid flooding the network with useless packets that the target machine will drop.</code>.</p><blockquote class="prompt-tip"><div><p>You can speed up your <code class="language-plaintext highlighter-rouge">UDP</code> by running it on multiple hosts at the same time, scanning from behind the firewall, and using <code class="language-plaintext highlighter-rouge">--host-timeout</code> to skip slow hosts.</p></div></blockquote><p><code class="language-plaintext highlighter-rouge">-sT</code>: The <code class="language-plaintext highlighter-rouge">TCP connect</code> scan replace the default <code class="language-plaintext highlighter-rouge">SYN</code> when it is not applicable. It is less stealthy because it will do the full 3-way-handshake (<code class="language-plaintext highlighter-rouge">SYN -&gt; SYN/ACK -&gt; ACK</code>), close the connection (<code class="language-plaintext highlighter-rouge">FIN -&gt; FIN/ACK -&gt; ACK</code>) and may trigger alerts on the audited systems. The main advantage of this scan is that it doesn’t require <code class="language-plaintext highlighter-rouge">root</code> privilege. An other advantage is that it does the 3-way-handshake and close the connection, thus being less brutal than the <code class="language-plaintext highlighter-rouge">SYN</code> scan that will not close its connection.</p><p><code class="language-plaintext highlighter-rouge">-Pn</code>: Sometimes you get an error from <code class="language-plaintext highlighter-rouge">nmap</code> that tells you to run with this option because the machine appears to be down for nmap. This option is the <code class="language-plaintext highlighter-rouge">No ping</code> scan. This means that it will not ping the host to check if it is <code class="language-plaintext highlighter-rouge">UP</code> or not but instead, it will mark it as <code class="language-plaintext highlighter-rouge">UP</code> without verification.</p><p><code class="language-plaintext highlighter-rouge">-sV</code>: The <code class="language-plaintext highlighter-rouge">Version detection</code> is based on response received by <code class="language-plaintext highlighter-rouge">nmap</code> when it does its scan. It has more than 6500 pattern on over 650 protocols. Those information are stored in the <code class="language-plaintext highlighter-rouge">nmap-service-rprobe</code> database that contains probes for querying various services and match expressions to recognize and parse responses.</p><p><code class="language-plaintext highlighter-rouge">-sC</code>: You can run nmap with this flag to run the default set of script. This uses the <code class="language-plaintext highlighter-rouge">Nmap Scripting Engine</code> (NSE) and you can find information on the different categories of script <a href="https://nmap.org/book/nse-usage.html#nse-categories">here</a>. Those scripts are wrote using the <code class="language-plaintext highlighter-rouge">LUA</code> programming language. <code class="language-plaintext highlighter-rouge">Nmap</code> is very flexible allowing you to write and use your own script with it.</p><blockquote class="prompt-tip"><div><p>To provide your own script either run the <code class="language-plaintext highlighter-rouge">--script $FILENAME</code> or in <code class="language-plaintext highlighter-rouge">/usr/share/nmap/scripts/</code>. You can provide the <code class="language-plaintext highlighter-rouge">*</code> regex to select all scripts that start with a word (ex: <code class="language-plaintext highlighter-rouge">ftp-*</code>). You can also use <code class="language-plaintext highlighter-rouge">default</code>, <code class="language-plaintext highlighter-rouge">intrusive</code> or <code class="language-plaintext highlighter-rouge">safe</code> scans with mathematical <code class="language-plaintext highlighter-rouge">and</code> and <code class="language-plaintext highlighter-rouge">or</code> (ex: <code class="language-plaintext highlighter-rouge">--script "(default or safe or intrusive) and not http-*"</code>)</p></div></blockquote><p><code class="language-plaintext highlighter-rouge">-O</code>: The <code class="language-plaintext highlighter-rouge">OS detection</code> flag allows us to get more information about the <code class="language-plaintext highlighter-rouge">OS</code> of the target like the name (windows, linux, mac…), the version, the device type (router, switch…). It is based on a database (<code class="language-plaintext highlighter-rouge">nmap-os-db</code>) of known OS fingerprints. <code class="language-plaintext highlighter-rouge">Nmap</code> will connect to the host and check if there is a known fingerprint for it, if so the information will be printed out.</p><h1 id="ffuf-gobuster">Ffuf, gobuster…</h1><h2 id="definition-1"><span class="mr-2">Definition</span><a href="#definition-1" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>All the tools like <code class="language-plaintext highlighter-rouge">Ffuf</code>, <code class="language-plaintext highlighter-rouge">gobuster</code>, <code class="language-plaintext highlighter-rouge">dirsearch</code>… are used to brute-force directories, files, domains and parameters on web servers to discover hidden content or vulnerabilities.</p><p>Here I am going to talk about the <code class="language-plaintext highlighter-rouge">vhost</code>, the <code class="language-plaintext highlighter-rouge">subdomain</code> and page scanning.</p><p>Because web severs can host multiple websites, we can chose which website to show for which domain. This is <code class="language-plaintext highlighter-rouge">virtual hosting</code>. So the server is the one that will answer to your request. To specify which web site you want to reach, you specify it in the <code class="language-plaintext highlighter-rouge">Host: XXX</code> <code class="language-plaintext highlighter-rouge">HTTP</code> header.</p><p>Because we want people to access our <code class="language-plaintext highlighter-rouge">vhosts</code> on our server, we create a <code class="language-plaintext highlighter-rouge">DNS</code> record of those so they have a corresponding <code class="language-plaintext highlighter-rouge">IP</code> linked to them.</p><p><strong>In summary:</strong></p><div class="table-wrapper"><table><thead><tr><th><strong>Feature</strong><th><strong>Subdomains</strong><th><strong>Virtual Hosts (vhosts)</strong><tbody><tr><td><strong>Definition</strong><td>Prefixes added to a domain in DNS (e.g., <code class="language-plaintext highlighter-rouge">sub.domain.com</code>)<td>Server configuration that serves multiple sites on one server<tr><td><strong>Purpose</strong><td>Organize sections of a domain or services. <br />Also allows to create a DNS record for a specific IP address.<td>Host multiple websites on the same server.<tr><td><strong>DNS Relation</strong><td>Configured in DNS<td>Configured on the web server (Apache, Nginx, etc.)<tr><td><strong>Example</strong><td><code class="language-plaintext highlighter-rouge">blog.example.com</code>, <code class="language-plaintext highlighter-rouge">shop.example.com</code><td>Web server hosting both <code class="language-plaintext highlighter-rouge">example.com</code> and <code class="language-plaintext highlighter-rouge">another.com</code> on the same IP</table></div><blockquote class="prompt-tip"><div><p>If you like pretty outputs with emojis and stuff, check out <a href="https://github.com/epi052/feroxbuster">feroxbuster</a> or <a href="https://github.com/maurosoria/dirsearch">dirsearch</a></p></div></blockquote><p>To be able to detect if a <code class="language-plaintext highlighter-rouge">subdomain</code> exists or not, tools like <code class="language-plaintext highlighter-rouge">ffuf</code> or <code class="language-plaintext highlighter-rouge">gobuster</code> will do a <code class="language-plaintext highlighter-rouge">DNS</code> query (usually an <code class="language-plaintext highlighter-rouge">A</code> record lookup) to check if the the subdomains resolves to an IP address or not. If and <code class="language-plaintext highlighter-rouge">IP</code> is found, then the tool can contact it and start scanning it.</p><p>For <code class="language-plaintext highlighter-rouge">vhost</code> detection, we do a basic <code class="language-plaintext highlighter-rouge">HTTP</code> request specifying <code class="language-plaintext highlighter-rouge">Host: XXX</code> , where <code class="language-plaintext highlighter-rouge">XXX</code> is the <code class="language-plaintext highlighter-rouge">vhost</code> we want to test. Depending on the result we receive from the server, we will guess if the <code class="language-plaintext highlighter-rouge">vhost</code> exist or not. For example, with <code class="language-plaintext highlighter-rouge">ffuf</code>, we exclude the response length we receive from the first list of <code class="language-plaintext highlighter-rouge">vhost</code> and that we know are not real ones.</p><p><strong>In summary:</strong></p><div class="table-wrapper"><table><thead><tr><th><strong>Enumeration Type</strong><th><strong>Protocol Used</strong><th><strong>What is Sent</strong><th><strong>What is Expected</strong><tbody><tr><td><strong>Subdomain Enumeration</strong><td>DNS (UDP/53)<td>DNS queries<td>IP address for valid subdomains (A or CNAME records)<tr><td><strong>Vhost Enumeration</strong><td>HTTP/HTTPS (TCP/80 or 443)<td>HTTP requests with different <code class="language-plaintext highlighter-rouge">Host</code> headers<td>Valid virtual host content or errors</table></div><p>For page or directory scanning, those tools only do an <code class="language-plaintext highlighter-rouge">HTTP</code> request (DNS resolution automatically done to get the IP of the domain) and based on the response (<code class="language-plaintext highlighter-rouge">200</code>, <code class="language-plaintext highlighter-rouge">301</code>, <code class="language-plaintext highlighter-rouge">404</code>…) they tell you if you have access, if it is forbidden for you, if the page does not exist… You can also filter by page size, number of words…</p><blockquote class="prompt-tip"><div><p>A web server can chose not to respect the standard of the HTTP status code and return a status code 200 even if the webpage doesn’t exists. We can then filter by the size of the response from the server, number of words…</p></div></blockquote><p><strong>In summary:</strong></p><div class="table-wrapper"><table><thead><tr><th><strong>Status Code</strong><th><strong>Category</strong><th><strong>Description</strong><tbody><tr><td><strong>100</strong><td>Informational<td>Continue: The server has received the request headers, and the client should proceed to send the request body.<tr><td><strong>101</strong><td>Informational<td>Switching Protocols: The server is switching to a different protocol as requested by the client.<tr><td><strong>200</strong><td>Success<td>OK: The request was successful, and the server returned the requested data.<tr><td><strong>201</strong><td>Success<td>Created: The request was successful, and a new resource has been created.<tr><td><strong>202</strong><td>Success<td>Accepted: The request has been accepted for processing, but the processing is not complete.<tr><td><strong>204</strong><td>Success<td>No Content: The request was successful, but the server is not returning any content.<tr><td><strong>301</strong><td>Redirection<td>Moved Permanently: The requested resource has been moved to a new permanent URL.<tr><td><strong>302</strong><td>Redirection<td>Found (Temporary Redirect): The requested resource is temporarily at a different URL.<tr><td><strong>304</strong><td>Redirection<td>Not Modified: The cached version of the requested resource can be used.<tr><td><strong>400</strong><td>Client Error<td>Bad Request: The request was invalid or cannot be understood by the server.<tr><td><strong>401</strong><td>Client Error<td>Unauthorized: Authentication is required to access the resource.<tr><td><strong>403</strong><td>Client Error<td>Forbidden: The server understood the request, but it refuses to authorize it.<tr><td><strong>404</strong><td>Client Error<td>Not Found: The server could not find the requested resource.<tr><td><strong>405</strong><td>Client Error<td>Method Not Allowed: The HTTP method used is not allowed for the requested resource.<tr><td><strong>408</strong><td>Client Error<td>Request Timeout: The server timed out waiting for the client to send the request.<tr><td><strong>418</strong><td>Client Error<td>I’m a teapot. Used for requests they do not wish to handle<tr><td><strong>429</strong><td>Client Error<td>Too Many Requests: The client has sent too many requests in a given period.<tr><td><strong>500</strong><td>Server Error<td>Internal Server Error: The server encountered an error and could not complete the request.<tr><td><strong>502</strong><td>Server Error<td>Bad Gateway: The server was acting as a gateway or proxy and received an invalid response from the upstream server.<tr><td><strong>503</strong><td>Server Error<td>Service Unavailable: The server is temporarily unavailable, usually due to maintenance or overload.<tr><td><strong>504</strong><td>Server Error<td>Gateway Timeout: The server was acting as a gateway and did not receive a timely response from the upstream server.</table></div><h2 id="default-use-case-1"><span class="mr-2">Default Use Case</span><a href="#default-use-case-1" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><h3 id="ffuf"><span class="mr-2">Ffuf</span><a href="#ffuf" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>For the <code class="language-plaintext highlighter-rouge">vhost</code> scan you can fuzz like this (where <code class="language-plaintext highlighter-rouge">4242</code> is the size of the response for a bad `vhost):</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>ffuf <span class="nt">-w</span> /path/to/vhost/wordlist <span class="nt">-u</span> https://target <span class="nt">-H</span> <span class="s2">"Host: FUZZ.target"</span> <span class="nt">-fs</span> 4242
</pre></table></code></div></div><p>For <code class="language-plaintext highlighter-rouge">subdomains</code> you can run the following command:</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>ffuf <span class="nt">-w</span> /path/to/dns/wordlist <span class="nt">-u</span> https://FUZZ.target
</pre></table></code></div></div><p>And for page or directory listing you can just run the following:</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>ffuf <span class="nt">-w</span> /path/to/dir/wordlist <span class="nt">-u</span> https://target/FUZZ
</pre></table></code></div></div><h3 id="gobuster"><span class="mr-2">Gobuster</span><a href="#gobuster" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>For the <code class="language-plaintext highlighter-rouge">vhost</code> scan you can fuzz like this (where <code class="language-plaintext highlighter-rouge">4242</code> is the size of the response for a bad `vhost):</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>gobuster vhost <span class="nt">-w</span> /path/to/vhost/wordlist <span class="nt">-u</span> https://target
</pre></table></code></div></div><p>For <code class="language-plaintext highlighter-rouge">subdomains</code> you can run the following command:</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>gobuster dns <span class="nt">-w</span> /path/to/dns/wordlist <span class="nt">-d</span> <span class="nv">$DOMAIN</span>
</pre></table></code></div></div><blockquote class="prompt-tip"><div><p>You may want to add the <code class="language-plaintext highlighter-rouge">-i</code> option so that you have the IP address of the found domains printed out.</p></div></blockquote><p>And for page or directory listing you can just run the following:</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>gobuster <span class="nb">dir</span> <span class="nt">-w</span> /path/to/dir/wordlist <span class="nt">-u</span> https://target
</pre></table></code></div></div><h2 id="more-options-1"><span class="mr-2">More options</span><a href="#more-options-1" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><h3 id="ffuf-1"><span class="mr-2">Ffuf</span><a href="#ffuf-1" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p><code class="language-plaintext highlighter-rouge">-fc, -fl, -fs, -fw</code>: You can filter responses by a lot of things like status code (<code class="language-plaintext highlighter-rouge">-fc</code>), the amount of line in the response (<code class="language-plaintext highlighter-rouge">-fl</code>), the response size (<code class="language-plaintext highlighter-rouge">-fs</code>), the amount of words (<code class="language-plaintext highlighter-rouge">-fw</code>) and much more…</p><p><code class="language-plaintext highlighter-rouge">-recusion</code>: This allows us to do recursive search on the found folders.</p><blockquote class="prompt-tip"><div><p>If you know that there will be a lot of folders, you can add <code class="language-plaintext highlighter-rouge">-recusion-depth X</code> where <code class="language-plaintext highlighter-rouge">X</code> is the maximum depth where <code class="language-plaintext highlighter-rouge">Fuff</code> is going to check.</p></div></blockquote><p><code class="language-plaintext highlighter-rouge">-e $A,$B,$C</code>: This allows you to provide one or multiple extensions (<code class="language-plaintext highlighter-rouge">$A,$B,$C</code> looks like <code class="language-plaintext highlighter-rouge">.htlm,.php,.txt</code>)</p><p><code class="language-plaintext highlighter-rouge">-t 50</code>: If you want to speed up your scanning, you can increase the number of threads.</p><blockquote class="prompt-danger"><div><p>Don’t put a number of thread too big. It may cause the site to crash, ban you or give you a lot of errors.</p></div></blockquote><p>For more information about this tool, you can check <a href="https://codingo.io/tools/ffuf/bounty/2020/09/17/everything-you-need-to-know-about-ffuf.html">codingo</a> website.</p><h3 id="gobuster-1"><span class="mr-2">Gobuster</span><a href="#gobuster-1" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p><code class="language-plaintext highlighter-rouge">-x $A,$B,$C</code>: This allows you to provide one or multiple extensions (<code class="language-plaintext highlighter-rouge">$A,$B,$C</code> looks like <code class="language-plaintext highlighter-rouge">htlm,php,txt</code>)</p><blockquote class="prompt-danger"><div><p>Pay attention to the fact that in <code class="language-plaintext highlighter-rouge">ffuf</code> extension we use the notation <code class="language-plaintext highlighter-rouge">-e .EXTENSION</code> but in <code class="language-plaintext highlighter-rouge">gobuster</code> we only provide the extension without the dot (<code class="language-plaintext highlighter-rouge">-x EXTENSION</code>).</p></div></blockquote><p><code class="language-plaintext highlighter-rouge">-t 50</code>: If you want to speed up your scanning, you can increase the number of threads.</p><h1 id="responder">Responder</h1><h2 id="definition-2"><span class="mr-2">Definition</span><a href="#definition-2" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p><code class="language-plaintext highlighter-rouge">Responder</code> focuses on capturing authentication credentials from protocols such as <code class="language-plaintext highlighter-rouge">SMB</code>, <code class="language-plaintext highlighter-rouge">HTTP</code> or <code class="language-plaintext highlighter-rouge">LDAP</code> by spoofing domain names or listening for incoming domain name resolution with protocols like <strong>LLMNR</strong> (Link-Local Multicast Name Resolution), <strong>NBT-NS</strong> (NetBIOS Name Service), and <strong>mDNS</strong> (Multicast DNS).</p><p><code class="language-plaintext highlighter-rouge">Responder</code> comes into two modes:</p><ul><li><p><code class="language-plaintext highlighter-rouge">Listening/passive</code> mode (<code class="language-plaintext highlighter-rouge">-A, --analyze</code> flag):<br /> → <code class="language-plaintext highlighter-rouge">Responder</code> waits for “someone” (a computer not a user) to do a name resolution and responds as the host to be resolved as</p><li><p><code class="language-plaintext highlighter-rouge">Active</code> mode:<br /> → <code class="language-plaintext highlighter-rouge">Responder</code> sets up a <code class="language-plaintext highlighter-rouge">SMB</code>, <code class="language-plaintext highlighter-rouge">HTTP</code> or <code class="language-plaintext highlighter-rouge">WPAD</code> server to get authentication of the user → Spoof protocols like <strong>LLMNR, NBT-NS, mDNS</strong> → Then, the client sends authentication credentials such as NTLM challenge via protocols like <code class="language-plaintext highlighter-rouge">SMB</code> that we then can crack offline or use them for relay</p></ul><p>• <strong>LLMNR, NBT-NS, mDNS Poisoning</strong>: Spoof <strong>LLMNR, NBT-NS</strong> or <strong>mDNS</strong> protocols to asnwer to the victim and capture challenges (<code class="language-plaintext highlighter-rouge">Net-NTLM hashes</code>). • <strong>SMB and HTTP Server</strong>: Acts as a fake <code class="language-plaintext highlighter-rouge">SMB</code> or <code class="language-plaintext highlighter-rouge">HTTP</code> server to capture <code class="language-plaintext highlighter-rouge">NTLM</code> hashes.<br /> • <strong>WPAD Rogue Proxy Server</strong>: Captures web proxy auto-discovery protocol requests and redirects them to capture <code class="language-plaintext highlighter-rouge">Net-NTLM</code> hash.</p><h2 id="default-use-case-2"><span class="mr-2">Default Use Case</span><a href="#default-use-case-2" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>The default use case is <code class="language-plaintext highlighter-rouge">responder -I $INTERFACE</code> where <code class="language-plaintext highlighter-rouge">$INTERFACE</code> is the interface linked to your network.</p><p>By default, <code class="language-plaintext highlighter-rouge">Responder</code> will start poisoning on the name resolution protocols <code class="language-plaintext highlighter-rouge">LLMNR</code>, <code class="language-plaintext highlighter-rouge">NBT-NS</code>, <code class="language-plaintext highlighter-rouge">MDNS</code> and <code class="language-plaintext highlighter-rouge">DNS</code>:</p><p><img data-src="https://raw.githubusercontent.com/Nouman404/nouman404.github.io/main/_posts/Notes/photos/Tools_Resp_Poisoners.png" alt="[Tools_Resp_Poisoners.png]" data-proofer-ignore></p><p>And it opens several servers on your machine (<code class="language-plaintext highlighter-rouge">SMB</code>, <code class="language-plaintext highlighter-rouge">HTTP</code>, <code class="language-plaintext highlighter-rouge">FTP</code>…) for users to connect to:</p><p><img data-src="https://raw.githubusercontent.com/Nouman404/nouman404.github.io/main/_posts/Notes/photos/Tools_Resp_Servers.png" alt="[Tools_Resp_Servers.png]" data-proofer-ignore></p><p>Once you launch it, wait for someone to connect to you and try to authenticate. You can capture <code class="language-plaintext highlighter-rouge">NTLM</code> hash and try to crack them with <code class="language-plaintext highlighter-rouge">hashcat</code> or relay them with <a href="https://nouman404.github.io/Notes/tools#ntlmrelayx">ntlmrelayx</a>:</p><p><img data-src="https://raw.githubusercontent.com/Nouman404/nouman404.github.io/main/_posts/Notes/photos/Tools_Resp_Hash.png" alt="[Tools_Resp_Hash.png]" data-proofer-ignore></p><h2 id="more-options-2"><span class="mr-2">More options</span><a href="#more-options-2" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>You can append <code class="language-plaintext highlighter-rouge">-wd</code> to the initial command. the <code class="language-plaintext highlighter-rouge">-w</code> allows you to start the <code class="language-plaintext highlighter-rouge">WPAD rogue proxy server</code> and the <code class="language-plaintext highlighter-rouge">-d</code> allows you to answer for <code class="language-plaintext highlighter-rouge">DHCP</code> broadcast requests.</p><blockquote class="prompt-warning"><div><p>Note that the <code class="language-plaintext highlighter-rouge">-d</code> option will inject a <code class="language-plaintext highlighter-rouge">WPAD</code> server in the <code class="language-plaintext highlighter-rouge">DHCP</code> response</p></div></blockquote><h1 id="ntlmrelayx">ntlmrelayx</h1><h2 id="definition-3"><span class="mr-2">Definition</span><a href="#definition-3" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p><code class="language-plaintext highlighter-rouge">Ntlmrelayr</code> is a tool that relays <code class="language-plaintext highlighter-rouge">NTLM</code> authentication requests to different services, allowing an attacker to gain unauthorized access through relay attacks. The targets we will be looking for are any server on a domain that doesn’t have the <code class="language-plaintext highlighter-rouge">signing</code> set to <code class="language-plaintext highlighter-rouge">True</code> (protocols not signed).</p><blockquote class="prompt-tip"><div><p>To have better understanding on the <code class="language-plaintext highlighter-rouge">NTLM</code> authentication mechanism you can check <a href="https://nouman404.github.io/Notes/AD/AD_Basics#ntlm">here</a> and for the relay attack, check <a href="https://nouman404.github.io/Notes/AD/AD_Basics#ntlm-relay">there</a></p></div></blockquote><h2 id="default-use-case-3"><span class="mr-2">Default Use Case</span><a href="#default-use-case-3" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p><code class="language-plaintext highlighter-rouge">Ntlmrelayx</code> will relay received connections to the correct server allowing us to get authenticated connections. You can run the following command :</p><p><code class="language-plaintext highlighter-rouge">ntlmrelayx -tf targets.txt -of netntlm -smb2support -socks</code></p><p><code class="language-plaintext highlighter-rouge">-tf $TARGETS</code> contains the list of the servers you want to relay to. <code class="language-plaintext highlighter-rouge">-of $FILENAME</code> will save the response that is based on the client hash so you can try to crack them later <code class="language-plaintext highlighter-rouge">-smb2support</code> allows us to support <code class="language-plaintext highlighter-rouge">SMB v2</code> <code class="language-plaintext highlighter-rouge">-socks</code> starts a socks proxy to run commands via received authenticated connections. This will allow us to execute commands as a specific user without knowing his password</p><p>With those options enabled, we can see the incoming successful authentications :</p><p><img data-src="https://raw.githubusercontent.com/Nouman404/nouman404.github.io/main/_posts/Notes/photos/Tools_ntlmrelayx_cmd.png" alt="[Tools_ntlmrelayx_cmd.png]" data-proofer-ignore></p><blockquote class="prompt-info"><div><p>Those connections come from <code class="language-plaintext highlighter-rouge">Reponder</code> that send them to <code class="language-plaintext highlighter-rouge">ntlmrelayx</code> for relay</p></div></blockquote><p>By running the command <code class="language-plaintext highlighter-rouge">socks</code>, we can see all spoofed users and if they are admin or not of the server:</p><p><img data-src="https://raw.githubusercontent.com/Nouman404/nouman404.github.io/main/_posts/Notes/photos/Tools_ntlmrelayx_socks.png" alt="[Tools_ntlmrelayx_socks.png]" data-proofer-ignore> <code class="language-plaintext highlighter-rouge">ntlmrelayx</code> will create a session for each relayed connection (as we can see above). Other tools using proxies like <code class="language-plaintext highlighter-rouge">proxychains</code> should check on local port <code class="language-plaintext highlighter-rouge">1080</code> (by default on <code class="language-plaintext highlighter-rouge">ntlmrelayx</code>) if a session is available for the specific IP and port. If so, it will try to connect to it but it may need admin rights depending on the action we want to realize (<code class="language-plaintext highlighter-rouge">AdminStatus</code> set to <code class="language-plaintext highlighter-rouge">TRUE</code>).</p><p>Because we use the option <code class="language-plaintext highlighter-rouge">socks</code>, we can now run commands with <code class="language-plaintext highlighter-rouge">proxychains</code> like a <code class="language-plaintext highlighter-rouge">secretsdump</code> with the admin user:</p><p><img data-src="https://raw.githubusercontent.com/Nouman404/nouman404.github.io/main/_posts/Notes/photos/Tools_ntlmrelayx_secdump.png" alt="[Tools_ntlmrelayx_secdump.png]" data-proofer-ignore></p><blockquote class="prompt-danger"><div><p>You can use tools from <code class="language-plaintext highlighter-rouge">impacket</code> using the <code class="language-plaintext highlighter-rouge">-no-pass</code> option if you are using a relayed connection. If the option is not available, just specify an empty password and it should work the same. Only SMB and LDAP can be relayed.</p></div></blockquote><blockquote class="prompt-tip"><div><p>Here, we used <code class="language-plaintext highlighter-rouge">ntlmrelayx</code> with <code class="language-plaintext highlighter-rouge">responder</code> but you can use it with <code class="language-plaintext highlighter-rouge">coercer</code> to force the connection instead of waiting for it.</p></div></blockquote><p>Tools like <code class="language-plaintext highlighter-rouge">nxc</code> (previously <code class="language-plaintext highlighter-rouge">cme</code>) don’t have the <code class="language-plaintext highlighter-rouge">-no-pass</code> option. Just specify an empty password (or whatever you want, it will be ignored in any case) and it should be OK:</p><p><img data-src="https://raw.githubusercontent.com/Nouman404/nouman404.github.io/main/_posts/Notes/photos/Tools_ntlmrelayx_nxc.png" alt="[Tools_ntlmrelayx_nxc.png]" data-proofer-ignore></p><h2 id="more-options-3"><span class="mr-2">More options</span><a href="#more-options-3" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p><code class="language-plaintext highlighter-rouge">-t $PROTOCOL://$SERVER</code> if you want to relay to other protocols, you can specify it directly in the command line with this option.</p><blockquote class="prompt-tip"><div><p>It is also possible to prepend it in the file when we use the <code class="language-plaintext highlighter-rouge">-tf</code> option. We will have lines like <code class="language-plaintext highlighter-rouge">ldap://192.168.56.12</code> or <code class="language-plaintext highlighter-rouge">smb://192.168.56.12</code>.</p></div></blockquote><blockquote class="prompt-danger"><div><p>Note that when we used the tool to relay to<code class="language-plaintext highlighter-rouge">SMB</code> we could create <code class="language-plaintext highlighter-rouge">socks</code> to have a stable connection. This is not the case when we relay to <code class="language-plaintext highlighter-rouge">LDAP</code>. You will have to use the tools option to specify what to do like <code class="language-plaintext highlighter-rouge">--add-computer $COMPUTER_NAME</code>.</p></div></blockquote><p><code class="language-plaintext highlighter-rouge">-l $LOOT_DIR</code> will dump the looted information in this <code class="language-plaintext highlighter-rouge">$LOOT_DIR</code> like <code class="language-plaintext highlighter-rouge">SAM</code> or <code class="language-plaintext highlighter-rouge">LDAP</code> information. By default, if a relayed connection allows an <code class="language-plaintext highlighter-rouge">LDAP</code> connection then <code class="language-plaintext highlighter-rouge">ntlmrelayx</code> will generate files based on the information found on the <code class="language-plaintext highlighter-rouge">LDAP</code> using <code class="language-plaintext highlighter-rouge">ldapdomaindump</code> (e.g. list of computer by <code class="language-plaintext highlighter-rouge">OS</code>, list of users with their description, list domain policies…)</p><h1 id="lsassy">lsassy</h1><h2 id="definition-4"><span class="mr-2">Definition</span><a href="#definition-4" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p><code class="language-plaintext highlighter-rouge">Lsassy</code> is a post-exploitation tool designed to extract Windows credentials (<code class="language-plaintext highlighter-rouge">LSASS dumps</code>) remotely without touching disk, minimizing detection.</p><p><code class="language-plaintext highlighter-rouge">LSASS</code> is a process containing the last logged on users (<code class="language-plaintext highlighter-rouge">local</code> or <code class="language-plaintext highlighter-rouge">domain</code>). It checks <code class="language-plaintext highlighter-rouge">user logging in</code>, handles <code class="language-plaintext highlighter-rouge">password change</code> and create <code class="language-plaintext highlighter-rouge">access token</code>.</p><blockquote class="prompt-tip"><div><p>The use of <code class="language-plaintext highlighter-rouge">credential guard</code> allows to isolate the process to protect it. For additional protection you can check <a href="https://learn.microsoft.com/en-us/windows-server/security/credentials-protection-and-management/configuring-additional-lsa-protection">this post</a> of Microsoft.</p></div></blockquote><p><code class="language-plaintext highlighter-rouge">Lsassy</code> will recover passwords remotely thanks to either <code class="language-plaintext highlighter-rouge">ProcDump</code> (Microsoft tool of the <a href="https://learn.microsoft.com/en-us/sysinternals/">Sysinternals suite</a>), or via the <code class="language-plaintext highlighter-rouge">DLL</code> of Windows <strong>comsvcs.dll</strong> that allows to dump process, but only if you are <code class="language-plaintext highlighter-rouge">SYSTEM</code>.</p><p>This tool was developed by pixis so you can check his blog on <a href="https://en.hackndo.com/remote-lsass-dump-passwords">hackndo</a> if you want more information about the tool.</p><h2 id="default-use-case-4"><span class="mr-2">Default Use Case</span><a href="#default-use-case-4" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>You can run <code class="language-plaintext highlighter-rouge">lsassy</code> when you have an admin user on a server:</p><p><code class="language-plaintext highlighter-rouge">lsassy -d $DOMAIN -u $USER -p $PASSWORD $SERVER_IP</code></p><p>or using <code class="language-plaintext highlighter-rouge">nxc</code> / <code class="language-plaintext highlighter-rouge">cme</code>:</p><p><code class="language-plaintext highlighter-rouge">nxc smb $SERVER_IP -d $DOMAIN -u $USER -p $PASSWORD -M lsassy</code></p><p><img data-src="https://raw.githubusercontent.com/Nouman404/nouman404.github.io/main/_posts/Notes/photos/Tools_Lsassy.png" alt="[Tools_Lsassy.png]" data-proofer-ignore></p><h2 id="more-options-4"><span class="mr-2">More options</span><a href="#more-options-4" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p><code class="language-plaintext highlighter-rouge">-m</code> allows you to specify the dumping method like <code class="language-plaintext highlighter-rouge">dumpertdll</code> and many others. You’ll need to specify the path of the module (<code class="language-plaintext highlighter-rouge">dll</code> or binary) you are using with <code class="language-plaintext highlighter-rouge">-O dumpertdll_path=$PATH_OF_THE_DLL</code> to evade AV. You can find the code to compiler on the <a href="https://github.com/outflanknl/Dumpert">dumpert</a> GitHub repository.</p><h1 id="secretsdump">Secretsdump</h1><h2 id="definition-5"><span class="mr-2">Definition</span><a href="#definition-5" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p><code class="language-plaintext highlighter-rouge">Secretsdump</code> is a tool to extract sensitive information like password hashes from remote systems without executing code on the target machine.</p><blockquote class="prompt-warning"><div><p>You will need admin rights to be able to run this script successfully</p></div></blockquote><ul><li>It dumps <code class="language-plaintext highlighter-rouge">SAM</code> and <code class="language-plaintext highlighter-rouge">LSA</code> (<code class="language-plaintext highlighter-rouge">SECURITY</code>) from Registery and save the result in <code class="language-plaintext highlighter-rouge">temp</code> directory.<li>It also dumps <code class="language-plaintext highlighter-rouge">NTDS</code> (only on <code class="language-plaintext highlighter-rouge">DC</code>). It gets the list of domain users, their hashs and Kerberos keys via <code class="language-plaintext highlighter-rouge">[MS-DRDS] DRSGetNCChanges()</code> or via <code class="language-plaintext highlighter-rouge">vssadmin</code><li>After dumping everything, it cleans his traces by removing any created files.</ul><h2 id="default-use-case-5"><span class="mr-2">Default Use Case</span><a href="#default-use-case-5" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>You can run <code class="language-plaintext highlighter-rouge">Secretsdump</code> with only a user and a password (or hash):</p><p><code class="language-plaintext highlighter-rouge">secretsdump $DOMAIN$/$USER:$PASSWORD@$SERVER_IP</code></p><p><img data-src="https://raw.githubusercontent.com/Nouman404/nouman404.github.io/main/_posts/Notes/photos/Tools_Secretsdump.png" alt="[Tools_Secretsdump.png]" data-proofer-ignore></p><h2 id="more-options-5"><span class="mr-2">More options</span><a href="#more-options-5" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p><code class="language-plaintext highlighter-rouge">-hashes</code> you may want to use this flag if you don’t have the password of the admin and use its hash instead.</p><h1 id="testsslsh">testssl.sh</h1><h2 id="definition-6"><span class="mr-2">Definition</span><a href="#definition-6" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p><code class="language-plaintext highlighter-rouge">testssl.sh</code> is a tool that checks SSL/TLS configurations on servers to detect vulnerabilities or misconfigurations related to encryption and security protocols.</p><ol><li>First <code class="language-plaintext highlighter-rouge">testssl.sh</code> does a <code class="language-plaintext highlighter-rouge">DNS</code> lookup to find possibly multiple IP addresses. After that, it does a <code class="language-plaintext highlighter-rouge">reverse DNS</code> lookup to find the corresponding domain from the IPs. Then, it will check that the found targets have indeed <code class="language-plaintext highlighter-rouge">SSL/TLS</code> on port <code class="language-plaintext highlighter-rouge">443</code> unless another one is pecified<li>It will check the <code class="language-plaintext highlighter-rouge">SSL/TLS</code> protocols. The service should not provide deprecated protocols like <code class="language-plaintext highlighter-rouge">SSLv2</code>, <code class="language-plaintext highlighter-rouge">SSLv3</code>, <code class="language-plaintext highlighter-rouge">TLS 1</code> or <code class="language-plaintext highlighter-rouge">TLS 1.1</code>. Only <code class="language-plaintext highlighter-rouge">TLS 2</code> or <code class="language-plaintext highlighter-rouge">TLS 3</code> should be offered<li>Then it will check if any outdated ciphers, such as <code class="language-plaintext highlighter-rouge">RC4</code>, <code class="language-plaintext highlighter-rouge">DES</code> or <code class="language-plaintext highlighter-rouge">3DES</code> are used and show stronger ciphers like <code class="language-plaintext highlighter-rouge">AES</code> or <code class="language-plaintext highlighter-rouge">AEAD</code> cipher.<li>It will also check the <code class="language-plaintext highlighter-rouge">Perfect Forward Secrecy</code> (PFS). If this is not supported, this mean that if an attacker can find the private key of the server, then it will be able to decode every communications. But if <code class="language-plaintext highlighter-rouge">PFS</code> is supported and the private key is found, this means that only the new messages can be read. Ciphers like <code class="language-plaintext highlighter-rouge">DHE</code> (Diffie-Hellman Ephemeral) or <code class="language-plaintext highlighter-rouge">ECDHE</code> (Elliptic Curve Diffie-Hellman Ephemeral) should be used.<li>Checks if the server has a server-side cipher preferences enable. This allows to not allow communicate with deprecated cipher mechanism hence allowing only secure communications.<li>The <code class="language-plaintext highlighter-rouge">server default</code> section provide a lot of information about the certificate(s) like the <code class="language-plaintext highlighter-rouge">issuer</code>, <code class="language-plaintext highlighter-rouge">validity</code>, <code class="language-plaintext highlighter-rouge">expiration</code>… It will also check that the server use secure <code class="language-plaintext highlighter-rouge">session managment</code> (session ID or session tickets).<li>Then it will check the <code class="language-plaintext highlighter-rouge">HTTP headers</code>. This includes headers like <code class="language-plaintext highlighter-rouge">Strict-Transport-Security</code> (HSTS) <code class="language-plaintext highlighter-rouge">X-Frame-Options</code> and <code class="language-plaintext highlighter-rouge">Content-Security-Policy</code> (CSP), which help secure web applications against common attacks like <code class="language-plaintext highlighter-rouge">XSS</code>, <code class="language-plaintext highlighter-rouge">clickjacking</code> and <code class="language-plaintext highlighter-rouge">man-in-the-middle</code> attacks.<li>Now it will check for <code class="language-plaintext highlighter-rouge">SSL/TLS</code> vulnerabilities like <code class="language-plaintext highlighter-rouge">Heartbleed</code>, <code class="language-plaintext highlighter-rouge">POODLE</code>, <code class="language-plaintext highlighter-rouge">BEAST</code>, <code class="language-plaintext highlighter-rouge">DROWN</code>, <code class="language-plaintext highlighter-rouge">ROBOT</code>, <code class="language-plaintext highlighter-rouge">Logjam</code>.<li>After that, <code class="language-plaintext highlighter-rouge">testssl.sh</code> will check, based on a list of 370 pre-configured cipher, that the server supports strong and non-obsolete ones.<li>The last step will do a client simulation that mimic how different clients (web browsers, mobile devices, different OS…) react with the server. This allows to check that the server is not vulnerable to <code class="language-plaintext highlighter-rouge">downgrade</code> attacks.<li>Finally, <code class="language-plaintext highlighter-rouge">testssl.sh</code> will provide a grade to allow us to have a global idea of the certificate security level.</ol><h2 id="certificate"><span class="mr-2">Certificate</span><a href="#certificate" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>To have a better understanding of what does <code class="language-plaintext highlighter-rouge">testssl.sh</code>, I’ll just explain a bit what’s in a certificate also known as <code class="language-plaintext highlighter-rouge">X.509 certificate</code>.</p><ul><li>The first part of the certificate when we open it is about the subject information. <code class="language-plaintext highlighter-rouge">Common name</code> of the website that the certificate is intended to protect (<code class="language-plaintext highlighter-rouge">exemple.com</code> or <code class="language-plaintext highlighter-rouge">*.exemple.com</code>)<li>Then we have information about the issuer (ex: Common name of the issuer)<li>We then encounter information about the certificate’s <code class="language-plaintext highlighter-rouge">serial number</code> (unique positive integer to identify the certificate), the <code class="language-plaintext highlighter-rouge">X.509</code> version (ex: 3), the signature algorithm (ex: <code class="language-plaintext highlighter-rouge">SHA-256 with RSA</code>) and the <code class="language-plaintext highlighter-rouge">validity period</code>.<li>The <code class="language-plaintext highlighter-rouge">public key</code> is part of a <strong>key pair</strong> that also includes a <code class="language-plaintext highlighter-rouge">private key</code>. The <code class="language-plaintext highlighter-rouge">public key</code> allows the client (our browser) to encrypt the communication with the server. The <code class="language-plaintext highlighter-rouge">private key</code> is kept by the server to sign documents. or decrypt data.</ul><blockquote class="prompt-info"><div><p>Signed documents with the <code class="language-plaintext highlighter-rouge">private key</code> can be verified by anyone who has the <code class="language-plaintext highlighter-rouge">public key</code>.</p></div></blockquote><ul><li>The <code class="language-plaintext highlighter-rouge">digital signature</code> ensure <code class="language-plaintext highlighter-rouge">authenticity</code> (signature only generated by the <code class="language-plaintext highlighter-rouge">Certificate Authority</code>) and <code class="language-plaintext highlighter-rouge">integrity</code> (if the certificate is tempered, then the digital signature won’t match). The <code class="language-plaintext highlighter-rouge">digital signature</code> of an X.509 certificate is calculated by first creating a hash of the certificate’s data using a cryptographic hash function (like <code class="language-plaintext highlighter-rouge">SHA-256</code>). This hash is then encrypted with the <code class="language-plaintext highlighter-rouge">private key</code> of the certificate issuer (the <code class="language-plaintext highlighter-rouge">Certificate Authority</code>) to generate the signature, which can be verified by others using the issuer’s public key.<li>We can have <code class="language-plaintext highlighter-rouge">exensions</code> that allows the owner of the certificate to have multiple domains bound to the same certificate.</ul><blockquote class="prompt-info"><div><p>Your browser may calculate a <code class="language-plaintext highlighter-rouge">fingerprint</code> of the certificate to check its authenticity.</p></div></blockquote><p>The <code class="language-plaintext highlighter-rouge">chain of trust</code> as its name state is a trust between multiple certificates. A <code class="language-plaintext highlighter-rouge">Root CA</code> at the top, which issues certificates to <code class="language-plaintext highlighter-rouge">Intermediate CAs</code>, and these <code class="language-plaintext highlighter-rouge">Intermediate CAs</code> in turn issue certificates to end entities, forming a hierarchical structure that establishes trust through verification of each certificate’s authenticity and validity up to the <code class="language-plaintext highlighter-rouge">Root CA</code>. We may have the following diagram:</p><p><img data-src="https://raw.githubusercontent.com/Nouman404/nouman404.github.io/main/_posts/Notes/photos/Tools_testssl.png" alt="[Tools_testssl.png]" data-proofer-ignore></p><blockquote class="prompt-info"><div><p>The use of intermediate certificates allow better security. This allows <code class="language-plaintext highlighter-rouge">root CA</code> not to be exposed and so, to protect their private key by exposing <code class="language-plaintext highlighter-rouge">intermediate CA</code>. If an <code class="language-plaintext highlighter-rouge">intermediate CA</code> is compromised then it can just be revoked.</p></div></blockquote><h2 id="default-use-case-6"><span class="mr-2">Default Use Case</span><a href="#default-use-case-6" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>You can use <code class="language-plaintext highlighter-rouge">testssl.sh</code> without specifying any flag and it will give you information about the certificate and possible vulnerabilities. You can use it like this:</p><p><code class="language-plaintext highlighter-rouge">testssl.sh $TARGET</code></p><h2 id="more-options-6"><span class="mr-2">More options</span><a href="#more-options-6" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p><code class="language-plaintext highlighter-rouge">--file &lt;fname&gt;</code> or the equivalent <code class="language-plaintext highlighter-rouge">-iL &lt;fname&gt;</code> are mass testing options. Allows to to test multiple domains.</p><p><code class="language-plaintext highlighter-rouge">--basicauth &lt;user:pass&gt;</code> This can be set to provide HTTP basic authentication credentials which are used during checks for security headers. <code class="language-plaintext highlighter-rouge">BASICAUTH</code> is the <code class="language-plaintext highlighter-rouge">ENV</code> variable you can use instead.</p><p><code class="language-plaintext highlighter-rouge">--ip &lt;ip&gt;</code> tests either the supplied <code class="language-plaintext highlighter-rouge">IPv4</code> or <code class="language-plaintext highlighter-rouge">IPv6</code> address instead of resolving host(s) in <code class="language-plaintext highlighter-rouge">&lt;URI&gt;</code>. <code class="language-plaintext highlighter-rouge">IPv6</code> addresses need to be supplied in square brackets. <code class="language-plaintext highlighter-rouge">--ip=one</code> means: just test the first A record <code class="language-plaintext highlighter-rouge">DNS</code> returns (useful for multiple IPs). If <code class="language-plaintext highlighter-rouge">-6</code> and <code class="language-plaintext highlighter-rouge">--ip=one</code> was supplied an <code class="language-plaintext highlighter-rouge">AAAA</code> record will be picked if available. The <code class="language-plaintext highlighter-rouge">--ip</code> option might be also useful if you want to resolve the supplied hostname to a different IP, similar as if you would edit <code class="language-plaintext highlighter-rouge">/etc/hosts</code> or <code class="language-plaintext highlighter-rouge">/c/Windows/System32/drivers/etc/hosts</code>. <code class="language-plaintext highlighter-rouge">--ip=proxy</code> tries a <code class="language-plaintext highlighter-rouge">DNS</code> resolution via proxy.</p><p><code class="language-plaintext highlighter-rouge">--wide</code> mode expands the cipher suite testing to include a larger and more exhaustive set of cipher suites.</p><h1 id="donpapi">DonPAPI</h1><h2 id="definition-7"><span class="mr-2">Definition</span><a href="#definition-7" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p><code class="language-plaintext highlighter-rouge">DonPAPI</code> is a post-exploitation tool used to extract credentials and sensitive data from Windows machines by targeting the <code class="language-plaintext highlighter-rouge">Data Protection API</code> (<code class="language-plaintext highlighter-rouge">DPAPI</code>). <code class="language-plaintext highlighter-rouge">DPAPI</code> allows the management of symmetric encryption of the secrets in a Windows environment. What we need to understand is that the process of storing secrets generate multiple files. It creates a <code class="language-plaintext highlighter-rouge">blob</code> in <code class="language-plaintext highlighter-rouge">C:\Users\$USERNAME\AppData\Roaming\Microsoft\Credentials</code> that contains raw bytes and the <code class="language-plaintext highlighter-rouge">GUID</code> of the <code class="language-plaintext highlighter-rouge">master key file</code> (located in <code class="language-plaintext highlighter-rouge">C:\Users\$USERNAME\AppData\Roaming\Microsoft\Protect\$USER_SID</code>). With those two files and the password of <code class="language-plaintext highlighter-rouge">$USERNAME</code> we can recover any “protected” password that used <code class="language-plaintext highlighter-rouge">DPAPI</code></p><blockquote class="prompt-tip"><div><p>You can recover also <code class="language-plaintext highlighter-rouge">DPAPI</code> credentials from other users if you are a local or a domain administrator.</p></div></blockquote><blockquote class="prompt-tip"><div><p>You can provide the <code class="language-plaintext highlighter-rouge">Net-NTLM</code> hash instead of the password if you only have that.</p></div></blockquote><blockquote class="prompt-info"><div><p><a href="http://lestutosdeprocessus.fr/dechiffrement-dpapi.html">Here</a> is a French explanation on how does <code class="language-plaintext highlighter-rouge">DPAPI</code> works and <a href="https://learn.microsoft.com/en-us/previous-versions/ms995355(v%3Dmsdn.10)?WT.mc_id=SEC-MVP-5005061">here</a> is the English one ;)</p></div></blockquote><h2 id="default-use-case-7"><span class="mr-2">Default Use Case</span><a href="#default-use-case-7" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>By default, <code class="language-plaintext highlighter-rouge">donPAPI</code>will collect the following credentials:</p><ul><li><p><code class="language-plaintext highlighter-rouge">Chromium</code>: Chromium browser Credentials, Cookies and Chrome Refresh Token</p><li><p><code class="language-plaintext highlighter-rouge">Certificates</code>: Windows Certificates</p><li><p><code class="language-plaintext highlighter-rouge">CredMan</code>: Credential Manager</p><li><p><code class="language-plaintext highlighter-rouge">Firefox</code>: Firefox browser Credentials and Cookies</p><li><p><code class="language-plaintext highlighter-rouge">MobaXterm</code>: Mobaxterm Credentials</p><li><p><code class="language-plaintext highlighter-rouge">MRemoteNg</code>: MRemoteNg Credentials</p><li><p><code class="language-plaintext highlighter-rouge">RDCMan</code>: RDC Manager Credentials</p><li><p><code class="language-plaintext highlighter-rouge">Files</code>: Files on Desktop and and Recent folder</p><li><p><code class="language-plaintext highlighter-rouge">SCCM</code>: SCCM Credentials</p><li><p><code class="language-plaintext highlighter-rouge">Vaults</code>: Vaults Credentials</p><li><p><code class="language-plaintext highlighter-rouge">VNC</code>: VNC Credentials</p><li><p><code class="language-plaintext highlighter-rouge">Wifi</code>: Wifi Credentials</p></ul><p>You can use it with only the username and his password:</p><p><code class="language-plaintext highlighter-rouge">DonPAPI collect -d $DOMAIN -u $USER -p $PASSWORD -t $TARGET_IP</code></p><h2 id="more-options-7"><span class="mr-2">More options</span><a href="#more-options-7" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p><code class="language-plaintext highlighter-rouge">donpapi gui</code>: allows to see the found credentials in a web GUI.</p><blockquote class="prompt-tip"><div><p>You can use the <code class="language-plaintext highlighter-rouge">--basic-auth $USER:$PASSWORD</code> with the <code class="language-plaintext highlighter-rouge">gui</code> option so that not everyone has access to it.</p></div></blockquote><p><code class="language-plaintext highlighter-rouge">-H LMHASH:NTHASH</code> allows you to provide hashes instead of passwords</p></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw mr-1"></i> <a href='/categories/notes/'>Notes</a>, <a href='/categories/ad/'>AD</a></div><div class="post-tags"> <i class="fa fa-tags fa-fw mr-1"></i> <a href="/tags/ad/" class="post-tag no-text-decoration" >AD</a> <a href="/tags/nmap/" class="post-tag no-text-decoration" >Nmap</a> <a href="/tags/gobuster/" class="post-tag no-text-decoration" >Gobuster</a> <a href="/tags/certipy/" class="post-tag no-text-decoration" >Certipy</a> <a href="/tags/ntlmralyx/" class="post-tag no-text-decoration" >Ntlmralyx</a></div><div class="post-tail-bottom d-flex justify-content-between align-items-center mt-3 pt-5 pb-2"><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/"> CC BY 4.0 </a> by the author.</div><div class="share-wrapper"> <span class="share-label text-muted mr-1">Share</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=Notes+%7C+AD+%7C+AD+Tools+-+BatBato%27s+Blog&url=nouman404.github.io%2FNotes%2FAD%2FTools" data-toggle="tooltip" data-placement="top" title="Twitter" target="_blank" rel="noopener" aria-label="Twitter"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=Notes+%7C+AD+%7C+AD+Tools+-+BatBato%27s+Blog&u=nouman404.github.io%2FNotes%2FAD%2FTools" data-toggle="tooltip" data-placement="top" title="Facebook" target="_blank" rel="noopener" aria-label="Facebook"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://t.me/share/url?url=nouman404.github.io%2FNotes%2FAD%2FTools&text=Notes+%7C+AD+%7C+AD+Tools+-+BatBato%27s+Blog" data-toggle="tooltip" data-placement="top" title="Telegram" target="_blank" rel="noopener" aria-label="Telegram"> <i class="fa-fw fab fa-telegram"></i> </a> <i id="copy-link" class="fa-fw fas fa-link small" data-toggle="tooltip" data-placement="top" title="Copy link" data-title-succeed="Link copied successfully!"> </i> </span></div></div></div></div></div><div id="panel-wrapper" class="col-xl-3 pl-2 text-muted"><div class="access"><div id="access-lastmod" class="post"><div class="panel-heading">Recently Updated</div><ul class="post-content pl-0 pb-1 ml-1 mt-2"><li><a href="/Notes/AD/AD_Basics">Notes | AD | AD Basics</a><li><a href="/Notes/AD/Tools">Notes | AD | AD Tools</a><li><a href="/CTFs/HeroCTF_2024/Steganographie/Zipper">CTFs | HeroCTF_2024 | Steganographie | Zipper</a><li><a href="/CTFs/HeroCTF_2024/Forensique/LazySysAdmin2">CTFs | HeroCTF_2024 | Forensique | LazySysAdmin2</a><li><a href="/CTFs/HeroCTF_2024/Forensique/Tenant_trouble">CTFs | HeroCTF_2024 | Forensique | Tenant trouble</a></ul></div><div id="access-tags"><div class="panel-heading">Trending Tags</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/ctf/">CTF</a> <a class="post-tag" href="/tags/web/">Web</a> <a class="post-tag" href="/tags/forensique/">Forensique</a> <a class="post-tag" href="/tags/404ctf/">404CTF</a> <a class="post-tag" href="/tags/stegano/">Stegano</a> <a class="post-tag" href="/tags/fcsc/">FCSC</a> <a class="post-tag" href="/tags/forensic/">Forensic</a> <a class="post-tag" href="/tags/osint/">OSINT</a> <a class="post-tag" href="/tags/stega/">Stega</a> <a class="post-tag" href="/tags/reverse/">Reverse</a></div></div></div><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.js"></script><div id="toc-wrapper" class="pl-0 pr-4 mb-5"><div class="panel-heading pl-3 pt-2 mb-2">Contents</div><nav id="toc" data-toggle="toc"></nav></div></div></div><div class="row"><div id="tail-wrapper" class="col-12 col-lg-11 col-xl-9 pl-3 pr-3 pr-xl-4"><div id="related-posts" class="mt-5 mb-2 mb-sm-4"><h3 class="pt-2 mt-1 mb-4 ml-1" data-toc-skip>Further Reading</h3><div class="card-deck mb-4"><div class="card"> <a href="/Notes/AD/AD_Basics"><div class="card-body"> <em class="small" data-ts="1712527200" data-df="ll" > Apr 8, 2024 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Notes | AD | AD Basics</h3><div class="text-muted small"><p> Active Directory Introduction Well, well well… Here we are. Doing an Active Directory introduction note. Lets start by defining what is Active directory. Active Directory (AD), is the windows dir...</p></div></div></a></div><div class="card"> <a href="/Notes/Footprinting/Port_Enumeration"><div class="card-body"> <em class="small" data-ts="1661810400" data-df="ll" > Aug 30, 2022 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Notes | Port Enumeration</h3><div class="text-muted small"><p> Port Enumeration Capture The Flag (CTF) are challenges that allows us to train ourseves on different tools and techniques. The first step will usually be a port scanning. But in a real world envir...</p></div></div></a></div><div class="card"> <a href="/Notes/Linux/Linux_Fondamentals"><div class="card-body"> <em class="small" data-ts="1661292000" data-df="ll" > Aug 24, 2022 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Notes | Linux Fondamentals</h3><div class="text-muted small"><p> Linux Fondamentals First of all, why learn Linux? Well, when it comes to computing, Linux is a very useful operating system. It has many useful tools and offers high performance on different netwo...</p></div></div></a></div></div></div><div class="post-navigation d-flex justify-content-between"> <a href="/CTFs/HeroCTF_2024/Steganographie/Zipper" class="btn btn-outline-primary" prompt="Older"><p>CTFs | HeroCTF_2024 | Steganographie | Zipper</p></a><div class="btn btn-outline-primary disabled" prompt="Newer"><p>-</p></div></div></div></div><footer class="row pl-3 pr-3"><div class="col-12 d-flex justify-content-between align-items-center text-muted pl-0 pr-0"><div class="footer-left"><p class="mb-0"> © 2025 <a href="https://github.com/Nouman404/">Bat</a>. <span data-toggle="tooltip" data-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author.">Some rights reserved.</span></p></div><div class="footer-right"><p class="mb-0"> Powered by <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a> with <a href="https://github.com/cotes2020/jekyll-theme-chirpy" target="_blank" rel="noopener">Chirpy</a> theme.</p></div></div></footer></div><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-12 col-sm-11 post-content"><div id="search-hints"><div id="access-tags"><div class="panel-heading">Trending Tags</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/ctf/">CTF</a> <a class="post-tag" href="/tags/web/">Web</a> <a class="post-tag" href="/tags/forensique/">Forensique</a> <a class="post-tag" href="/tags/404ctf/">404CTF</a> <a class="post-tag" href="/tags/stegano/">Stegano</a> <a class="post-tag" href="/tags/fcsc/">FCSC</a> <a class="post-tag" href="/tags/forensic/">Forensic</a> <a class="post-tag" href="/tags/osint/">OSINT</a> <a class="post-tag" href="/tags/stega/">Stega</a> <a class="post-tag" href="/tags/reverse/">Reverse</a></div></div></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><div id="mask"></div><a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a><div id="notification" class="toast" role="alert" aria-live="assertive" aria-atomic="true" data-animation="true" data-autohide="false"><div class="toast-header"> <button type="button" class="ml-2 ml-auto close" data-dismiss="toast" aria-label="Close"> <span aria-hidden="true">&times;</span> </button></div><div class="toast-body text-center pt-0"><p class="pl-2 pr-2 mb-3">A new version of content is available.</p><button type="button" class="btn btn-primary" aria-label="Update"> Update </button></div></div><script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.10.0/dest/simple-jekyll-search.min.js"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5">Oops! No result founds.</p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); </script> <script src="https://cdn.jsdelivr.net/combine/npm/magnific-popup@1/dist/jquery.magnific-popup.min.js,npm/lozad/dist/lozad.min.js,npm/clipboard@2/dist/clipboard.min.js"></script> <script src="https://cdn.jsdelivr.net/combine/npm/dayjs@1/dayjs.min.js,npm/dayjs@1/locale/en.min.js,npm/dayjs@1/plugin/relativeTime.min.js,npm/dayjs@1/plugin/localizedFormat.min.js"></script> <script defer src="/assets/js/dist/post.min.js"></script> <script src="https://cdn.jsdelivr.net/npm/bootstrap@4/dist/js/bootstrap.bundle.min.js"></script> <script defer src="/app.js"></script>
