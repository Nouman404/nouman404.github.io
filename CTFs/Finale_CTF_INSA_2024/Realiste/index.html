<!DOCTYPE html><html lang="en" data-mode="dark" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="generator" content="Jekyll v4.4.1" /><meta property="og:title" content="CTFs Finale_CTF_INSA_2024 Realiste" /><meta name="author" content="BatBato" /><meta property="og:locale" content="en" /><meta name="description" content="Réaliste" /><meta property="og:description" content="Réaliste" /><link rel="canonical" href="nouman404.github.io/CTFs/Finale_CTF_INSA_2024/Realiste/" /><meta property="og:url" content="nouman404.github.io/CTFs/Finale_CTF_INSA_2024/Realiste/" /><meta property="og:site_name" content="BatBato’s Blog" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2024-04-04T00:00:00+02:00" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="CTFs Finale_CTF_INSA_2024 Realiste" /><meta name="twitter:site" content="@twitter_username" /><meta name="twitter:creator" content="@BatBato" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"BlogPosting","author":{"@type":"Person","name":"BatBato"},"dateModified":"2024-04-22T23:28:42+02:00","datePublished":"2024-04-04T00:00:00+02:00","description":"Réaliste","headline":"CTFs Finale_CTF_INSA_2024 Realiste","mainEntityOfPage":{"@type":"WebPage","@id":"nouman404.github.io/CTFs/Finale_CTF_INSA_2024/Realiste/"},"url":"nouman404.github.io/CTFs/Finale_CTF_INSA_2024/Realiste/"}</script><title>CTFs | Finale_CTF_INSA_2024 | Realiste | BatBato's Blog</title><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/site.webmanifest"><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico"><meta name="apple-mobile-web-app-title" content="BatBato's Blog"><meta name="application-name" content="BatBato's Blog"><meta name="msapplication-TileColor" content="#da532c"><meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin><link rel="dns-prefetch" href="https://fonts.gstatic.com" crossorigin><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://cdn.jsdelivr.net" ><link rel="dns-prefetch" href="https://cdn.jsdelivr.net" ><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Lato&family=Source+Sans+Pro:wght@400;600;700;900&display=swap"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4/dist/css/bootstrap.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css"><link rel="stylesheet" href="/assets/css/style.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/magnific-popup@1/dist/magnific-popup.min.css"> <script src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script><body data-spy="scroll" data-target="#toc" data-topbar-visible="true"><div id="sidebar" class="d-flex flex-column align-items-end"><div class="profile-wrapper text-center"><div id="avatar"> <a href="/" class="mx-auto"> <img src="/assets/img/icon.jpg" alt="avatar" onerror="this.style.display='none'"> </a></div><div class="site-title mt-3"> <a href="/">BatBato's Blog</a></div><div class="site-subtitle font-italic">BatBato was here :)</div></div><ul class="w-100"><li class="nav-item"> <a href="/" class="nav-link"> <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i> <span>HOME</span> </a><li class="nav-item"> <a href="/categories/" class="nav-link"> <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i> <span>CATEGORIES</span> </a><li class="nav-item"> <a href="/notes/" class="nav-link"> <i class="fa-fw fas fa-sticky-note ml-xl-3 mr-xl-3 unloaded"></i> <span>NOTES</span> </a><li class="nav-item"> <a href="/sources/" class="nav-link"> <i class="fa-fw fas fa-folder-open ml-xl-3 mr-xl-3 unloaded"></i> <span>SOURCES</span> </a><li class="nav-item"> <a href="/about/" class="nav-link"> <i class="fa-fw fas fa-info-circle ml-xl-3 mr-xl-3 unloaded"></i> <span>ABOUT</span> </a><li class="nav-item"> <a href="/archives/" class="nav-link"> <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i> <span>ARCHIVES</span> </a></ul><div class="sidebar-bottom mt-auto d-flex flex-wrap justify-content-center align-items-center"> <a href="https://github.com/Nouman404" aria-label="github" target="_blank" rel="noopener"> <i class="fab fa-github"></i> </a> <a href="https://app.hackthebox.com/profile/235762" aria-label="hackthebox" target="_blank" rel="noopener"> <i class="fas fa-cube"></i> </a> <a href="https://tryhackme.com/p/Batbato" aria-label="tryhackme" target="_blank" rel="noopener"> <i class="fas fa-cloud"></i> </a> <a href="https://www.root-me.org/BatBato" aria-label="rootme" target="_blank" rel="noopener"> <i class="fas fa-skull"></i> </a></div></div><div id="topbar-wrapper"><div id="topbar" class="container d-flex align-items-center justify-content-between h-100 pl-3 pr-3 pl-md-4 pr-md-4"> <span id="breadcrumb"> <span> <a href="/"> Home </a> </span> <span>CTFs | Finale_CTF_INSA_2024 | Realiste</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> Post</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" autocomplete="off" placeholder="Search..."> </span> <span id="search-cancel" >Cancel</span></div></div><div id="main-wrapper" class="d-flex justify-content-center"><div id="main" class="container pl-xl-4 pr-xl-4"><div class="row"><div id="core-wrapper" class="col-12 col-lg-11 col-xl-9 pr-xl-4"><div class="post pl-1 pr-1 pl-md-2 pr-md-2"><h1 data-toc-skip>CTFs | Finale_CTF_INSA_2024 | Realiste</h1><div class="post-meta text-muted"> <span> Posted <em class="" data-ts="1712181600" data-df="ll" data-toggle="tooltip" data-placement="bottom"> Apr 4, 2024 </em> </span> <span> Updated <em class="" data-ts="1713821322" data-df="ll" data-toggle="tooltip" data-placement="bottom"> Apr 22, 2024 </em> </span><div class="d-flex justify-content-between"> <span> By <em> Bat </em> </span><div> <span class="readtime" data-toggle="tooltip" data-placement="bottom" title="1565 words"> <em>8 min</em> read</span></div></div></div><div class="post-content"><h1 id="réaliste">Réaliste</h1><h2 id="kerb1"><span class="mr-2">Kerb1</span><a href="#kerb1" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>For this challenge, we are going to use the well known <code class="language-plaintext highlighter-rouge">AS-REPRoasting</code> attack. I will not explain in detail how the attack work but you can have more information <a href="https://nouman404.github.io/Notes/AD/AD_Basics#as-reproasting">here</a>. The main idea is that some user may have the preauthentication disabled allowing to request a TGT (Ticket Granting Ticket) as this user. This allows us to crack the password of this user offline.</p><h3 id="enumeration"><span class="mr-2">Enumeration</span><a href="#enumeration" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>First we need to check if there is any AS-REPRoastable account. We have two ways to do it. The first one (the prettier) is by using <a href="https://www.kali.org/tools/bloodhound.py/">bloodhound-python</a>. This tool will allow us to recover all information on the domain. You will need a user of the domain to do so (we have bob):</p><p><img data-src="https://raw.githubusercontent.com/Nouman404/nouman404.github.io/main/_posts/CTFs/CTF_INSA_Final/photos/realiste_kerb1_bloodhound_zip.png" alt="[realiste_kerb1_bloodhound_zip.png]" data-proofer-ignore></p><blockquote><p>Here is the command to run bloodhound: <code class="language-plaintext highlighter-rouge">bloodhound-python -u bob -p bobby -d ctf.local -ns 172.10.0.59 --zip -c All</code></p></blockquote><p>Now that we generated a zip file containing all the data of the domain we can run the <a href="https://github.com/BloodHoundAD/BloodHound">bloodhound GUI</a> to get a beautiful graph of the data we collected:</p><p><img data-src="https://raw.githubusercontent.com/Nouman404/nouman404.github.io/main/_posts/CTFs/CTF_INSA_Final/photos/realiste_kerb1_bob.png" alt="[realiste_kerb1_bob.png]" data-proofer-ignore></p><blockquote class="prompt-tip"><div><p><a href="https://bloodhound.readthedocs.io/en/latest/installation/linux.html">Here</a> are the steps to configure the bloodhound GUI. You need to install and configure Neo4j.</p></div></blockquote><p>As we can see, there is two domain admin in the domain <code class="language-plaintext highlighter-rouge">ctf.local</code>. We can use the panel of bloodhound to get information about possible AS-REPRoastable account:</p><p><img data-src="https://raw.githubusercontent.com/Nouman404/nouman404.github.io/main/_posts/CTFs/CTF_INSA_Final/photos/realiste_kerb1_asrepOpt.png" alt="[realiste_kerb1_asrepOpt.png]" data-proofer-ignore></p><p>We only have one user that looks AS-REPRoastable account and it is <code class="language-plaintext highlighter-rouge">bob-admin</code>:</p><p><img data-src="https://raw.githubusercontent.com/Nouman404/nouman404.github.io/main/_posts/CTFs/CTF_INSA_Final/photos/realiste_kerb1_asrepAcc.png" alt="[realiste_kerb1_asrepAcc.png]" data-proofer-ignore></p><h3 id="as-reproasting"><span class="mr-2">AS-REPRoasting</span><a href="#as-reproasting" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>The other method to get this information is by using the <a href="https://www.kali.org/tools/impacket/">Impacket</a> list of tools. We can use <code class="language-plaintext highlighter-rouge">GetNPUsers.py</code> to list all the user having the preauthentication disabled:</p><p><img data-src="https://raw.githubusercontent.com/Nouman404/nouman404.github.io/main/_posts/CTFs/CTF_INSA_Final/photos/realiste_kerb1_getNP.png" alt="[realiste_kerb1_getNP.png]" data-proofer-ignore></p><blockquote class="prompt-tip"><div><p>Don’t forget to add <code class="language-plaintext highlighter-rouge">ctf.local</code> into your <code class="language-plaintext highlighter-rouge">/etc/hosts</code> file with the correct IP.</p></div></blockquote><p>We now run the command with some more parameter to request the TGT:</p><p><img data-src="https://raw.githubusercontent.com/Nouman404/nouman404.github.io/main/_posts/CTFs/CTF_INSA_Final/photos/realiste_kerb1_getTGT.png" alt="[realiste_kerb1_getTGT.png]" data-proofer-ignore></p><blockquote class="prompt-info"><div><p>Here is the command to run: <code class="language-plaintext highlighter-rouge">GetNPUsers.py -request -format hashcat -outputfile ASREProastables.txt -dc-ip 172.10.0.58 ctf.local/bob:bobby</code></p></div></blockquote><h3 id="cracking"><span class="mr-2">Cracking</span><a href="#cracking" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>Now that we have the TGT, we can try to crack it offline using tools like Hashcat:</p><p><img data-src="https://raw.githubusercontent.com/Nouman404/nouman404.github.io/main/_posts/CTFs/CTF_INSA_Final/photos/realiste_kerb1_hashcat.png" alt="[realiste_kerb1_hashcat.png]" data-proofer-ignore></p><blockquote class="prompt-tip"><div><p>Here you have to use the <code class="language-plaintext highlighter-rouge">-m 18200</code> flag in hashcat</p></div></blockquote><h3 id="get-a-shell-dude"><span class="mr-2">Get a shell dude</span><a href="#get-a-shell-dude" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>Now that we have the password of <code class="language-plaintext highlighter-rouge">bob-admin</code>, we can connect to the DC (Domain Controler) as him. Because we are admin now, we can list the shares <code class="language-plaintext highlighter-rouge">C$</code> and <code class="language-plaintext highlighter-rouge">ADMIN$</code> this can allow us to recover the flag by searching in the SMB shares. But why do that when we can have a shell using PSExec. First we can check that we are indeed domain admin by using <a href="https://www.kali.org/tools/crackmapexec/">CrackmapExec</a>:</p><p><img data-src="https://raw.githubusercontent.com/Nouman404/nouman404.github.io/main/_posts/CTFs/CTF_INSA_Final/photos/realiste_kerb1_cme.png" alt="[realiste_kerb1_cme.png]" data-proofer-ignore></p><blockquote class="prompt-info"><div><p>Note that we know we are domain admin because we see the <code class="language-plaintext highlighter-rouge">Pwn3d!</code> attribute and because we can <code class="language-plaintext highlighter-rouge">READ,WRITE</code> into the <code class="language-plaintext highlighter-rouge">C$</code> and <code class="language-plaintext highlighter-rouge">ADMIN$</code> shares of the DC.</p></div></blockquote><p>Now that we know that we are domain admin, we can use PSExec to get a shell:</p><p><img data-src="https://raw.githubusercontent.com/Nouman404/nouman404.github.io/main/_posts/CTFs/CTF_INSA_Final/photos/realiste_kerb1_whoami.png" alt="[realiste_kerb1_whoami.png]" data-proofer-ignore></p><p>And now that we have a shell, we can go into our desktop folder and get the flag:</p><p><img data-src="https://raw.githubusercontent.com/Nouman404/nouman404.github.io/main/_posts/CTFs/CTF_INSA_Final/photos/realiste_kerb1_flag.png" alt="[realiste_kerb1_flag.png]" data-proofer-ignore></p><h2 id="kerb2"><span class="mr-2">Kerb2</span><a href="#kerb2" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>For this challenge, we are going to use the well known <code class="language-plaintext highlighter-rouge">Kerberoasting</code> attack. As for the AS-REPRoasting part, I will not explain in too much detail the attack but you can find more information on how it work <a href="https://nouman404.github.io/Notes/AD/AD_Basics#kerberoasting">here</a>. The main idea is that some user may have a SPN (EXPLANATION). An SPN is an attribute that, by default, only machine account have. Any user of the domain is allowed to query a ST (Service Ticket) of a user having an SPN.</p><p>As for the AS-REPRoasting, we can find the interesting user with bloodhound or with the impacket tools. Because we just have to click on a upper button for bloodhound, I will only explain the steps using impacket.</p><h3 id="kerberoasting"><span class="mr-2">KerbeRoasting</span><a href="#kerberoasting" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>We can use <code class="language-plaintext highlighter-rouge">GetUserSPNs</code> to find all users having an SPN:</p><p><img data-src="https://raw.githubusercontent.com/Nouman404/nouman404.github.io/main/_posts/CTFs/CTF_INSA_Final/photos/realiste_kerb2_list_spn.png" alt="[realiste_kerb2_list_spn.png]" data-proofer-ignore></p><blockquote class="prompt-tip"><div><p>Note that there is <code class="language-plaintext highlighter-rouge">bob-admin</code> and <code class="language-plaintext highlighter-rouge">krbtgt$</code>. This is because <code class="language-plaintext highlighter-rouge">krbtgt$</code> is a service (as the <code class="language-plaintext highlighter-rouge">$</code> specifies). We can’t crack the password of <code class="language-plaintext highlighter-rouge">krbtgt$</code> because it is a 200 characters long random string.</p></div></blockquote><blockquote class="prompt-info"><div><p>Here is the command to find all kerberoastable account: <code class="language-plaintext highlighter-rouge">GetUserSPNs.py -dc-ip 172.10.0.59 ctf.local/bob</code></p></div></blockquote><p>Now that we found the <code class="language-plaintext highlighter-rouge">bob-admin</code> user as a kerberoastable account, we can request an ST of this user:</p><p><img data-src="https://raw.githubusercontent.com/Nouman404/nouman404.github.io/main/_posts/CTFs/CTF_INSA_Final/photos/realiste_kerb2_getST.png" alt="[realiste_kerb2_getST.png]" data-proofer-ignore></p><blockquote class="prompt-info"><div><p>The full command is: <code class="language-plaintext highlighter-rouge">GetUserSPNs.py -dc-ip 172.10.0.59 ctf.local/bob -request-user bob-admin -outputfile bob-admin.hash</code></p></div></blockquote><p>Now we can use tools like hashcat or john to crack it offline. And we find the admin password:</p><p><img data-src="https://raw.githubusercontent.com/Nouman404/nouman404.github.io/main/_posts/CTFs/CTF_INSA_Final/photos/realiste_kerb2_hashcat.png" alt="[realiste_kerb2_hashcat.png]" data-proofer-ignore></p><blockquote class="prompt-tip"><div><p>The hashcat mode used here is <code class="language-plaintext highlighter-rouge">-m 13100</code></p></div></blockquote><h3 id="get-a-shell-dude-1"><span class="mr-2">Get a shell dude</span><a href="#get-a-shell-dude-1" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>As seen previously, we can now use PSexec to get a shell on the DC:</p><p><img data-src="https://raw.githubusercontent.com/Nouman404/nouman404.github.io/main/_posts/CTFs/CTF_INSA_Final/photos/realiste_kerb2_whoami.png" alt="[realiste_kerb2_whoami.png]" data-proofer-ignore></p><p>And here is the flag:</p><p><img data-src="https://raw.githubusercontent.com/Nouman404/nouman404.github.io/main/_posts/CTFs/CTF_INSA_Final/photos/realiste_kerb2_flag.png" alt="[realiste_kerb2_flag.png]" data-proofer-ignore></p><h2 id="admin-file"><span class="mr-2">Admin File</span><a href="#admin-file" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>As you can see, there are a lot of files (no picture yet… teachers didn’t gave us access back to the chall ^^). But a file caught my attention. The <code class="language-plaintext highlighter-rouge">Creds.txt</code>. This file contain the text <code class="language-plaintext highlighter-rouge">kliphu : Rvvspe</code> it is just the ROT 7 of <code class="language-plaintext highlighter-rouge">debian : Koolix</code>.</p><p><img data-src="https://raw.githubusercontent.com/Nouman404/nouman404.github.io/main/_posts/CTFs/CTF_INSA_Final/photos/realiste_admin_rot.png" alt="[realiste_admin_rot.png]" data-proofer-ignore></p><p>You can see the <code class="language-plaintext highlighter-rouge">Admin2.php</code> code when you click on it. When we go to the path of this files, we can see… It’s a webshell:</p><p><img data-src="https://raw.githubusercontent.com/Nouman404/nouman404.github.io/main/_posts/CTFs/CTF_INSA_Final/photos/realiste_admin_webshell.png" alt="[realiste_admin_webshell.png]" data-proofer-ignore></p><p>With this, we can get a reverse shell thanks to a basic <code class="language-plaintext highlighter-rouge">nc mkfifo</code> (cf. <a href="https://www.revshells.com/">revshells.com</a>) .</p><p>And now we are www-data. we can <code class="language-plaintext highlighter-rouge">su</code> as <code class="language-plaintext highlighter-rouge">debian</code> OR we could just ssh with the previously found credentials and have a really stable shell. And we can now get the first flag:</p><p><img data-src="https://raw.githubusercontent.com/Nouman404/nouman404.github.io/main/_posts/CTFs/CTF_INSA_Final/photos/realiste_admin_user_flag.png" alt="[photos/realiste_admin_user_flag.png]" data-proofer-ignore></p><p>As we can see, we have the right to run the python command as any user (root also ;) ). So we go to the beautiful website <a href="https://gtfobins.github.io/gtfobins/python/#sudo">GTFOBins</a> and find the command to get a root shell. And… Voilà:</p><p><img data-src="https://raw.githubusercontent.com/Nouman404/nouman404.github.io/main/_posts/CTFs/CTF_INSA_Final/photos/realiste_admin_root_flag.png" alt="[realiste_admin_root_flag.png]" data-proofer-ignore></p><h2 id="up-to-date"><span class="mr-2">Up to date</span><a href="#up-to-date" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>On this challenge we are given a URL. This website hosts a <code class="language-plaintext highlighter-rouge">Drupal CMS</code>:</p><p><img data-src="https://raw.githubusercontent.com/Nouman404/nouman404.github.io/main/_posts/CTFs/CTF_INSA_Final/photos/realiste_up_drupal.png" alt="[realiste_up_drupal.png]" data-proofer-ignore></p><p>When we search for the string <code class="language-plaintext highlighter-rouge">Drupal</code> in the source code, we get that the version is <code class="language-plaintext highlighter-rouge">7</code>:</p><p><img data-src="https://raw.githubusercontent.com/Nouman404/nouman404.github.io/main/_posts/CTFs/CTF_INSA_Final/photos/realiste_up_drupal_version.png" alt="[realiste_up_drupal_version.png]" data-proofer-ignore></p><p>Now when we look for an exploit, we find this <a href="https://github.com/dreadlocked/Drupalgeddon2">Drupalgeddon</a> RCE unauthenticated. We launch the attack and get a shell:</p><p><img data-src="https://raw.githubusercontent.com/Nouman404/nouman404.github.io/main/_posts/CTFs/CTF_INSA_Final/photos/realiste_up_revshell.png" alt="[realiste_up_revshell.png]" data-proofer-ignore></p><blockquote class="prompt-warning"><div><p>At the time of writing, the ruby exploit didn’t worked. I used the <a href="https://github.com/firefart/CVE-2018-7600">this one</a> to write this WU. It’s a python exploit and we juste have to replace the command <code class="language-plaintext highlighter-rouge">id</code> by a reverse shell command like <code class="language-plaintext highlighter-rouge">nc mkfifo</code> (cf. <a href="https://www.revshells.com/">revshells.com</a>)</p></div></blockquote><p>With the <code class="language-plaintext highlighter-rouge">www-data</code> user, i get the flag:</p><p><img data-src="https://raw.githubusercontent.com/Nouman404/nouman404.github.io/main/_posts/CTFs/CTF_INSA_Final/photos/realiste_up_user_flag.png" alt="[realiste_up_user_flag.png]" data-proofer-ignore></p><blockquote class="prompt-warning"><div><p>During the CTF, there was a protection on the home folder of <code class="language-plaintext highlighter-rouge">debian</code>. We could list all the files but couldn’t get the rights to list the rights, read or write anything in this folder. Here we have much more rights and we can see each right for each file.</p></div></blockquote><p>Because there was nothing owned by <code class="language-plaintext highlighter-rouge">debian</code>, the only possible way to get his session was to find his password. That was… <code class="language-plaintext highlighter-rouge">debian</code>…</p><p>Now that we are connected as <code class="language-plaintext highlighter-rouge">debian</code> we have any rights on his home directory but we can’t run any command as <code class="language-plaintext highlighter-rouge">sudo</code>…</p><p>If we get a step back, we find that another user can:</p><p><img data-src="https://raw.githubusercontent.com/Nouman404/nouman404.github.io/main/_posts/CTFs/CTF_INSA_Final/photos/realiste_up_sudo_l.png" alt="[realiste_up_sudo_l.png]" data-proofer-ignore></p><p>Now we can use the well known library hijacking method to get a <code class="language-plaintext highlighter-rouge">root</code> shell. We can first read the <code class="language-plaintext highlighter-rouge">ping.py</code> file:</p><p><img data-src="https://raw.githubusercontent.com/Nouman404/nouman404.github.io/main/_posts/CTFs/CTF_INSA_Final/photos/realiste_up_ping.png" alt="[realiste_up_ping.png]" data-proofer-ignore></p><blockquote class="prompt-tip"><div><p>Note that we are doing a library hijacking because we can’t write in the <code class="language-plaintext highlighter-rouge">ping.py</code> file. But if it was possible, we would have just put a reverse shell in it.</p></div></blockquote><p>We know that the library to hijack is <code class="language-plaintext highlighter-rouge">request</code>. Now we can create our own library <code class="language-plaintext highlighter-rouge">requests.py</code> and make <code class="language-plaintext highlighter-rouge">ping.py</code> import it. To do so, we juste have to create our library in the same folder (hence the necessity to get <code class="language-plaintext highlighter-rouge">debian</code> account):</p><p><img data-src="https://raw.githubusercontent.com/Nouman404/nouman404.github.io/main/_posts/CTFs/CTF_INSA_Final/photos/realiste_up_root_shell.png" alt="[realiste_up_root_shell.png]" data-proofer-ignore></p><blockquote class="prompt-tip"><div><p>For more information about python library hijacking you can check <a href="https://medium.com/analytics-vidhya/python-library-hijacking-on-linux-with-examples-a31e6a9860c8">this blog</a>. Section 2 is our case.</p></div></blockquote><blockquote class="prompt-info"><div><p>Note that we can launch the attack from any directory. The only requirement is that the library we create is in the same folder as the executable.</p></div></blockquote><p>And… Voilà… We have the root flag:</p><p><img data-src="https://raw.githubusercontent.com/Nouman404/nouman404.github.io/main/_posts/CTFs/CTF_INSA_Final/photos/realiste_up_root_flag.png" alt="[realiste_up_root_flag.png]" data-proofer-ignore></p><h2 id="xamp"><span class="mr-2">XAMP</span><a href="#xamp" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>In this challenge, we are facing a worpress website. We can see that in many ways but the easier is by looking at the <code class="language-plaintext highlighter-rouge">robots.txt</code> that shows us <code class="language-plaintext highlighter-rouge">wp-admin</code> page:</p><p><img data-src="https://raw.githubusercontent.com/Nouman404/nouman404.github.io/main/_posts/CTFs/CTF_INSA_Final/photos/realiste_xamp_wpad.png" alt="[realiste_xamp_wpad.png]" data-proofer-ignore></p><p>What’s cool about a worpress misconfigured, is that we know when we have the right user thanks to the error message:</p><p><img data-src="https://raw.githubusercontent.com/Nouman404/nouman404.github.io/main/_posts/CTFs/CTF_INSA_Final/photos/realiste_xamp_error.png" alt="[realiste_xamp_error.png]" data-proofer-ignore></p><p>A way to find the admin user is by searching for a post he created or by going at the URL <code class="language-plaintext highlighter-rouge">/wp-json/wp/v2/users</code>:</p><p><img data-src="https://raw.githubusercontent.com/Nouman404/nouman404.github.io/main/_posts/CTFs/CTF_INSA_Final/photos/realiste_xamp_wpUSer.png" alt="[realiste_xamp_wpUSer.png]" data-proofer-ignore></p><p>Now that we have the admin user, we can use it to find the correct password by bruteforcing the authentication page. To do that I advise to to use <a href="https://www.kali.org/tools/wpscan/">wpscan</a>. This tool can be used for the enumeration phase too (list plugins, templates, CVE…):</p><p><img data-src="https://raw.githubusercontent.com/Nouman404/nouman404.github.io/main/_posts/CTFs/CTF_INSA_Final/photos/realiste_xamp_cracked.png" alt="[realiste_xamp_cracked.png]" data-proofer-ignore></p><blockquote class="prompt-tip"><div><p>The output is big, so here is the initial command: <code class="language-plaintext highlighter-rouge">wpscan --password-attack xmlrpc -t 20 -U pwnme -P /usr/share/wordlists/rockyou.txt --url http://172.10.0.42</code></p></div></blockquote><p>Now that we have the credential of the admin we can use it to authenticate and get a shell on the machine. The <a href="https://www.hackingarticles.in/wordpress-reverse-shell/">default technique</a> to get a reverse shell didn’t worked because of the new interface. But the technique is good to know because we are going to do piratically the same. We first need to add an extension (go to <code class="language-plaintext highlighter-rouge">Extnsions &gt; Ajouter une extension</code>) .</p><p>Now that the extension is installed, it has some <code class="language-plaintext highlighter-rouge">PHP</code> pages we can inject. We need to go into the <code class="language-plaintext highlighter-rouge">Outils &gt; Éditeur de fichiers des extensions</code> section and modify the extension. We can set the basic command <code class="language-plaintext highlighter-rouge">system("whoami");</code> and save the result:</p><p><img data-src="https://raw.githubusercontent.com/Nouman404/nouman404.github.io/main/_posts/CTFs/CTF_INSA_Final/photos/realiste_xamp_whoami.png" alt="[realiste_xamp_whoami.png]" data-proofer-ignore></p><p>And activate it:</p><p><img data-src="https://raw.githubusercontent.com/Nouman404/nouman404.github.io/main/_posts/CTFs/CTF_INSA_Final/photos/realiste_xamp_activate.png" alt="[realiste_xamp_activate.png]" data-proofer-ignore></p><p>Now we head back to the URL <code class="language-plaintext highlighter-rouge">http://172.10.0.42/jetpack/jetpack.php</code> and we get the result of our command:</p><p><img data-src="https://raw.githubusercontent.com/Nouman404/nouman404.github.io/main/_posts/CTFs/CTF_INSA_Final/photos/realiste_xamp_whoami_admin.png" alt="[realiste_xamp_whoami_admin.png]" data-proofer-ignore></p><p>We can now use a basic <code class="language-plaintext highlighter-rouge">PHP</code> command to get a reverse shell (cf. <a href="https://github.com/ivan-sincek/php-reverse-shell/blob/master/src/reverse/php_reverse_shell.php">windows-php-reverse-shell</a>) instead of our <code class="language-plaintext highlighter-rouge">system("whoami");</code>:</p><p><img data-src="https://raw.githubusercontent.com/Nouman404/nouman404.github.io/main/_posts/CTFs/CTF_INSA_Final/photos/realiste_xamp_revshell.png" alt="[realiste_xamp_revshell.png]" data-proofer-ignore></p><p>We can activate the plugin to get the shell. We can see the flag at the root of the file system:</p><p><img data-src="https://raw.githubusercontent.com/Nouman404/nouman404.github.io/main/_posts/CTFs/CTF_INSA_Final/photos/realiste_xamp_shell_gotten.png" alt="[realiste_xamp_shell_gotten.png]" data-proofer-ignore></p><p>And voilà… We have the flag:</p><p><img data-src="https://raw.githubusercontent.com/Nouman404/nouman404.github.io/main/_posts/CTFs/CTF_INSA_Final/photos/realiste_xamp_flag.png" alt="[realiste_xamp_flag.png]" data-proofer-ignore></p></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw mr-1"></i> <a href='/categories/ctfs/'>CTFs</a>, <a href='/categories/ctf-insa-final/'>CTF_INSA_Final</a>, <a href='/categories/realiste/'>Realiste</a></div><div class="post-tags"> <i class="fa fa-tags fa-fw mr-1"></i> <a href="/tags/kerberoast/" class="post-tag no-text-decoration" >kerberoast</a> <a href="/tags/asreproast/" class="post-tag no-text-decoration" >asreproast</a> <a href="/tags/kerberos/" class="post-tag no-text-decoration" >kerberos</a> <a href="/tags/crypto/" class="post-tag no-text-decoration" >crypto</a></div><div class="post-tail-bottom d-flex justify-content-between align-items-center mt-3 pt-5 pb-2"><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/"> CC BY 4.0 </a> by the author.</div><div class="share-wrapper"> <span class="share-label text-muted mr-1">Share</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=CTFs+%7C+Finale_CTF_INSA_2024+%7C+Realiste+-+BatBato%27s+Blog&url=nouman404.github.io%2FCTFs%2FFinale_CTF_INSA_2024%2FRealiste%2F" data-toggle="tooltip" data-placement="top" title="Twitter" target="_blank" rel="noopener" aria-label="Twitter"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=CTFs+%7C+Finale_CTF_INSA_2024+%7C+Realiste+-+BatBato%27s+Blog&u=nouman404.github.io%2FCTFs%2FFinale_CTF_INSA_2024%2FRealiste%2F" data-toggle="tooltip" data-placement="top" title="Facebook" target="_blank" rel="noopener" aria-label="Facebook"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://t.me/share/url?url=nouman404.github.io%2FCTFs%2FFinale_CTF_INSA_2024%2FRealiste%2F&text=CTFs+%7C+Finale_CTF_INSA_2024+%7C+Realiste+-+BatBato%27s+Blog" data-toggle="tooltip" data-placement="top" title="Telegram" target="_blank" rel="noopener" aria-label="Telegram"> <i class="fa-fw fab fa-telegram"></i> </a> <i id="copy-link" class="fa-fw fas fa-link small" data-toggle="tooltip" data-placement="top" title="Copy link" data-title-succeed="Link copied successfully!"> </i> </span></div></div></div></div></div><div id="panel-wrapper" class="col-xl-3 pl-2 text-muted"><div class="access"><div id="access-lastmod" class="post"><div class="panel-heading">Recently Updated</div><ul class="post-content pl-0 pb-1 ml-1 mt-2"><li><a href="/Notes/AD/AD_Basics">Notes | AD | AD Basics</a><li><a href="/Notes/AD/Tools">Notes | AD | AD Tools</a><li><a href="/CTFs/HeroCTF_2024/Steganographie/Zipper">CTFs | HeroCTF_2024 | Steganographie | Zipper</a><li><a href="/CTFs/HeroCTF_2024/Forensique/LazySysAdmin2">CTFs | HeroCTF_2024 | Forensique | LazySysAdmin2</a><li><a href="/CTFs/HeroCTF_2024/Forensique/Tenant_trouble">CTFs | HeroCTF_2024 | Forensique | Tenant trouble</a></ul></div><div id="access-tags"><div class="panel-heading">Trending Tags</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/ctf/">CTF</a> <a class="post-tag" href="/tags/web/">Web</a> <a class="post-tag" href="/tags/forensique/">Forensique</a> <a class="post-tag" href="/tags/404ctf/">404CTF</a> <a class="post-tag" href="/tags/stegano/">Stegano</a> <a class="post-tag" href="/tags/fcsc/">FCSC</a> <a class="post-tag" href="/tags/forensic/">Forensic</a> <a class="post-tag" href="/tags/osint/">OSINT</a> <a class="post-tag" href="/tags/stega/">Stega</a> <a class="post-tag" href="/tags/reverse/">Reverse</a></div></div></div><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.js"></script><div id="toc-wrapper" class="pl-0 pr-4 mb-5"><div class="panel-heading pl-3 pt-2 mb-2">Contents</div><nav id="toc" data-toggle="toc"></nav></div></div></div><div class="row"><div id="tail-wrapper" class="col-12 col-lg-11 col-xl-9 pl-3 pr-3 pr-xl-4"><div id="related-posts" class="mt-5 mb-2 mb-sm-4"><h3 class="pt-2 mt-1 mb-4 ml-1" data-toc-skip>Further Reading</h3><div class="card-deck mb-4"><div class="card"> <a href="/CTFs/CTF_INSA_2024/Realiste/"><div class="card-body"> <em class="small" data-ts="1707087600" data-df="ll" > Feb 5, 2024 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>CTFs | CTF_INSA_2024 | Realiste</h3><div class="text-muted small"><p> Réaliste Le monitoring est important In this challenge, we are tasked to become root of the machine. First we go to the login page and can log-in with the credentials admin:admin (before that ot...</p></div></div></a></div><div class="card"> <a href="/CTFs/Finale_CTF_INSA_2024/Forensique/"><div class="card-body"> <em class="small" data-ts="1712181600" data-df="ll" > Apr 4, 2024 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>CTFs | Finale_CTF_INSA_2024 | Forensique</h3><div class="text-muted small"><p> Forensique My Name Is ? In this challenge, we are asked to find the name of the user that juste have been powned. To do this, we just have to run the envars command of volatility. Using volatili...</p></div></div></a></div><div class="card"> <a href="/CTFs/FCSC2023/Intro/T_es_lent"><div class="card-body"> <em class="small" data-ts="1682978400" data-df="ll" > May 2, 2023 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>CTFs | FCSC2023 | Intro | T'es lent</h3><div class="text-muted small"><p> T’es lent This chall is basically just about reading the source code. When we look at the website, we don’t see much, but in the source code, we find: So we jumpt to the URL /stage-generateur...</p></div></div></a></div></div></div><div class="post-navigation d-flex justify-content-between"> <a href="/CTFs/Finale_CTF_INSA_2024/Forensique/" class="btn btn-outline-primary" prompt="Older"><p>CTFs | Finale_CTF_INSA_2024 | Forensique</p></a> <a href="/Notes/AD/AD_Basics" class="btn btn-outline-primary" prompt="Newer"><p>Notes | AD | AD Basics</p></a></div></div></div><footer class="row pl-3 pr-3"><div class="col-12 d-flex justify-content-between align-items-center text-muted pl-0 pr-0"><div class="footer-left"><p class="mb-0"> © 2025 <a href="https://github.com/Nouman404/">Bat</a>. <span data-toggle="tooltip" data-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author.">Some rights reserved.</span></p></div><div class="footer-right"><p class="mb-0"> Powered by <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a> with <a href="https://github.com/cotes2020/jekyll-theme-chirpy" target="_blank" rel="noopener">Chirpy</a> theme.</p></div></div></footer></div><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-12 col-sm-11 post-content"><div id="search-hints"><div id="access-tags"><div class="panel-heading">Trending Tags</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/ctf/">CTF</a> <a class="post-tag" href="/tags/web/">Web</a> <a class="post-tag" href="/tags/forensique/">Forensique</a> <a class="post-tag" href="/tags/404ctf/">404CTF</a> <a class="post-tag" href="/tags/stegano/">Stegano</a> <a class="post-tag" href="/tags/fcsc/">FCSC</a> <a class="post-tag" href="/tags/forensic/">Forensic</a> <a class="post-tag" href="/tags/osint/">OSINT</a> <a class="post-tag" href="/tags/stega/">Stega</a> <a class="post-tag" href="/tags/reverse/">Reverse</a></div></div></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><div id="mask"></div><a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a><div id="notification" class="toast" role="alert" aria-live="assertive" aria-atomic="true" data-animation="true" data-autohide="false"><div class="toast-header"> <button type="button" class="ml-2 ml-auto close" data-dismiss="toast" aria-label="Close"> <span aria-hidden="true">&times;</span> </button></div><div class="toast-body text-center pt-0"><p class="pl-2 pr-2 mb-3">A new version of content is available.</p><button type="button" class="btn btn-primary" aria-label="Update"> Update </button></div></div><script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.10.0/dest/simple-jekyll-search.min.js"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5">Oops! No result founds.</p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); </script> <script src="https://cdn.jsdelivr.net/combine/npm/magnific-popup@1/dist/jquery.magnific-popup.min.js,npm/lozad/dist/lozad.min.js,npm/clipboard@2/dist/clipboard.min.js"></script> <script src="https://cdn.jsdelivr.net/combine/npm/dayjs@1/dayjs.min.js,npm/dayjs@1/locale/en.min.js,npm/dayjs@1/plugin/relativeTime.min.js,npm/dayjs@1/plugin/localizedFormat.min.js"></script> <script defer src="/assets/js/dist/post.min.js"></script> <script src="https://cdn.jsdelivr.net/npm/bootstrap@4/dist/js/bootstrap.bundle.min.js"></script> <script defer src="/app.js"></script>
