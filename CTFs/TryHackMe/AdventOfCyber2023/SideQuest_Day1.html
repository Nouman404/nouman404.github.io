<!DOCTYPE html><html lang="en" data-mode="dark" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="generator" content="Jekyll v4.4.1" /><meta property="og:title" content="CTFs TryHackMe AdventOfCyber2023 Side Quest Day 1" /><meta name="author" content="BatBato" /><meta property="og:locale" content="en" /><meta name="description" content="Side Quest - Day 1" /><meta property="og:description" content="Side Quest - Day 1" /><link rel="canonical" href="nouman404.github.io/CTFs/TryHackMe/AdventOfCyber2023/SideQuest_Day1" /><meta property="og:url" content="nouman404.github.io/CTFs/TryHackMe/AdventOfCyber2023/SideQuest_Day1" /><meta property="og:site_name" content="BatBato’s Blog" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2023-12-28T00:00:00+01:00" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="CTFs TryHackMe AdventOfCyber2023 Side Quest Day 1" /><meta name="twitter:site" content="@twitter_username" /><meta name="twitter:creator" content="@BatBato" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"BlogPosting","author":{"@type":"Person","name":"BatBato"},"dateModified":"2023-12-28T14:57:45+01:00","datePublished":"2023-12-28T00:00:00+01:00","description":"Side Quest - Day 1","headline":"CTFs TryHackMe AdventOfCyber2023 Side Quest Day 1","mainEntityOfPage":{"@type":"WebPage","@id":"nouman404.github.io/CTFs/TryHackMe/AdventOfCyber2023/SideQuest_Day1"},"url":"nouman404.github.io/CTFs/TryHackMe/AdventOfCyber2023/SideQuest_Day1"}</script><title>CTFs | TryHackMe | AdventOfCyber2023 | Side Quest Day 1 | BatBato's Blog</title><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/site.webmanifest"><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico"><meta name="apple-mobile-web-app-title" content="BatBato's Blog"><meta name="application-name" content="BatBato's Blog"><meta name="msapplication-TileColor" content="#da532c"><meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin><link rel="dns-prefetch" href="https://fonts.gstatic.com" crossorigin><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://cdn.jsdelivr.net" ><link rel="dns-prefetch" href="https://cdn.jsdelivr.net" ><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Lato&family=Source+Sans+Pro:wght@400;600;700;900&display=swap"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4/dist/css/bootstrap.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css"><link rel="stylesheet" href="/assets/css/style.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/magnific-popup@1/dist/magnific-popup.min.css"> <script src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script><body data-spy="scroll" data-target="#toc" data-topbar-visible="true"><div id="sidebar" class="d-flex flex-column align-items-end"><div class="profile-wrapper text-center"><div id="avatar"> <a href="/" class="mx-auto"> <img src="/assets/img/icon.jpg" alt="avatar" onerror="this.style.display='none'"> </a></div><div class="site-title mt-3"> <a href="/">BatBato's Blog</a></div><div class="site-subtitle font-italic">BatBato was here :)</div></div><ul class="w-100"><li class="nav-item"> <a href="/" class="nav-link"> <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i> <span>HOME</span> </a><li class="nav-item"> <a href="/categories/" class="nav-link"> <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i> <span>CATEGORIES</span> </a><li class="nav-item"> <a href="/notes/" class="nav-link"> <i class="fa-fw fas fa-sticky-note ml-xl-3 mr-xl-3 unloaded"></i> <span>NOTES</span> </a><li class="nav-item"> <a href="/sources/" class="nav-link"> <i class="fa-fw fas fa-folder-open ml-xl-3 mr-xl-3 unloaded"></i> <span>SOURCES</span> </a><li class="nav-item"> <a href="/about/" class="nav-link"> <i class="fa-fw fas fa-info-circle ml-xl-3 mr-xl-3 unloaded"></i> <span>ABOUT</span> </a><li class="nav-item"> <a href="/archives/" class="nav-link"> <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i> <span>ARCHIVES</span> </a></ul><div class="sidebar-bottom mt-auto d-flex flex-wrap justify-content-center align-items-center"> <a href="https://github.com/Nouman404" aria-label="github" target="_blank" rel="noopener"> <i class="fab fa-github"></i> </a> <a href="https://app.hackthebox.com/profile/235762" aria-label="hackthebox" target="_blank" rel="noopener"> <i class="fas fa-cube"></i> </a> <a href="https://tryhackme.com/p/Batbato" aria-label="tryhackme" target="_blank" rel="noopener"> <i class="fas fa-cloud"></i> </a> <a href="https://www.root-me.org/BatBato" aria-label="rootme" target="_blank" rel="noopener"> <i class="fas fa-skull"></i> </a></div></div><div id="topbar-wrapper"><div id="topbar" class="container d-flex align-items-center justify-content-between h-100 pl-3 pr-3 pl-md-4 pr-md-4"> <span id="breadcrumb"> <span> <a href="/"> Home </a> </span> <span>CTFs | TryHackMe | AdventOfCyber2023 | Side Quest Day 1</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> Post</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" autocomplete="off" placeholder="Search..."> </span> <span id="search-cancel" >Cancel</span></div></div><div id="main-wrapper" class="d-flex justify-content-center"><div id="main" class="container pl-xl-4 pr-xl-4"><div class="row"><div id="core-wrapper" class="col-12 col-lg-11 col-xl-9 pr-xl-4"><div class="post pl-1 pr-1 pl-md-2 pr-md-2"><h1 data-toc-skip>CTFs | TryHackMe | AdventOfCyber2023 | Side Quest Day 1</h1><div class="post-meta text-muted"> <span> Posted <em class="" data-ts="1703718000" data-df="ll" data-toggle="tooltip" data-placement="bottom"> Dec 28, 2023 </em> </span> <span> Updated <em class="" data-ts="1703771865" data-df="ll" data-toggle="tooltip" data-placement="bottom"> Dec 28, 2023 </em> </span><div class="d-flex justify-content-between"> <span> By <em> Bat </em> </span><div> <span class="readtime" data-toggle="tooltip" data-placement="bottom" title="1019 words"> <em>5 min</em> read</span></div></div></div><div class="post-content"><h1 id="side-quest---day-1">Side Quest - Day 1</h1><p><img data-src="https://github.com/Nouman404/nouman404.github.io/assets/73934639/dbe5f9cb-11bf-429f-9313-c22fbbb8285b" alt="image" data-proofer-ignore></p><p>In this challenge, we are given a wireshark capture called <a href="https://github.com/Nouman404/nouman404.github.io/blob/main/_posts/CTFs/TryHackMe/AdventOfCyber2023/VanSpy.pcapng">VanSpy.pcapng</a>. When we open it with wireshark, we just see the following:</p><p><img data-src="https://github.com/Nouman404/nouman404.github.io/assets/73934639/e1f1ea16-896f-48e5-ba04-1be032538c12" alt="image" data-proofer-ignore></p><p>The protocol <code class="language-plaintext highlighter-rouge">802.11</code> is the one used for Wifi communication. Because we don’t have any other protocol, we guess that we have to crack the wifi password to recover the traffic. To do so, we are going to export the hash of the Wifi password and crack it using hashcat. I found <a href="https://www.cyberark.com/resources/threat-research-blog/cracking-wifi-at-scale-with-one-simple-trick">this blog</a> that explains a lot about Wifi attacks and in our case how to recover and crack the hash of the Wifi. First we run the following command:</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>hcxpcapngtool <span class="nt">-o</span> VanSpy.hash VanSpy.pcapng
</pre></table></code></div></div><p>We get some output like this:</p><p><img data-src="https://github.com/Nouman404/nouman404.github.io/assets/73934639/ed7a556a-44b0-4c1b-9745-98b45a869ded" alt="image" data-proofer-ignore></p><p>But what is interesting is that we recovered the hash of the Wifi in our text file:</p><p><img data-src="https://github.com/Nouman404/nouman404.github.io/assets/73934639/4756abf7-badd-424b-abac-ba7de6327182" alt="image" data-proofer-ignore></p><p>We can now run hashcat on it like so:</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>hashcat -m 22000 VanSpy.hash /usr/share/wordlists/rockyou.txt 
</pre></table></code></div></div><blockquote class="prompt-info"><div><p>To know which mode to use with hashcat just go to the <a href="https://hashcat.net/wiki/doku.php?id=example_hashes">hashcat website</a> and search for a similar-looking hash.</p></div></blockquote><p>The password is pretty weak so we find pretty fast the clear text password <code class="language-plaintext highlighter-rouge">Christmas</code>:</p><p><img data-src="https://github.com/Nouman404/nouman404.github.io/assets/73934639/65fdc8f7-a26c-461e-8134-0b7826ad8420" alt="image" data-proofer-ignore></p><p>We now have to specify it in our wireshark. To do so, we go to the <code class="language-plaintext highlighter-rouge">Edit</code> menu, then in <code class="language-plaintext highlighter-rouge">Preferences</code>, then in the <code class="language-plaintext highlighter-rouge">Protocols</code> subsection we search the protocol <code class="language-plaintext highlighter-rouge">IEEE 802.11</code> and specify the <code class="language-plaintext highlighter-rouge">Decryption Key</code>:</p><p><img data-src="https://github.com/Nouman404/nouman404.github.io/assets/73934639/2612b688-6eb5-4002-9da2-c6cec6c3c7c8" alt="image" data-proofer-ignore></p><p>We specify the key as follows:</p><p><img data-src="https://github.com/Nouman404/nouman404.github.io/assets/73934639/ad189723-a80d-444f-a65f-11cc30eabdd5" alt="image" data-proofer-ignore></p><p>Now we can search in our Wireshark file as we would have done in a normal capture. We can search for <code class="language-plaintext highlighter-rouge">TCP</code>, <code class="language-plaintext highlighter-rouge">HTTP</code>, <code class="language-plaintext highlighter-rouge">FTP</code> traffic… After a bit of digging, we can see that there is a use of the port <code class="language-plaintext highlighter-rouge">4444</code>… Which is the default port for <code class="language-plaintext highlighter-rouge">Metasploit</code>… Should be interesting:</p><p><img data-src="https://github.com/Nouman404/nouman404.github.io/assets/73934639/3d88f54c-f203-443a-85a4-ee54aa6543cf" alt="image" data-proofer-ignore></p><p>As we can see, there are a lot of <code class="language-plaintext highlighter-rouge">PSH, ACK</code>. This means that data are exchanged here. If we right click on on of them and select <code class="language-plaintext highlighter-rouge">Follow</code> &gt; <code class="language-plaintext highlighter-rouge">TCP Stream</code> like this:</p><p><img data-src="https://github.com/Nouman404/nouman404.github.io/assets/73934639/19ba63f8-a4da-476f-86a9-95d763c187c5" alt="image" data-proofer-ignore></p><p>We get the following result:</p><p><img data-src="https://github.com/Nouman404/nouman404.github.io/assets/73934639/86cea52c-dac6-4eb2-a02a-220f1433b713" alt="image" data-proofer-ignore></p><p>Mmmmh… Looks like a non-standard user we got here… What we see is that the user is running as <code class="language-plaintext highlighter-rouge">Administrator</code> and run <a href="https://github.com/gentilkiwi/mimikatz">Mimikatz</a> commands to increase its privileges to <code class="language-plaintext highlighter-rouge">NT AUTHORITY\SYSTEM</code> and export the RDP certificate:</p><p><img data-src="https://github.com/Nouman404/nouman404.github.io/assets/73934639/0bb94434-53fd-4a5f-9929-72f0fa6a4281" alt="image" data-proofer-ignore></p><p>Thanks to our attacker, we get the content of the <code class="language-plaintext highlighter-rouge">LOCAL_MACHINE_Remote Desktop_0_INTERN-PC.pfx</code> certificate because he converted it to base64:</p><p><img data-src="https://github.com/Nouman404/nouman404.github.io/assets/73934639/e2bd2f25-d19f-4938-9a70-6b8a914f3262" alt="image" data-proofer-ignore></p><p>For some reason converting the base64 directelly from the terminal didn’t work so I used <a href="https://gchq.github.io/CyberChef/#recipe=From_Base64('A-Za-z0-9%2B/%3D',true,false)&amp;input=TUlJSnVRSUJBekNDQ1hVR0NTcUdTSWIzRFFFSEFhQ0NDV1lFZ2dsaU1JSUpYakNDQmVjR0NTcUdTSWIzRFFFSEFhQ0NCZGdFZ2dYVU1JSUYwRENDQmN3R0N5cUdTSWIzRFFFTUNnRUNvSUlFL2pDQ0JQb3dIQVlLS29aSWh2Y05BUXdCQXpBT0JBaUF3OWRaMHFndlVRSUNCOUFFZ2dUWWJNS25hMFlxSjFlTjNGR0tLVXRzb0NaQUo4S3piU0tNQmM4NnNDWmRVQkxzVHE4WjRzV25GZ1FpdEx0WElyRG5pb2FDOU42YWtnRzh4OHVMTFVuZG1UcmVOQWZRUmNMaUFMR0pvS2Y3OXJnUTZJNEJoNkZ6cGhOanV3Q0x6YXFOaWtuU0JXcUpSWjdOKy9HNzZIOWpMV3FOSWZ4ck1kdEFMOWRMZmJqOFpiN24wcndVSWI1V2QzaHJ6b3drOXRySWxQblNoa3V6eXl2QVNGSU9OTGNsci9TMlFrOHNuWjFJSS9LMmM4YzZMcXB1Y3NkRGI4QTdMcU04dU5kM1A4c0U4UlcrL3FEczkybU9XNmlSMWpFRUdBT0dsa0lLYmRMRkJYZFI2WHJhSzhpREh5Z3hjSEtiTTB6M05oNUJPbTNDMEpUS1RsVDMyWWh4cjlmUjZaTWR2RE9JcytIdjBiajJDV1h3R0ZEOHlkZXJpUm42N2NFdmhHdmJQcXFzbmNxZmsrNkxwbWp3Rk9Hbzh4d21oTk4xNXZTL0p0b29KMEVXQWV2akVKbWJSc29pSlBWRmE0d3FzRVprR2VVTXdFbEwzeFQxTmYwNko1N240cHRpSDlzeUNveVZDUW9KVTlRZ0RpSUVNS0JLcTZvRDZCSkZyVzM0aW83WitmMmloUzlIeldaeFAza2VZdmlsUHZldGFZbjVtTWhXZHJJVWxUOFpvQW4rNFhhWVhPSDBJZ1RobXh3S1lhY0VOYlgveS9RR1R3TlU5VU14STBuR1RUU0ZXamFmaTZDa1JFbVN3MklFeHdsQVlEOVVuc3dqOTNjT0hSdlpkU3N4Y3lEMjJRdzUxdDYyTGViMDBockdKSUxETUl3WHFpRlpBdHA0cnEvTS9KOHBjd2dTNW9qMFlUOFRTRWtOUFN3RmRUZXcrQWNEbXpEN3JQNkdWdmV4Z3hUZDM3V2RyUUJDTUszZTFla0VETTFGaGNFMEh0cHVUNWM5eTJJT3RzZ2tTQ2lJNm5YK09FMGxnZjlvbnBBUDJQQ25KdjhDSmY3Smw1dmRUc2tSRzcxc09hL1pSSXgyUU5jYnBlNWZtbWZweGlOYXRreStCdEZwY3FFb1VDWFpYWElQYXYwQjF1bWhRN0pEV1NrR2FKcENIWW1DZ3Z0cUVUSk1OSXQ2SzUvV1hoWWNQMi92aUIxbi9KRndGeVplczVFNnJ4YzdYdFJEYy9KMm43SGR1WVJ2MmlTbE54a0dLRmtpVER5ZUtDZXh0TzVsNzRaRnZOZXBhRnRUWkdsNE9KZ1lQWVRyREFUWWszQkpvc1ZRdU5oUE81b2p3ZGtmaHlRejJIRXpBZldVY29RZW1kZU51QzMwSmVDTVRyZ1o1ZmcvSG41MjlCQ09iR0NvdGtSOUZmQ0xTRG5KSnYvUjlWT2FCK1JNdGI1QjduZ1BHU3NDcjlNRVphMGtYQXpaZERGOS9lZWJZWXRPd3NqNnFMcnhjZ3hnWDY5a1ZZdGRKUVlTUDhOem9mOHliZG4yYlNJNThFNDRPUWtPRFVQSy9aWTJLN0FWTzZNcmVzYjBCKzJsOXZBMFBrZ2MxK1E0UFhpbHowaHhHUjVRckhqUHJ1YWZwcHp6d2l4QndhWERZZGl1RFB2MGFLMk5zcXgzOGRpdFRwQmpnanRWelZuTVBsZ3AzZUdPRUo5MzQ2ZkhNbWp4UmtybllNQnEyYmF3OXJkd0FSS0NieitSZzRqNEZGa2c1ckliK1h1MkxWSEpycjh0Y1VTck41emNCcDZBN01aMzB0UDRrR3VoeTB3SGpXR0dPeEVVTzNWTktqbndWRUF0UEYxNGtHM1ZINWNSZVFha0s4bDZEc20xM3lKWFFSbFhFNzNRL2w3N2pTYmZsZVNIcVQvTWxVNlFMdnNjdVFITHphbWNMVXI3U3IwQjZzelowcWRDbnZ2R0hTeFRGMGsrTitIMHU3dlRoZWdhR3VBRFRZOVZBTlNDb1pPVUx1KzIrSWxkaytBRUtpdzA1TGtXa3JjU1hlWGIzWHNJSWlYTktOVDIyaDUvZzRTaDdZbThodHhrSUJ0RnFSUEN2VWI2Mjk5dFd3RVhCVlhXNEVMWmhyaDZJVVV2RUVnUkV1NXE5TDk5cHRtY2Y1b2wvaW81dEttYVdmSlAzRUcwSjlIOVp4ZFNqcEFLeXRKR3J3WVBmY1ZJNVRHQnVqQU5CZ2tyQmdFRUFZSTNFUUl4QURBVEJna3Foa2lHOXcwQkNSVXhCZ1FFQVFBQUFEQW5CZ2txaGtpRzl3MEJDUlF4R2g0WUFGUUFVd0JUQUdVQVl3QkxBR1VBZVFCVEFHVUFkQUF4TUdzR0NTc0dBUVFCZ2pjUkFURmVIbHdBVFFCcEFHTUFjZ0J2QUhNQWJ3Qm1BSFFBSUFCRkFHNEFhQUJoQUc0QVl3QmxBR1FBSUFCREFISUFlUUJ3QUhRQWJ3Qm5BSElBWVFCd0FHZ0FhUUJqQUNBQVVBQnlBRzhBZGdCcEFHUUFaUUJ5QUNBQWRnQXhBQzRBTURDQ0EyOEdDU3FHU0liM0RRRUhCcUNDQTJBd2dnTmNBZ0VBTUlJRFZRWUpLb1pJaHZjTkFRY0JNQndHQ2lxR1NJYjNEUUVNQVFNd0RnUUlaUjV2Z2kxLzlUd0NBZ2ZRZ0lJREtNQU16SFBmTUxhdTdJWmF3TWhPZDA2QWNPMlNYUUZzWjNLeVBMUUdyRldjc3hFaVVERG1jalE1clpSeVNPYVJ5ejVQenlJRkNVQ0hjS3A1Y21sWUpUZEg0ZlNsZmFIeUM5VEtKcmRFdVQyUG44cHE5Qy9zbmp1RTIzTFU3MGMyVStOU1FocUF1bFVjQTY0ZVREeVBvNzRaMk9kUms1aklRMFkwaFlFL0YrRFNEYm4zSjJ0a2ZrbFN5dWZKbG9CUUFyNXAxZVpPL2xqNU9kWm16Q0hHUDlic0luS1gzY3VENXliejFLTU5QUWQvb0h1TUZIL0RCNzlaYU1vb2VyRmgyMlFVdHJ5M1pFZ01jaitDRTBIM0I2N3FUWDVOeUhWRHpaUm94WXJqVG94NWNPZkRqcm9aeC9MZmVTYmVpK0JDN2dCRksybERPVHA0TlhldkNPc1JKLzhPanB5aXpHSVVBaElLWVVaU3VnQWd3OHIzODdRaW1XSW1LWXJXZUxqMHJxWWwwUy8rRytIRXJRbTM4VnE2S3RnR2M5am1vTWJIRFh5azJQSzlJVjFHb3JTSitkbjNMRFRyenJCcG1zK2ZrTmp4SGg2a2UvNFVRaWk2dFBLRVduek55c3graHdNUk9MNVFPNWpacDY1OUhCbG9UbW8zc01QK2hvdUZRMlBGMTVXZDROci91am9EVFNWVUtCb1AwcSszVTF0SlEyallUUlp2dTRZQzJBOFJXWVNJNHZEcS8vaTIxeWtaSFE2SVhVOE9qWXBnc3V3dXBYcGR6cWd0NGpCQnBBbitxV083NDd4dzgrOFMvaHlxWWdBTUNwWk8xaDJub2xVc0ttYy9lajFCMlZIVDQrRHlRaTJ2THpTbGtpUmRZVE94eDNaL0liZUJpU2FZRUJ4UWJzK0tBTTRqTFNGTmdsbEhjRDhVZUpNUUpGWnlXWWVHNEN1Uk1iUzQrRDVRSDZuRit4STJOWnJxbElKcEk4QlhSNWd1aDJmeFZ3YzhQdzJXMXl0bUg4azI3Ry9aajV5TFFwd2p2K3pUbTFUU29MWXR6bG5mWThXcEtYbXRDT3lFQ3JDRTg3NUJ3WU9CSllCTFV5UTN2WWg3UCtUM3JFMDhsMllqYWNpL25hRXp0ZEUwSEJTczFOaFJIOWpRNFV2NGlJbHEvMlo5bFlSUnlkSTRGY0F3dC83cklqZW4vZUExWWNzd09UbVhsd2E0UHJ1dVBnY1ZneHVTTFMwYldXNWZQbWU4cG1WZzJmWGp0VTNaRVpQRkM0RmxpWVVtdHlOa01Ga1Y1djR2SXNNTUNwa3pGMGdtc1pYUS9CSWg1MzlPYXdVRkdlSW5KRTBCanFvZTA1TFh1dW1GM1BxWCtUS1FHLzJzLzhZRG1MVm5yVDJSTlBGV3pEdVFtTTFidWlCL1FDdndsbDRYa2JFd096QWZNQWNHQlNzT0F3SWFCQlI2ZnROSHlzODhaQ1l3ZmRQOExheFFyNVhmdHdRVXRiM2lrQlZDMU9KS3FYZG9vUzZZN3BoRXFjWUNBZ2ZR">Cyber Chef</a> to recover the original content of the file.</p><p>Now we have our <code class="language-plaintext highlighter-rouge">LOCAL_MACHINE_Remote Desktop_0_INTERN-PC.pfx</code> we should be able to recover the private key and decode the RDP traffic… But it seems like there is a password…</p><p><img data-src="https://github.com/Nouman404/nouman404.github.io/assets/73934639/ad29c3d2-91d1-4b3c-80c8-b5dd2c17d511" alt="image" data-proofer-ignore></p><p>After trying to crack it using <code class="language-plaintext highlighter-rouge">rockyou</code> (unsuccessful) I search on the internet for a way to recover it… All to get to know that it was… <code class="language-plaintext highlighter-rouge">mimikatz</code>…</p><p>So we run the previous command and specify the password as <code class="language-plaintext highlighter-rouge">mimikatz</code> and we get a pretty <code class="language-plaintext highlighter-rouge">server.pem</code> private key:</p><p><img data-src="https://github.com/Nouman404/nouman404.github.io/assets/73934639/c913040a-939c-4f15-a2da-0dd93c515df3" alt="image" data-proofer-ignore></p><p>We can remove the header to just keep the part that starts with <code class="language-plaintext highlighter-rouge">-----BEGIN PRIVATE KEY-----</code> and we then specify it in the <code class="language-plaintext highlighter-rouge">Protocols</code> section (as we saw earlier) but this time in the <code class="language-plaintext highlighter-rouge">RDP</code> section:</p><p><img data-src="https://github.com/Nouman404/nouman404.github.io/assets/73934639/d6d9c86e-7e48-4e55-94a3-8da6968c5a69" alt="image" data-proofer-ignore></p><blockquote class="prompt-info"><div><p>More information about RDP decryption can be found on this <a href="https://www.hackingarticles.in/wireshark-for-pentester-decrypting-rdp-traffic/">hackingarticles</a> blog and this <a href="https://unit42.paloaltonetworks.com/wireshark-tutorial-decrypting-rdp-traffic/">paloaltonetworks</a> one.</p></div></blockquote><p>We then specify the IP address of the server (the one with the port <code class="language-plaintext highlighter-rouge">3389</code>), the port <code class="language-plaintext highlighter-rouge">3389</code>, the protocol <code class="language-plaintext highlighter-rouge">tpkt</code> and the path of the private key:</p><p><img data-src="https://github.com/Nouman404/nouman404.github.io/assets/73934639/d3e3b2f2-f169-4b05-852e-ac1205548f87" alt="image" data-proofer-ignore></p><p>When we search for <code class="language-plaintext highlighter-rouge">RDP</code> in the search bar, we now have plenty of results:</p><p><img data-src="https://github.com/Nouman404/nouman404.github.io/assets/73934639/c00de180-f281-4abf-ba97-b8b39193e546" alt="image" data-proofer-ignore></p><p>Here I was blocked… I tried to look at every packet, but didn’t find anything… All the packets had non-printable characters so it was a dead end… Or was it ? I then realised that RDP is like a video stream, so maybe we could recover this video ? I search for a tool that would do that and found this incredible tool <a href="https://github.com/GoSecure/pyrdp">pyrdp</a>. I also found this blog from <a href="https://kalilinuxtutorials.com/pyrdp/">kalilinuxtutorials</a> that helped me understand how to use it.</p><p>So I exported the PDU by clicking on the <code class="language-plaintext highlighter-rouge">File</code> menu, then <code class="language-plaintext highlighter-rouge">Export PDUs to file</code> and we select <code class="language-plaintext highlighter-rouge">OSI Layer 7</code>. Now we have some <code class="language-plaintext highlighter-rouge">RDP</code> traffic without any colour:</p><p><img data-src="https://github.com/Nouman404/nouman404.github.io/assets/73934639/a649ed55-c94b-4440-99f1-cae7e5665adf" alt="image" data-proofer-ignore></p><blockquote class="prompt-info"><div><p>A Protocol Data Unit (PDU) in Wireshark refers to a unit of data at the transport layer of a network protocol. When exported from Wireshark, a PDU capture typically contains the raw data exchanged between network devices during communication. PDUs are useful for analyzing and troubleshooting network issues, providing insights into the structure and content of data packets.</p></div></blockquote><p>We then save it as a <code class="language-plaintext highlighter-rouge">pcap</code> file:</p><p><img data-src="https://github.com/Nouman404/nouman404.github.io/assets/73934639/94379ef5-afbd-4b2e-9ce5-9d79ecb50be9" alt="image" data-proofer-ignore></p><blockquote class="prompt-warning"><div><p>Note that the format <code class="language-plaintext highlighter-rouge">pcap</code> is important. Using the default <code class="language-plaintext highlighter-rouge">pcapng</code> will not work for the tool <code class="language-plaintext highlighter-rouge">pyrdp</code>.</p></div></blockquote><p>I ran the <code class="language-plaintext highlighter-rouge">pyrdp</code> in a venv to have less trouble with dependencies. I ran the following commands:</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre><td class="rouge-code"><pre>python3 <span class="nt">-m</span> venv venv
<span class="nb">cd </span>pyrdp
pip3 <span class="nb">install</span> <span class="nt">-U</span> <span class="nt">-e</span> <span class="s1">'.[full]'</span>
<span class="nb">cd</span> ..
</pre></table></code></div></div><p>We then run the following command to export the <code class="language-plaintext highlighter-rouge">PDUs</code> in a format that <code class="language-plaintext highlighter-rouge">pyrdp</code> understands:</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>python3 pyrdp/pyrdp/bin/convert.py <span class="nt">-o</span> py_rdp_output export_pdu.pcap 
</pre></table></code></div></div><p>And we get this beautiful output:</p><p><img data-src="https://github.com/Nouman404/nouman404.github.io/assets/73934639/f24c26f7-846f-4e84-9b85-e91514916ae7" alt="image" data-proofer-ignore></p><p>For some unknown reason the <code class="language-plaintext highlighter-rouge">pyrdp-player</code> wouldn’t run when using its binary from the <code class="language-plaintext highlighter-rouge">venv</code> so I ran it from the docker like so:</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="nb">sudo </span>docker run <span class="nt">-v</span> <span class="s2">"</span><span class="nv">$PWD</span><span class="s2">/py_rdp_output:/pwd"</span> <span class="nt">-e</span> <span class="nv">DISPLAY</span><span class="o">=</span><span class="nv">$DISPLAY</span> <span class="nt">-e</span> <span class="nv">QT_X11_NO_MITSHM</span><span class="o">=</span>1 <span class="nt">--net</span><span class="o">=</span>host gosecure/pyrdp pyrdp-player
</pre></table></code></div></div><p>We have this window that pops up:</p><p><img data-src="https://github.com/Nouman404/nouman404.github.io/assets/73934639/a779aceb-b33a-40d9-ba89-9da89f22b5f9" alt="image" data-proofer-ignore></p><p>We go to the <code class="language-plaintext highlighter-rouge">File</code> &gt; <code class="language-plaintext highlighter-rouge">Open</code> section and select in our folder the file called <code class="language-plaintext highlighter-rouge">[STRIP].pycap</code> and we open it:</p><p><img data-src="https://github.com/Nouman404/nouman404.github.io/assets/73934639/35da1d3d-1134-4408-ba6f-fb410d3ff26f" alt="image" data-proofer-ignore></p><blockquote class="prompt-danger"><div><p>Note that we need to look in OUR directory. Because we are using the docker image, it is not in the default folder that is open when you get to this menu. You need to go in the <code class="language-plaintext highlighter-rouge">/pwd</code> folder because this is the name I gave in the docker command (<code class="language-plaintext highlighter-rouge">-v "$PWD/py_rdp_output:/pwd"</code>).</p></div></blockquote><p>We get this window that is AWESOME!!! Let me explain. Now, we have the full replay of the <code class="language-plaintext highlighter-rouge">RDP</code> communication that went through the wireshark capture. And what is fantastic is that we have the key pressed by the user and also the content of the clipboard!!!</p><p>We now just have to press play and wait for the answers to come to us:</p><p><img data-src="https://github.com/Nouman404/nouman404.github.io/assets/73934639/d4e7f562-7235-4b93-9ba8-828f507ea557" alt="image" data-proofer-ignore></p><p>And we now have the key to validate the challenge.</p></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw mr-1"></i> <a href='/categories/ctfs/'>CTFs</a>, <a href='/categories/tryhackme/'>TryHackMe</a>, <a href='/categories/adventofcyber2023/'>AdventOfCyber2023</a>, <a href='/categories/rdp/'>RDP</a></div><div class="post-tags"> <i class="fa fa-tags fa-fw mr-1"></i> <a href="/tags/rdp/" class="post-tag no-text-decoration" >RDP</a> <a href="/tags/mimikatz/" class="post-tag no-text-decoration" >Mimikatz</a> <a href="/tags/rdpreplay/" class="post-tag no-text-decoration" >RDPReplay</a> <a href="/tags/side-quest/" class="post-tag no-text-decoration" >Side Quest</a> <a href="/tags/thm/" class="post-tag no-text-decoration" >THM</a></div><div class="post-tail-bottom d-flex justify-content-between align-items-center mt-3 pt-5 pb-2"><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/"> CC BY 4.0 </a> by the author.</div><div class="share-wrapper"> <span class="share-label text-muted mr-1">Share</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=CTFs+%7C+TryHackMe+%7C+AdventOfCyber2023+%7C+Side+Quest+Day+1+-+BatBato%27s+Blog&url=nouman404.github.io%2FCTFs%2FTryHackMe%2FAdventOfCyber2023%2FSideQuest_Day1" data-toggle="tooltip" data-placement="top" title="Twitter" target="_blank" rel="noopener" aria-label="Twitter"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=CTFs+%7C+TryHackMe+%7C+AdventOfCyber2023+%7C+Side+Quest+Day+1+-+BatBato%27s+Blog&u=nouman404.github.io%2FCTFs%2FTryHackMe%2FAdventOfCyber2023%2FSideQuest_Day1" data-toggle="tooltip" data-placement="top" title="Facebook" target="_blank" rel="noopener" aria-label="Facebook"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://t.me/share/url?url=nouman404.github.io%2FCTFs%2FTryHackMe%2FAdventOfCyber2023%2FSideQuest_Day1&text=CTFs+%7C+TryHackMe+%7C+AdventOfCyber2023+%7C+Side+Quest+Day+1+-+BatBato%27s+Blog" data-toggle="tooltip" data-placement="top" title="Telegram" target="_blank" rel="noopener" aria-label="Telegram"> <i class="fa-fw fab fa-telegram"></i> </a> <i id="copy-link" class="fa-fw fas fa-link small" data-toggle="tooltip" data-placement="top" title="Copy link" data-title-succeed="Link copied successfully!"> </i> </span></div></div></div></div></div><div id="panel-wrapper" class="col-xl-3 pl-2 text-muted"><div class="access"><div id="access-lastmod" class="post"><div class="panel-heading">Recently Updated</div><ul class="post-content pl-0 pb-1 ml-1 mt-2"><li><a href="/Notes/AD/AD_Basics">Notes | AD | AD Basics</a><li><a href="/Notes/AD/Tools">Notes | AD | AD Tools</a><li><a href="/CTFs/HeroCTF_2024/Steganographie/Zipper">CTFs | HeroCTF_2024 | Steganographie | Zipper</a><li><a href="/CTFs/HeroCTF_2024/Forensique/LazySysAdmin2">CTFs | HeroCTF_2024 | Forensique | LazySysAdmin2</a><li><a href="/CTFs/HeroCTF_2024/Forensique/Tenant_trouble">CTFs | HeroCTF_2024 | Forensique | Tenant trouble</a></ul></div><div id="access-tags"><div class="panel-heading">Trending Tags</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/ctf/">CTF</a> <a class="post-tag" href="/tags/web/">Web</a> <a class="post-tag" href="/tags/forensique/">Forensique</a> <a class="post-tag" href="/tags/404ctf/">404CTF</a> <a class="post-tag" href="/tags/stegano/">Stegano</a> <a class="post-tag" href="/tags/fcsc/">FCSC</a> <a class="post-tag" href="/tags/forensic/">Forensic</a> <a class="post-tag" href="/tags/osint/">OSINT</a> <a class="post-tag" href="/tags/stega/">Stega</a> <a class="post-tag" href="/tags/reverse/">Reverse</a></div></div></div></div></div><div class="row"><div id="tail-wrapper" class="col-12 col-lg-11 col-xl-9 pl-3 pr-3 pr-xl-4"><div id="related-posts" class="mt-5 mb-2 mb-sm-4"><h3 class="pt-2 mt-1 mb-4 ml-1" data-toc-skip>Further Reading</h3><div class="card-deck mb-4"><div class="card"> <a href="/CTFs/TryHackMe/AdventOfCyber2023/SideQuest_Day3"><div class="card-body"> <em class="small" data-ts="1703718000" data-df="ll" > Dec 28, 2023 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>CTFs | TryHackMe | AdventOfCyber2023 | Side Quest Day 3</h3><div class="text-muted small"><p> Side Quest - Day 3 Enumeration In this challenge, we are just given the an IP address. So we start our enumeration phase by running our nmap: As you can see, I used only -sV. This is be...</p></div></div></a></div><div class="card"> <a href="/CTFs/TryHackMe/AdventOfCyber2023/SideQuest_Day4"><div class="card-body"> <em class="small" data-ts="1703718000" data-df="ll" > Dec 28, 2023 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>CTFs | TryHackMe | AdventOfCyber2023 | Side Quest Day 4</h3><div class="text-muted small"><p> Side Quest - Day 4 In this challenge, we need to become root, so let’s start with the enumeration phase. Enumeration As we can see, we only have two open ports: We go see the website and no...</p></div></div></a></div><div class="card"> <a href="/CTFs/TryHackMe/AdventOfCyber2023/QR_Codes"><div class="card-body"> <em class="small" data-ts="1703718000" data-df="ll" > Dec 28, 2023 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>CTFs | TryHackMe | AdventOfCyber2023 | QR Codes</h3><div class="text-muted small"><p> Introduction To be able to participate in the Side Quest challenge, we had to find the URLs to the different challenges: First QR Code LinkedIn The first one is, as specified earlier, on thei...</p></div></div></a></div></div></div><div class="post-navigation d-flex justify-content-between"> <a href="/CTFs/TryHackMe/AdventOfCyber2023/QR_Codes" class="btn btn-outline-primary" prompt="Older"><p>CTFs | TryHackMe | AdventOfCyber2023 | QR Codes</p></a> <a href="/CTFs/TryHackMe/AdventOfCyber2023/SideQuest_Day3" class="btn btn-outline-primary" prompt="Newer"><p>CTFs | TryHackMe | AdventOfCyber2023 | Side Quest Day 3</p></a></div></div></div><footer class="row pl-3 pr-3"><div class="col-12 d-flex justify-content-between align-items-center text-muted pl-0 pr-0"><div class="footer-left"><p class="mb-0"> © 2025 <a href="https://github.com/Nouman404/">Bat</a>. <span data-toggle="tooltip" data-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author.">Some rights reserved.</span></p></div><div class="footer-right"><p class="mb-0"> Powered by <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a> with <a href="https://github.com/cotes2020/jekyll-theme-chirpy" target="_blank" rel="noopener">Chirpy</a> theme.</p></div></div></footer></div><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-12 col-sm-11 post-content"><div id="search-hints"><div id="access-tags"><div class="panel-heading">Trending Tags</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/ctf/">CTF</a> <a class="post-tag" href="/tags/web/">Web</a> <a class="post-tag" href="/tags/forensique/">Forensique</a> <a class="post-tag" href="/tags/404ctf/">404CTF</a> <a class="post-tag" href="/tags/stegano/">Stegano</a> <a class="post-tag" href="/tags/fcsc/">FCSC</a> <a class="post-tag" href="/tags/forensic/">Forensic</a> <a class="post-tag" href="/tags/osint/">OSINT</a> <a class="post-tag" href="/tags/stega/">Stega</a> <a class="post-tag" href="/tags/reverse/">Reverse</a></div></div></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><div id="mask"></div><a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a><div id="notification" class="toast" role="alert" aria-live="assertive" aria-atomic="true" data-animation="true" data-autohide="false"><div class="toast-header"> <button type="button" class="ml-2 ml-auto close" data-dismiss="toast" aria-label="Close"> <span aria-hidden="true">&times;</span> </button></div><div class="toast-body text-center pt-0"><p class="pl-2 pr-2 mb-3">A new version of content is available.</p><button type="button" class="btn btn-primary" aria-label="Update"> Update </button></div></div><script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.10.0/dest/simple-jekyll-search.min.js"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5">Oops! No result founds.</p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); </script> <script src="https://cdn.jsdelivr.net/combine/npm/magnific-popup@1/dist/jquery.magnific-popup.min.js,npm/lozad/dist/lozad.min.js,npm/clipboard@2/dist/clipboard.min.js"></script> <script src="https://cdn.jsdelivr.net/combine/npm/dayjs@1/dayjs.min.js,npm/dayjs@1/locale/en.min.js,npm/dayjs@1/plugin/relativeTime.min.js,npm/dayjs@1/plugin/localizedFormat.min.js"></script> <script defer src="/assets/js/dist/post.min.js"></script> <script src="https://cdn.jsdelivr.net/npm/bootstrap@4/dist/js/bootstrap.bundle.min.js"></script> <script defer src="/app.js"></script>
